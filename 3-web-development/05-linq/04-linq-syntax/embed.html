




	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		
		
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.117.0">
    <meta name="generator" content="Relearn 5.18.0">
    <meta name="description" content="K-State CIS 400 Textbook">
    <meta name="author" content="Nathan Bean">
    <title>LINQ Syntax :: K-State CIS 400 Textbook</title>
    <link href="https://ksu-cs-textbooks.github.io/cis400/3-web-development/05-linq/04-linq-syntax/index.html" rel="canonical" type="text/html" title="LINQ Syntax :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/3-web-development/05-linq/04-linq-syntax/index.xml" rel="alternate" type="application/rss+xml" title="LINQ Syntax :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/3-web-development/05-linq/04-linq-syntax/index.print.html" rel="alternate" type="text/html" title="LINQ Syntax :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/3-web-development/05-linq/04-linq-syntax/tele.html" rel="alternate" type="text/html" title="LINQ Syntax :: K-State CIS 400 Textbook">
    
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/fontawesome-all.min.css?1714577029" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/fontawesome-all.min.css?1714577029" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/nucleus.css?1714577029" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/auto-complete.css?1714577029" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/auto-complete.css?1714577029" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/perfect-scrollbar.min.css?1714577029" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/fonts.css?1714577029" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/fonts.css?1714577029" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/theme.css?1714577029" rel="stylesheet">
    
    
    
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/theme-light-theme.css?1714577029" rel="stylesheet" id="variant-style">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/variant.css?1714577029" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/print.css?1714577029" rel="stylesheet" media="print">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/ie.css?1714577029" rel="stylesheet">
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/url.js?1714577029"></script>
    
    
    
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="https://ksu-cs-textbooks.github.io/cis400/index.search.js";
      var root_url="https://ksu-cs-textbooks.github.io/cis400/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/ksu-cs-textbooks.github.io\/cis400/';
      window.variants && variants.init( [ 'light-theme', 'dark-theme' ] );
    </script>
    
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/custom.css?1714577029" rel="stylesheet">

    
  </head>
  <body class="mobile-support embed disableInlineCopyToClipboard" data-url="https://ksu-cs-textbooks.github.io/cis400/3-web-development/05-linq/04-linq-syntax/embed.html">
    <div id="body" class="default-animation">
      
      
      
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
    
    
    
<p>Let&rsquo;s discuss some of the more common operations we might want to perform with LINQ.  Please note that this is <em>not an exhaustive list</em> - just some of the most common operations you will be encountering at this time.</p>
<h2 id="data-source">Data Source</h2>
<p>For these examples, we&rsquo;ll be using a data source consisting of <code>Student</code> objects.  These are defined by the class:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> EID;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> First;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> Last;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> GPA;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> Age;    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> Major;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>And the variable <code>students</code> is a <code>List&lt;Student&gt;</code> that we can assume is populated with initialized student objects.</p>
<p>We select this as our data source with the LINQ <code>from</code> operator.  In query syntax, this would be:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> query = <span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students ...</span></span></code></pre></div><p>And with method syntax, we would simply use the <code>students</code> list:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> query = students.SomeQueryMethod(student =&gt; ...)</span></span></code></pre></div><p>To create a query from a data source using method syntax without applying any query methods (useful for chaining optional queries), we can invoke <code>All()</code> on the collection:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> query = students.All();</span></span></code></pre></div><p>To use a different data source, we would just swap <code>students</code> for that source, an object that supports either the <code>IEnumerable</code> (usually data structures) or <code>IQueryable</code> (typically SQL or XML data sources) interface.</p>
<h2 id="projecting">Projecting</h2>
<p>Projecting refers to selecting specific data from a data source.  For example, if we wanted to select the full name of every  <code>Student</code>, we could do so with this query syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentNames = <span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">select</span> <span style="color:#e6db74">$&#34;{student.First} {student.Last}&#34;</span>;</span></span></code></pre></div><p>Or with method syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentNames = students.Select(student =&gt; <span style="color:#e6db74">$&#34;{student.First} {student.Last}&#34;</span>);</span></span></code></pre></div><p>As the name is simply a string, the select above simply constructs the string, and the type of <code>studentNames</code> is inferred to be <code>IEnumerable&lt;string&gt;</code>.</p>
<p>We can also project an <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/anonymous-types" target="_blank">anonymous type</a>
.  This is a special kind of object whose type is created at runtime.  Anonymous types are basically collections of properties and nothing more (they cannot have methods).  For example, if we wanted just the student&rsquo;s full name and age, we would use this query syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentInfo = <span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">select</span> <span style="color:#66d9ef">new</span> {FullName = <span style="color:#e6db74">$&#34;{student.First} {student.Last}&#34;</span>, Age = student.Age};</span></span></code></pre></div><p>or this method syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentInfo = students.Select(student =&gt; <span style="color:#66d9ef">new</span> {FullName = <span style="color:#e6db74">$&#34;{student.First} {student.Last}&#34;</span>, Age = student.Age});</span></span></code></pre></div><p>Finally, we could also define a new data type (i.e. class) and create an instance of it as our projection:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StudentInfo</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> FullName {<span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>;}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> Age {<span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>;}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> StudentInfo(<span style="color:#66d9ef">string</span> fullName, <span style="color:#66d9ef">int</span> age)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        FullName = fullName;
</span></span><span style="display:flex;"><span>        Age = age;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Using query syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentInfo = <span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">select</span> <span style="color:#66d9ef">new</span> StudentInfo(<span style="color:#e6db74">$&#34;{student.First} {student.Last}&#34;</span>, student.Age);</span></span></code></pre></div><p>or this method syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentInfo = students.Select(student =&gt; <span style="color:#66d9ef">new</span> StudentInfo(<span style="color:#e6db74">$&#34;{student.First} {student.Last}&#34;</span>, student.Age));</span></span></code></pre></div><h2 id="filtering">Filtering</h2>
<p>One of the most common operations you will do with a query is filter the data, so the results contain only part of the original data.  This is done with the <code>where</code> operator takes a statement that resolves to a boolean.  If this boolean expression resolves to true, then the data is included in the results; if it is false, it is excluded.  For example, to find all students older than 25, we would use this query syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> olderStudents = <span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">where</span> student.Age &gt; <span style="color:#ae81ff">25</span> <span style="color:#66d9ef">select</span> student;</span></span></code></pre></div><p>or this method syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> olderStudents = students.Where(student =&gt; student.Age &gt; <span style="color:#ae81ff">25</span>);</span></span></code></pre></div><h2 id="filtering-by-type">Filtering By Type</h2>
<p>If we have a list that contains multiple types, we can filter for specific types with the <code>where</code> operator or the <code>OfType</code> operator (this is an instance where query and operator syntax vary more greatly).  Consider the case where our <code>Student</code> class is a base class to <code>GraduateStudent</code> and <code>UndergraduateStudent</code> classes.  If we wanted to get a list of only the undergraduates, we could use a <code>where</code> query syntax combined with an <code>is</code> casting test:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> undergraduates = <span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">where</span> student <span style="color:#66d9ef">is</span> UndergraduateStudent <span style="color:#66d9ef">select</span> student;</span></span></code></pre></div><p>In this case, the result would be an <code>IEnumerable&lt;UndergraduateStudent&gt;</code>.  But the corresponding where in operator syntax would result in an <code>IEnumerable&lt;Student&gt;</code> that contained only <code>UndergraduateStudent</code> objects.  To perform a cast as part of the filtering, we would instead use the <code>OfType&lt;T&gt;()</code> method:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> undergraduates = students.OfType&lt;UndergraduateStudent&gt;();</span></span></code></pre></div><h2 id="ordering">Ordering</h2>
<p>Often we want to apply some form of sorting to our results, i.e. we might want to sort students by GPA.  This can be done with an <code>orderby</code> operator.  In query syntax it would be:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentsByGPA = <span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">orderby</span> student.GPA <span style="color:#66d9ef">select</span> student;</span></span></code></pre></div><p>And in method syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentsByGPA = students.OrderBy(student =&gt; student.GPA);</span></span></code></pre></div><p>The <code>orderby</code> operator sorts in <em>ascending</em> order (so students with the lowest grades would come first in the list).  If we wanted to sort in <em>descending</em> order, we would need to specify descending order in our query syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentsByGPA = <span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">orderby</span> student.GPA <span style="color:#66d9ef">descending</span> <span style="color:#66d9ef">select</span> student;</span></span></code></pre></div>
  
  
<div class="box notices cstyle tip">
  <div class="box-label"><i class="fa-fw fas fa-lightbulb"></i> Tip</div>
  <div class="box-content">

<p>There is also an <em>ascending</em> keyword you can use.  This is helpful if you can&rsquo;t remember the default or want to make it clear to other programmers that the list will be sorted in ascending order:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentsByGPA = <span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">orderby</span> student.GPA <span style="color:#66d9ef">ascending</span> <span style="color:#66d9ef">select</span> student;</span></span></code></pre></div></div>
</div>
<p>However, in method syntax this is accomplished by a separate operator, the <code>OrderByDescending()</code> method:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentsByGPA = students.OrderByDescending(student =&gt; student.GPA);</span></span></code></pre></div><p>If we need to order by multiple properties, i.e. first and last names, this is accomplished by a comma-separated list in query syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentsByName = <span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">orderby</span> student.Last, student.First <span style="color:#66d9ef">select</span> student;</span></span></code></pre></div><p>But in method syntax, we need to use a <code>ThenBy()</code> operator for subsequent sorting options:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentsByName = students.OrderBy(student =&gt; student.Last).ThenBy(student =&gt; student.First);</span></span></code></pre></div><p>We can mix and match ascending and descending sorting as well - for example, to sort students by descending GPA, then by names in alphabetical order we would use the query syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentsByGPAAndName = <span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">orderby</span> student.GPA <span style="color:#66d9ef">descending</span>, student.Last, student.First <span style="color:#66d9ef">select</span> student;</span></span></code></pre></div><p>The corresponding method syntax would need separate operators for each sorting:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentsByGPAAndName = students.OrderByDescending(student =&gt; student.GPA).ThenBy(student =&gt; student.Last).ThenBy(student =&gt; student.First);</span></span></code></pre></div><p>There is also a <code>ThenByDescending()</code> operator for chaining descending sorts.</p>
<p>Finally, there is also a <code>Reverse()</code> operator which simply reverses the order of items in the collection without sorting.</p>
<h2 id="grouping">Grouping</h2>
<p>We often want to split our results into groups, which can be accomplished with the <code>group by</code> operator.  Consider the case where we want to split our students by the value of their <code>Major</code> field.  We can accomplish this with query syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentsByMajor = <span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">group</span> student <span style="color:#66d9ef">by</span> student.Major <span style="color:#66d9ef">select</span> student;</span></span></code></pre></div><p>or using method syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentsByMajor = students.GroupBy(student =&gt; student.Major);</span></span></code></pre></div><p>The result type of a grouping operation is an <code>IEnumerable&lt;IGrouping&lt;TKey, TSource&gt;&gt;</code>; the <code>IGrouping</code> is essentially a key/value pair with the key being the type we were grouping by.  In the example it would be <code>IEnumerable&lt;IGrouping&lt;string, Student&gt;&gt;</code> (Seeing this, you can probably begin to appreciate why we normally use <code>var</code> for query variables).</p>
<p>To print out each student in each category, we&rsquo;d need to iterate over this collection, and then over the groupings:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">foreach</span>(<span style="color:#66d9ef">var</span> <span style="color:#66d9ef">group</span> <span style="color:#66d9ef">in</span> studentsByMajor) {
</span></span><span style="display:flex;"><span>    Console.WriteLine(<span style="color:#e6db74">$&#34;{group.Key} Students&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">foreach</span>(<span style="color:#66d9ef">var</span> student <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">group</span>) {
</span></span><span style="display:flex;"><span>        Console.WriteLine(<span style="color:#e6db74">$&#34;{student.First} {student.Last}&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><h2 id="paging">Paging</h2>
<p>A common strategy with large data sets is to separate them into <em>pages</em>, i.e. the first 20 items might appear on page 1, and by clicking the page 2 link, the user could view the next twenty items, and so on.  This paging functionality is implemented in LINQ using the <code>Skip()</code> and <code>Take()</code> operators.  The <code>Skip()</code> operator specifies how many records to skip over, while the <code>Take()</code> operator indicates how many records to include.  Thus, to take the second page of students when each page displays twenty students, we would use:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> pagedStudents = students.Skip(<span style="color:#ae81ff">20</span>).Take(<span style="color:#ae81ff">20</span>);</span></span></code></pre></div><p>Note that there is no query syntax corresponding to the <code>Skip()</code> and <code>Take()</code> operations, so to use them with query syntax, we wrap the query in parenthesis and invoke the methods on the result.  I.e. sorting students alphabetically and then taking the third page of twenty would be:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> pagedSortedStudents = (<span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">orderby</span> last, first <span style="color:#66d9ef">select</span> student).Skip(<span style="color:#ae81ff">40</span>).Take(<span style="color:#ae81ff">20</span>);</span></span></code></pre></div><h2 id="existence-checks">Existence Checks</h2>
<p>Sometimes we want to know if a particular record exists in our data source.  The <code>Any()</code> operator can be used to perform such a check.  It evaluates to <code>true</code> if the query has any results, or <code>false</code> if it does not.  Like the <code>Skip()</code> and <code>Take()</code>, it does not have a query syntax form, so it must be invoked using the method syntax.  For example, to determine if we have at least one student named Bob Smith, we could use:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> bobSmithExists = (<span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">where</span> student.First == <span style="color:#e6db74">&#34;Bob&#34;</span> &amp;&amp; student.Last == <span style="color:#e6db74">&#34;Smith&#34;</span> <span style="color:#66d9ef">select</span> student).Any();</span></span></code></pre></div><p>Or, in method syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> bobSmithExists = students.Any(student =&gt; student.First == <span style="color:#e6db74">&#34;Bob&#34;</span> &amp;&amp; student.Last == <span style="color:#e6db74">&#34;Smith&#34;</span>);</span></span></code></pre></div><p>Alternatively, if we wanted to retrieve Bob Smith&rsquo;s record instead of simply determining if we had one, we could use <code>First()</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> bobSmith = (<span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">where</span> student.First == <span style="color:#e6db74">&#34;Bob&#34;</span> &amp;&amp; student.Last == <span style="color:#e6db74">&#34;Smith&#34;</span> <span style="color:#66d9ef">select</span> student).First();</span></span></code></pre></div><p>or in method syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> bobSmith = students.First(student =&gt; student.First == <span style="color:#e6db74">&#34;Bob&#34;</span> &amp;&amp; student.Last == <span style="color:#e6db74">&#34;Smith&#34;</span>);</span></span></code></pre></div><p>This evaluates to the first matching result of the query (if we have multiple Bob Smiths, we&rsquo;ll only get the first one).  If there is no matching record, an <code>InvalidOperationException</code> is thrown.  Alternatively, we can use <code>FirstOrDefault()</code> which returns a default value corresponding to the query data type. For classes, this would be <code>null</code>, so given this query:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> bobSmith = students.FirstOrDefault(student =&gt; student.First == <span style="color:#e6db74">&#34;Bob&#34;</span> &amp;&amp; student.Last == <span style="color:#e6db74">&#34;Smith&#34;</span>);</span></span></code></pre></div><p>The value of <code>bobSmith</code> would be his record (if he is in the collection) or <code>null</code> (if he was not).</p>
<h2 id="aggregating">Aggregating</h2>
<p>Sometimes we want to perform aggregate operations upon a data source, i.e. counting, summing, or averaging. As with paging, these are accomplished via method-only operators.  For example, to count all students in our data source, we could use:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentCount = students.Count();</span></span></code></pre></div><p>This can be combined with any LINQ query, i.e. the count of students with a GPA above 3.0 in query syntax would be:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentsAbove3GPA = (<span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">where</span> student.GPA &gt; <span style="color:#ae81ff">3.0</span> <span style="color:#66d9ef">select</span> student).Count();</span></span></code></pre></div><p>or in method syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> studentsAbove3GPA = students.Where(student =&gt; student.GPA &gt; <span style="color:#ae81ff">3.0</span>).Count();</span></span></code></pre></div><p>Similarly, to compute the average GPA we would use the <code>Average()</code> method in conjunction with a projection.  In query syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> averageGPA = (<span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">select</span> student.GPA).Average();</span></span></code></pre></div><p>or in method syntax:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> averageGPA = students.Select(student =&gt; student.GPA).Average();</span></span></code></pre></div><p>or we can move the selector Predicate into the <code>Average()</code> directly:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> averageGPA = students.Average(student =&gt; student.GPA);</span></span></code></pre></div><p>We can create more complex queries to address specific questions.  For example, with a <code>group by</code> we could compute the average GPA by major:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> gpaByMajor = <span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">group</span> student <span style="color:#66d9ef">by</span> student.Major <span style="color:#66d9ef">into</span> majorGroup <span style="color:#66d9ef">select</span> <span style="color:#66d9ef">new</span> 
</span></span><span style="display:flex;"><span>    { 
</span></span><span style="display:flex;"><span>        Major = majorGroup.Key,
</span></span><span style="display:flex;"><span>        AverageGPA = majorGroup.Average(student =&gt; student.GPA);
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div><p>The <code>Sum()</code> operator works similarly, summing a value.  To sum the ages of all students, we could use:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> sumOfAges = (<span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">in</span> students <span style="color:#66d9ef">select</span> student.Age).Sum();</span></span></code></pre></div><p>or</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> sumOfAges = students.Select(student =&gt; student.Age).Sum();</span></span></code></pre></div><p>or</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> sumOfAges = students.Sum(student =&gt; student.Age);</span></span></code></pre></div><p>There are also <code>Min()</code> and <code>Max()</code> aggregate operators which select the minimum and maximum values, respectively.  For example, we could find the maximum and minimum earned GPAs with:</p>
<div class="wrap-code highlight"><pre tabindex="0"><code class="language-chsarp" data-lang="chsarp">var minGPA = students.Min(student =&gt; student.GPA);
var maxGPA = students.Max(student =&gt; student.GPA);</code></pre></div><p>Finally, there is a generic <code>Aggregate()</code> method which provides an aggregator variable that we can use to build any kind of aggregate function.  Let&rsquo;s first see how it can be used to duplicate the functionality of the <code>Sum()</code> method:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> sumOfAges = students.Aggregate((sum, student) =&gt; sum + student.Age);</span></span></code></pre></div><p>Here, <code>sum</code> is inferred to be an <code>int</code>, as <code>student.Age</code> is an int.  So it starts at <code>0</code>, and each time the <code>Aggregate</code> method processes a student, it adds that student&rsquo;s <code>Age</code> into the <code>sum</code>.</p>
<p>Now let&rsquo;s use this method for something new - generating a string of email addresses for a bulk mailing.  Assume our email application needs a list of semicolon-separated email addresses.  In that case, we could generate the emails for all students from:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> emails = students.Aggregate((emails, student) =&gt; emails + <span style="color:#e6db74">$&#34;; {student.EID}@k-state.edu&#34;</span>);</span></span></code></pre></div><p>If we had students with EIDs &ldquo;mary&rdquo;, &ldquo;brb30&rdquo;, and &ldquo;stan&rdquo;, the resulting string would be:</p>
<div class="wrap-code highlight"><pre tabindex="0"><code>mary@k-state.edu; brb30@k-state.edu; stan@ksu.edu</code></pre></div>
  
  
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>You may have heard the term <a href="https://en.wikipedia.org/wiki/MapReduce" target="_blank">map/reduce</a>
 in the context of functional programming or big data.  This is an algorithmic approach to processing data.  This pattern can be duplicated in LINQ using a query as the mapping function, and <code>Aggregate()</code> as the reduce function.</p>
</div>
</div>

            <footer class="footline">

            </footer>
          </article>
        </div>
      </main>
    </div>
    
    
    
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/clipboard.min.js?1714577032" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/perfect-scrollbar.min.js?1714577032" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/theme.js?1714577032" defer></script>
    
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/embed-iframe.js?1714577032 defer"></script>
  </body>
</html>
