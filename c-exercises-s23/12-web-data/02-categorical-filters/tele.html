




	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		
		
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.117.0">
    <meta name="generator" content="Relearn 5.18.0">
    <meta name="description" content="K-State CIS 400 Textbook">
    <meta name="author" content="Nathan Bean">
    <title>Adding Categorical Filters to the Movie Site :: K-State CIS 400 Textbook</title>
    <link href="https://ksu-cs-textbooks.github.io/cis400/c-exercises-s23/12-web-data/02-categorical-filters/index.html" rel="canonical" type="text/html" title="Adding Categorical Filters to the Movie Site :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/c-exercises-s23/12-web-data/02-categorical-filters/index.xml" rel="alternate" type="application/rss+xml" title="Adding Categorical Filters to the Movie Site :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/c-exercises-s23/12-web-data/02-categorical-filters/index.print.html" rel="alternate" type="text/html" title="Adding Categorical Filters to the Movie Site :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/c-exercises-s23/12-web-data/02-categorical-filters/embed.html" rel="alternate" type="text/html" title="Adding Categorical Filters to the Movie Site :: K-State CIS 400 Textbook">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/fontawesome-all.min.css?1710866805" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/fontawesome-all.min.css?1710866805" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/nucleus.css?1710866805" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/auto-complete.css?1710866805" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/auto-complete.css?1710866805" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/perfect-scrollbar.min.css?1710866805" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/fonts.css?1710866805" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/fonts.css?1710866805" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/theme.css?1710866805" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/theme-auto.css?1710866805" rel="stylesheet" id="variant-style">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/variant.css?1710866805" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/print.css?1710866805" rel="stylesheet" media="print">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/ie.css?1710866805" rel="stylesheet">
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/url.js?1710866805"></script>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/variant.js?1710866805"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="https://ksu-cs-textbooks.github.io/cis400/index.search.js";
      var root_url="https://ksu-cs-textbooks.github.io/cis400/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/ksu-cs-textbooks.github.io\/cis400/';
      window.variants && variants.init( [ 'auto', 'light-theme', 'dark-theme' ] );
    </script>
    
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/custom.css?1710866805" rel="stylesheet">

  </head>
  <body class="mobile-support tele disableInlineCopyToClipboard" data-url="https://ksu-cs-textbooks.github.io/cis400/c-exercises-s23/12-web-data/02-categorical-filters/index.html">
    
    <div id="tele" class="tele mirror">
    
    <div id="body" class="default-animation">
      
      
      
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>
<h1 id="adding-categorical-filters-to-the-movie-site">Adding Categorical Filters to the Movie Site</h1>

<p>Let&rsquo;s add some filters to the page as well.  We&rsquo;ll start with <em>categorical</em> filters, i.e. filtering by category.  Let&rsquo;s start by filtering for MPAA Rating.  We know that there are only a handful of ratings issued by the Motion Picture Association of America - G, PG, PG-13, R, and NC-17.  We might be tempted to use an enumeration to represent these values, but in C# an enumeration cannot have strings for values.  Nor can we use the hyphen (<code>-</code>) in an enumeration name.</p>
<h2 id="defining-the-mpaa-ratings">Defining the MPAA Ratings</h2>
<p>So let&rsquo;s define a string array with our MPAA values, and make it accessible from our <code>MovieDatabase</code> class:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Gets the possible MPAARatings</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span>[] MPAARatings
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span> =&gt; <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">string</span>[]
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;G&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;PG&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;PG-13&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;R&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;NC-17&#34;</span>
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div><p>Now in our <code>&lt;form&gt;</code> in <em>Index.cshtml</em> we can add a checkbox for each of these possible values:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>    @foreach  (string rating in MovieDatabase.MPAARatings) 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;checkbox&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;MPAARatings&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;@rating&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>            @rating
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;SearchTerms&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;@Model.SearchTerms&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Search&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">form</span>&gt;</span></span></code></pre></div><p>If you try running the project now, and check a few boxes, you&rsquo;ll see the query string results look something like:</p>
<div class="wrap-code highlight"><pre tabindex="0"><code>?SearchTerms=&amp;MPAARatings=G&amp;MPAARatings=PG-13</code></pre></div><p>Notice how the key <em>MPAARatings</em> is repeated twice?  What would that look like in our PageModel?  We can find out; declare a <code>var</code> to hold the value in the <code>OnGet()</code> method of <em>Index.cshtml.cs</em>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> MPAARatings = Request.Query[<span style="color:#e6db74">&#34;MPAARatings&#34;</span>];</span></span></code></pre></div><p>If we add a breakpoint on this line, and run our code, then check several boxes (you&rsquo;ll have to <em>continue</em> the first time you hit the breakpoint), then step over the line, we&rsquo;ll see that the var <code>MPAA</code> rating is set to a <em>string collection</em>.  We could therefore store it in an array property in <em>Index.cshtml.cs</em>, much like we did with our <code>SearchTerms</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The filtered MPAA Ratings</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span>[] MPAARatings { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }</span></span></code></pre></div><p>And we can refactor the line we just added to <code>OnGet()</code> to use this new property:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    MPAARatings = Request.Query[<span style="color:#e6db74">&#34;MPAARatings&#34;</span>];</span></span></code></pre></div><p>Then, in our <em>Index.cshtml</em> Razor Page, we can refactor the checkbox to be checked if we filtered against this rating in our last request:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>    &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;checkbox&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;MPAARatings&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;@rating&#34;</span> <span style="color:#a6e22e">checked</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;@Model.MPAARatings.Contains(rating)&#34;</span>/&gt;</span></span></code></pre></div><p>Now our filters stick around when we submit the search request.  That just leaves making the filters actually <em>work</em>.</p>
<h2 id="applying-mpaa-rating-filters">Applying MPAA Rating Filters</h2>
<p>Let&rsquo;s add another method to our <code>MovieDatabase</code> class, <code>FilterByMPAARating()</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Filters the provided collection of movies</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;movies&#34;&gt;The collection of movies to filter&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;ratings&#34;&gt;The ratings to include&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;returns&gt;A collection containing only movies that match the filter&lt;/returns&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> IEnumerable&lt;Movie&gt; FilterByMPAARating(IEnumerable&lt;Movie&gt; movies, IEnumerable&lt;<span style="color:#66d9ef">string</span>&gt; ratings)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// TODO: Filter the list</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div><p>Notice that in <em>this</em> method, we accept an <code>IEnumerable&lt;Movie&gt;</code> parameter.  This is the list of movies we want to filter.  We use this, instead of the <code>All()</code> we did in the <code>Search()</code> method, as we would want to filter the <em>results</em> of a search.</p>
<p>Let&rsquo;s do a null/empty check, and just return this shortlist if no filters are specified:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">// If no filter is specified, just return the provided collection</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (ratings == <span style="color:#66d9ef">null</span> || ratings.Count() == <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span> movies;</span></span></code></pre></div><p>Otherwise, we&rsquo;ll use the same process we did before.  Start with an empty list of movies, and iterate over the collection seeing if any match.  However, as we have <em>two</em> collections (the movies <em>and</em> the ratings), we&rsquo;ll see if the ratings collection contains the supplied movie&rsquo;s rating.</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">// Filter the supplied collection of movies</span>
</span></span><span style="display:flex;"><span>    List&lt;Movie&gt; results = <span style="color:#66d9ef">new</span> List&lt;Movie&gt;();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">foreach</span>(Movie movie <span style="color:#66d9ef">in</span> movies)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(movie.MPAARatings != <span style="color:#66d9ef">null</span> &amp;&amp; ratings.Contains(movie.MPAARatings))
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            results.Add(movie);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div><p>Finally, we&rsquo;ll return our results:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> results;</span></span></code></pre></div><p>Now, back in our PageModel <em>Index.cshtml.cs</em>, we&rsquo;ll apply our filter to the results of our search.  The refactored <code>OnGet()</code> should then be:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> OnGet()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        SearchTerms = Request.Query[<span style="color:#e6db74">&#34;SearchTerms&#34;</span>];
</span></span><span style="display:flex;"><span>        MPAARatings = Request.Query[<span style="color:#e6db74">&#34;MPAARatings&#34;</span>];
</span></span><span style="display:flex;"><span>        Movies = MovieDatabase.Search(SearchTerms);
</span></span><span style="display:flex;"><span>        Movies = MovieDatabase.FilterByMPAARating(Movies, MPAARatings);        
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div><p>Now we can run a search with filters applied.  For example, searching for the word &ldquo;Love&rdquo; and movies that are PG or PG-13 yields:</p>
<p>
<a href="#image-5116ad001317881dcc46034459c85310" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/6.8.4.png" alt="Filtered Search Results" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-5116ad001317881dcc46034459c85310">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/6.8.4.png" alt="Filtered Search Results" class="lightbox-image" loading="lazy">
</a></p>
<p>You might be wondering why <em>Cloverfield</em> is listed.  But remember, we&rsquo;re searching by substring, and C <strong>LOVE</strong> rfield contains love!</p>
<h2 id="filtering-by-genre">Filtering by Genre</h2>
<p>Let&rsquo;s add filters for genre next.  But what genres should be included?  This is not as clear-cut as our MPAA rating, as there is no standards organization that says &ldquo;these are the only offical genres that exist.&rdquo;  In fact, new genres emerge from time to time.  So a better source of this info might just be to see what Genres are defined in our data, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    HashSet&lt;<span style="color:#66d9ef">string</span>&gt; genres = <span style="color:#66d9ef">new</span> HashSet&lt;<span style="color:#66d9ef">string</span>&gt;();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">foreach</span>(Movie movie <span style="color:#66d9ef">in</span> All) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(movie.MajorGenre != <span style="color:#66d9ef">null</span>) 
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            genres.Add(movie.MajorGenre);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div><p>Here we use a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.hashset-1?view=netframework-4.8" target="_blank">HashSet</a>
 instead of a list, as it only adds each unique item once.  Duplicates are ignored.</p>
<p>But where would this code go?  We could place it in a getter for <code>MovieDatabase.Genres</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> IEnumerable&lt;<span style="color:#66d9ef">string</span>&gt; Genres 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span> 
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            HashSet&lt;<span style="color:#66d9ef">string</span>&gt; genres = <span style="color:#66d9ef">new</span> HashSet&lt;<span style="color:#66d9ef">string</span>&gt;();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">foreach</span>(Movie movie <span style="color:#66d9ef">in</span> All) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span>(movie.MajorGenre != <span style="color:#66d9ef">null</span>) 
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    genres.Add(movie.MajorGenre);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div><p>But this means that every time we want to access it, we&rsquo;ll search through all the movies&hellip; This is an O(n) operation, and will make our website slower.</p>
<p>Instead, let&rsquo;s create a private static variable in the <code>MovieDatabase</code> class to <em>cache</em> this collection as an array of strings:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">// The genres represented in the database</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span>[] _genres;</span></span></code></pre></div><p>And expose it with a public static property:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Gets the movie genres represented in the database </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span>[] Genres =&gt; _genres;</span></span></code></pre></div><p>And finally, we&rsquo;ll populate this array in the static constructor of <code>MovieDatabase</code>, after the JSON file has been processed:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    HashSet&lt;<span style="color:#66d9ef">string</span>&gt; genreSet = <span style="color:#66d9ef">new</span> HashSet&lt;<span style="color:#66d9ef">string</span>&gt;();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">foreach</span>(Movie movie <span style="color:#66d9ef">in</span> _movies) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(movie.MajorGenre != <span style="color:#66d9ef">null</span>) 
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            genreSet.Add(movie.MajorGenre);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    _genres = genreSet.ToArray();</span></span></code></pre></div><p>This approach means the finding of genres only happens once, and getting the <code>Genre</code> property is a constant-time O(1) operation.</p>
<p>We can implement the filters for the genres in the same way as we did for the MPAA filters; I&rsquo;ll leave that as an exercise for the reader.</p>

            <footer class="footline">

            </footer>
          </article>
        </div>
      </main>
    </div>
    
    </div>
    
    
    
    
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/clipboard.min.js?1710866809" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/perfect-scrollbar.min.js?1710866809" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/theme.js?1710866809" defer></script>
    
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/tele-scroll.js?1710866809 defer"></script>
    
  </body>
</html>
