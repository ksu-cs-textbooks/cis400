<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.128.0"><meta name=generator content="Relearn 6.0.0"><meta name=description content='Perhaps the most important aspect of the DependencyObject is its support for hosting dependency properties. While these appear and can be used much like the C# properties we have previously worked with, internally they are managed very differently. Consider when we place a <TextBox> in a <Grid>:
<Grid> <Grid.ColumnDefinitions> <ColumnDefinition/> <ColumnDefinition/> </Grid.ColumnDefinitions> <Grid.RowDefinitions> <RowDefinition/> <RowDefinition/> </Grid.RowDefinitions> <TextBox Name="textBox" Grid.Column="1" Grid.Row="1"/> </Grid>Where do the Column and Row properties come from? They aren’t defined on the TextBox class - you can check the documentation.'><meta name=author content="Nathan Bean"><meta name=twitter:card content="summary"><meta name=twitter:title content="Dependency Properties :: K-State CIS 400 Textbook"><meta name=twitter:description content='Perhaps the most important aspect of the DependencyObject is its support for hosting dependency properties. While these appear and can be used much like the C# properties we have previously worked with, internally they are managed very differently. Consider when we place a <TextBox> in a <Grid>:
<Grid> <Grid.ColumnDefinitions> <ColumnDefinition/> <ColumnDefinition/> </Grid.ColumnDefinitions> <Grid.RowDefinitions> <RowDefinition/> <RowDefinition/> </Grid.RowDefinitions> <TextBox Name="textBox" Grid.Column="1" Grid.Row="1"/> </Grid>Where do the Column and Row properties come from? They aren’t defined on the TextBox class - you can check the documentation.'><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis400/2-desktop-development/05-dependency-objects/02-dependency-properties/"><meta property="og:site_name" content="K-State CIS 400 Textbook"><meta property="og:title" content="Dependency Properties :: K-State CIS 400 Textbook"><meta property="og:description" content='Perhaps the most important aspect of the DependencyObject is its support for hosting dependency properties. While these appear and can be used much like the C# properties we have previously worked with, internally they are managed very differently. Consider when we place a <TextBox> in a <Grid>:
<Grid> <Grid.ColumnDefinitions> <ColumnDefinition/> <ColumnDefinition/> </Grid.ColumnDefinitions> <Grid.RowDefinitions> <RowDefinition/> <RowDefinition/> </Grid.RowDefinitions> <TextBox Name="textBox" Grid.Column="1" Grid.Row="1"/> </Grid>Where do the Column and Row properties come from? They aren’t defined on the TextBox class - you can check the documentation.'><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="Desktop Development"><meta property="article:published_time" content="2018-08-24T10:53:26-05:00"><meta property="article:modified_time" content="2024-03-18T16:04:38-05:00"><meta itemprop=name content="Dependency Properties :: K-State CIS 400 Textbook"><meta itemprop=description content='Perhaps the most important aspect of the DependencyObject is its support for hosting dependency properties. While these appear and can be used much like the C# properties we have previously worked with, internally they are managed very differently. Consider when we place a <TextBox> in a <Grid>:
<Grid> <Grid.ColumnDefinitions> <ColumnDefinition/> <ColumnDefinition/> </Grid.ColumnDefinitions> <Grid.RowDefinitions> <RowDefinition/> <RowDefinition/> </Grid.RowDefinitions> <TextBox Name="textBox" Grid.Column="1" Grid.Row="1"/> </Grid>Where do the Column and Row properties come from? They aren’t defined on the TextBox class - you can check the documentation.'><meta itemprop=datePublished content="2018-08-24T10:53:26-05:00"><meta itemprop=dateModified content="2024-03-18T16:04:38-05:00"><meta itemprop=wordCount content="634"><title>Dependency Properties :: K-State CIS 400 Textbook</title>
<link href=https://textbooks.cs.ksu.edu/cis400/2-desktop-development/05-dependency-objects/02-dependency-properties/ rel=canonical type=text/html title="Dependency Properties :: K-State CIS 400 Textbook"><link href=/cis400/2-desktop-development/05-dependency-objects/02-dependency-properties/index.xml rel=alternate type=application/rss+xml title="Dependency Properties :: K-State CIS 400 Textbook"><link href=/cis400/2-desktop-development/05-dependency-objects/02-dependency-properties/index.print.html rel=alternate type=text/html title="Dependency Properties :: K-State CIS 400 Textbook"><link href=/cis400/2-desktop-development/05-dependency-objects/02-dependency-properties/embed.html rel=alternate type=text/html title="Dependency Properties :: K-State CIS 400 Textbook"><link href=/cis400/css/fontawesome-all.min.css?1724857981 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis400/css/fontawesome-all.min.css?1724857981 rel=stylesheet></noscript><link href=/cis400/css/nucleus.css?1724857981 rel=stylesheet><link href=/cis400/css/auto-complete.css?1724857981 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis400/css/auto-complete.css?1724857981 rel=stylesheet></noscript><link href=/cis400/css/perfect-scrollbar.min.css?1724857981 rel=stylesheet><link href=/cis400/css/fonts.css?1724857981 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis400/css/fonts.css?1724857981 rel=stylesheet></noscript><link href=/cis400/css/theme.css?1724857981 rel=stylesheet><link href=/cis400/css/theme-auto.css?1724857981 rel=stylesheet id=R-variant-style><link href=/cis400/css/chroma-auto.css?1724857981 rel=stylesheet id=R-variant-chroma-style><link href=/cis400/css/variant.css?1724857981 rel=stylesheet><link href=/cis400/css/print.css?1724857981 rel=stylesheet media=print><script src=/cis400/js/variant.js?1724857981></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../..",window.relearn.relBaseUri="../../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis400",window.index_js_url="/cis400/index.search.js",window.variants&&variants.init(["auto","light-theme","dark-theme"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><link href=/cis400/css/custom.css?1724857981 rel=stylesheet></head><body class="mobile-support tele disableInlineCopyToClipboard" data-url=/cis400/2-desktop-development/05-dependency-objects/02-dependency-properties/><div id=tele class="tele mirror"><div id=R-body class=default-animation><div id=R-body-overlay></div><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=dependency-properties>Dependency Properties</h1><p>Perhaps the most important aspect of the <code>DependencyObject</code> is its support for hosting <em>dependency properties</em>. While these appear and can be used much like the C# properties we have previously worked with, internally they are managed very differently. Consider when we place a <code>&lt;TextBox></code> in a <code>&lt;Grid></code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;Grid&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;ColumnDefinition/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;ColumnDefinition/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Grid.RowDefinitions&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;RowDefinition/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;RowDefinition/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Grid.RowDefinitions&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;TextBox</span> <span class=na>Name=</span><span class=s>&#34;textBox&#34;</span> <span class=na>Grid.Column=</span><span class=s>&#34;1&#34;</span> <span class=na>Grid.Row=</span><span class=s>&#34;1&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Grid&gt;</span></span></span></code></pre></div><p>Where do the <code>Column</code> and <code>Row</code> properties come from? They aren&rsquo;t defined on the <code>TextBox</code> class - you can <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.textbox?view=netcore-3.1#properties" rel=external target=_blank>check the documentation</a>. The answer is they are made available through the dependency property system.</p><p>At the heart of this system is a collection of key/value pairs much like the <code>Dictionary</code>. When the XAML code <code>Grid.Column="1"</code> is processed, this key and value are added to the <code>TextBox</code>&rsquo;s dependency properties collection, and is thereafter accessible by the WPF rendering algorithm.</p><p>The <code>DependencyObject</code> exposes these stored values with the <code>GetValue(DependencyProperty)</code> and <code>SetValue(DependencyProperty, value)</code> methods. For example, we can set the <code>Column</code> property to <code>2</code> with:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=n>textBox</span><span class=p>.</span><span class=n>SetValue</span><span class=p>(</span><span class=n>Grid</span><span class=p>.</span><span class=n>ColumnProperty</span><span class=p>,</span> <span class=m>2</span><span class=p>);</span></span></span></code></pre></div><p>We can also create <em>new</em> dependency properties on our own custom classes extending the <code>DependencyObject</code> (which is also a base class for all WPF controls). Let&rsquo;s say we are making a custom control for entering number values on a touch screen, which we&rsquo;ll call <code>NumberBox</code>. We can extend a <code>UserControl</code> to create a textbox centered between two buttons, one to increase the value, and one to decrease it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;UserControl</span> <span class=na>x:Class=</span><span class=s>&#34;CustomDependencyObjectExample.NumberBox&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns:x=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns:mc=</span><span class=s>&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span class=line><span class=cl>             <span class=na>xmlns:d=</span><span class=s>&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span> 
</span></span><span class=line><span class=cl>             <span class=na>xmlns:local=</span><span class=s>&#34;clr-namespace:CustomDependencyObjectExample&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>mc:Ignorable=</span><span class=s>&#34;d&#34;</span> 
</span></span><span class=line><span class=cl>             <span class=na>d:DesignHeight=</span><span class=s>&#34;50&#34;</span> <span class=na>d:DesignWidth=</span><span class=s>&#34;200&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Grid&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;ColumnDefinition/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;ColumnDefinition</span> <span class=na>Width=</span><span class=s>&#34;2*&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;ColumnDefinition/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Grid.Column=</span><span class=s>&#34;0&#34;</span><span class=nt>&gt;</span>+<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;TextBox</span> <span class=na>Grid.Column=</span><span class=s>&#34;1&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Grid.Column=</span><span class=s>&#34;2&#34;</span><span class=nt>&gt;</span>-<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Grid&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/UserControl&gt;</span></span></span></code></pre></div><p>Now, let&rsquo;s assume we want to provide a property <code>Step</code> of type <code>double</code>, which is the amount the number should be incremented when the &ldquo;+&rdquo; or &ldquo;-&rdquo; button is pressed.</p><p>The first step is to <em>register</em> the dependency property by creating a <code>DependencyProperty</code> instance. This will serve as the key to setting and retrieving the dependency property on a dependency object. We register new dependency properties with <code>DependencyProperty.Register(string propertyName, Type propertyType, Type dependencyObjectType)</code>. The string is the name of the property, the first type is the type of the property, and the second is the class we want to associate this property with. So our <code>Step</code> property would be registered with:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=n>DependencyProperty</span><span class=p>.</span><span class=n>Register</span><span class=p>(</span><span class=n>nameof</span><span class=p>(</span><span class=n>Step</span><span class=p>),</span> <span class=k>typeof</span><span class=p>(</span><span class=kt>double</span><span class=p>),</span> <span class=k>typeof</span><span class=p>(</span><span class=n>NumberBox</span><span class=p>));</span></span></span></code></pre></div><p>There is an optional fourth property to <code>DependencyProperty.Register()</code> which is a <code>PropertyMetadata</code>. This is used to set the default value of the property. We probably should specify a default step, so let&rsquo;s add a <code>PropertyMetadata</code> object with a default value of 1:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=n>DependencyProperty</span><span class=p>.</span><span class=n>Register</span><span class=p>(</span><span class=n>nameof</span><span class=p>(</span><span class=n>Step</span><span class=p>),</span> <span class=k>typeof</span><span class=p>(</span><span class=kt>double</span><span class=p>),</span> <span class=k>typeof</span><span class=p>(</span><span class=n>NumberBox</span><span class=p>),</span> <span class=k>new</span> <span class=n>PropertyMetadata</span><span class=p>(</span><span class=m>1.0</span><span class=p>));</span></span></span></code></pre></div><p>The <code>DependencyProperty.Register()</code> method returns a registered <code>DependencyObject</code> to serve as a key for accessing our new property. To make sure we can access this key from <em>other</em> classes, we define it as a field that is <code>public</code>, <code>static</code>, and <code>readonly</code>. The naming convention for <code>DependencyProperties</code> is to name this field by appending &ldquo;Property&rdquo; to the name of the property.</p><p>Thus, the complete registration, including saving the result to the public static field is:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// Identifies the NumberBox.Step XAML attached property</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=k>readonly</span> <span class=n>DependencyProperty</span> <span class=n>StepProperty</span> <span class=p>=</span> <span class=n>DependencyProperty</span><span class=p>.</span><span class=n>Register</span><span class=p>(</span><span class=n>nameof</span><span class=p>(</span><span class=n>Step</span><span class=p>),</span> <span class=k>typeof</span><span class=p>(</span><span class=kt>double</span><span class=p>),</span> <span class=k>typeof</span><span class=p>(</span><span class=n>NumberBox</span><span class=p>),</span> <span class=k>new</span> <span class=n>PropertyMetadata</span><span class=p>(</span><span class=m>1.0</span><span class=p>));</span> </span></span></code></pre></div><p>We also want to declare a traditional property with the name &ldquo;Step&rdquo;. But instead of declaring a backing field, we will use the key/value pair stored in our <code>DependencyObject</code> using <code>GetValue()</code> and <code>SetValue()</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// The amount each increment or decrement operation should change the value by</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>double</span> <span class=n>Step</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>get</span> <span class=p>{</span> <span class=k>return</span> <span class=p>(</span><span class=kt>double</span><span class=p>)</span><span class=n>GetValue</span><span class=p>(</span><span class=n>StepProperty</span><span class=p>);</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>set</span> <span class=p>{</span> <span class=n>SetValue</span><span class=p>(</span><span class=n>StepProperty</span><span class=p>,</span> <span class=k>value</span><span class=p>);</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>As dependency property values are stored as an <code>object</code>, we need to cast the value to a the appropriate type when it is returned.</p><p>One of the great benefits of dependency properties is that they can be set using XAML. I.e. we could declare an instance of our <code>&lt;NumberBox></code> and set its <code>Step</code> using an attribute:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;StackPanel&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;NumberBox</span> <span class=na>Step=</span><span class=s>&#34;3.0&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/StackPanel&gt;</span></span></span></code></pre></div><footer class=footline></footer></article></div></main></div></div><script src=/cis400/js/clipboard.min.js?1724857981 defer></script><script src=/cis400/js/perfect-scrollbar.min.js?1724857981 defer></script><script src=/cis400/js/theme.js?1724857981 defer></script><script src=/cis400/js/tele-scroll.js?1724857981 defer></script></body></html>