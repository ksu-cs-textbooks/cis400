




	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		
		
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.117.0">
    <meta name="generator" content="Relearn 5.18.0">
    <meta name="description" content="K-State CIS 400 Textbook">
    <meta name="author" content="Nathan Bean">
    <title>Dependency Properties :: K-State CIS 400 Textbook</title>
    <link href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/05-dependency-objects/02-dependency-properties/index.html" rel="canonical" type="text/html" title="Dependency Properties :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/05-dependency-objects/02-dependency-properties/index.xml" rel="alternate" type="application/rss+xml" title="Dependency Properties :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/05-dependency-objects/02-dependency-properties/index.print.html" rel="alternate" type="text/html" title="Dependency Properties :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/05-dependency-objects/02-dependency-properties/tele.html" rel="alternate" type="text/html" title="Dependency Properties :: K-State CIS 400 Textbook">
    
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/fontawesome-all.min.css?1709159292" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/fontawesome-all.min.css?1709159292" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/nucleus.css?1709159292" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/auto-complete.css?1709159292" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/auto-complete.css?1709159292" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/perfect-scrollbar.min.css?1709159292" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/fonts.css?1709159292" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/fonts.css?1709159292" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/theme.css?1709159292" rel="stylesheet">
    
    
    
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/theme-light-theme.css?1709159292" rel="stylesheet" id="variant-style">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/variant.css?1709159292" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/print.css?1709159292" rel="stylesheet" media="print">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/ie.css?1709159292" rel="stylesheet">
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/url.js?1709159292"></script>
    
    
    
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="https://ksu-cs-textbooks.github.io/cis400/index.search.js";
      var root_url="https://ksu-cs-textbooks.github.io/cis400/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/ksu-cs-textbooks.github.io\/cis400/';
      window.variants && variants.init( [ 'light-theme', 'dark-theme' ] );
    </script>
    
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/custom.css?1709159292" rel="stylesheet">

    
  </head>
  <body class="mobile-support embed disableInlineCopyToClipboard" data-url="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/05-dependency-objects/02-dependency-properties/embed.html">
    <div id="body" class="default-animation">
      
      
      
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
    
    
    
<p>Perhaps the most important aspect of the <code>DependencyObject</code> is its support for hosting <em>dependency properties</em>.  While these appear and can be used much like the C# properties we have previously worked with, internally they are managed very differently.  Consider when we place a <code>&lt;TextBox&gt;</code> in a <code>&lt;Grid&gt;</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid.RowDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;RowDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;RowDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid.RowDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;textBox&#34;</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Grid&gt;</span></span></span></code></pre></div><p>Where do the <code>Column</code> and <code>Row</code> properties come from?  They aren&rsquo;t defined on the <code>TextBox</code> class - you can <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.textbox?view=netcore-3.1#properties" target="_blank">check the documentation</a>
.  The answer is they are made available through the dependency property system.</p>
<p>At the heart of this system is a collection of key/value pairs much like the <code>Dictionary</code>.  When the XAML code <code>Grid.Column=&quot;1&quot;</code> is processed, this key and value are added to the <code>TextBox</code>&rsquo;s dependency properties collection, and is thereafter accessible by the WPF rendering algorithm.</p>
<p>The <code>DependencyObject</code> exposes these stored values with the <code>GetValue(DependencyProperty)</code> and <code>SetValue(DependencyProperty, value)</code> methods.  For example, we can set the <code>Column</code> property to <code>2</code> with:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>textBox.SetValue(Grid.ColumnProperty, <span style="color:#ae81ff">2</span>);</span></span></code></pre></div><p>We can also create <em>new</em> dependency properties on our own custom classes extending the <code>DependencyObject</code> (which is also a base class for all WPF controls).  Let&rsquo;s say we are making a custom control for entering number values on a touch screen, which we&rsquo;ll call <code>NumberBox</code>.  We can extend a <code>UserControl</code> to create a textbox centered between two buttons, one to increase the value, and one to decrease it:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;CustomDependencyObjectExample.NumberBox&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:CustomDependencyObjectExample&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;50&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;2*&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;0&#34;</span><span style="color:#f92672">&gt;</span>+<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;2&#34;</span><span style="color:#f92672">&gt;</span>-<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div><p>Now, let&rsquo;s assume we want to provide a property <code>Step</code> of type <code>double</code>, which is the amount the number should be incremented when the &ldquo;+&rdquo; or &ldquo;-&rdquo; button is pressed.</p>
<p>The first step is to <em>register</em> the dependency property by creating a <code>DependencyProperty</code> instance.  This will serve as the key to setting and retrieving the dependency property on a dependency object.  We register new dependency properties with <code>DependencyProperty.Register(string propertyName, Type propertyType, Type dependencyObjectType)</code>.  The string is the name of the property, the first type is the type of the property, and the second is the class we want to associated this property with.  So our <code>Step</code> property would be registered with:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>DependencyProperty.Register(nameof(Step), <span style="color:#66d9ef">typeof</span>(<span style="color:#66d9ef">double</span>), <span style="color:#66d9ef">typeof</span>(NumberBox));</span></span></code></pre></div><p>There is an optional fourth property to <code>DependencyProperty.Register()</code> which is a <code>PropertyMetadata</code>.  This is used to set the default value of the property.  We probably should specify a default step, so let&rsquo;s add a <code>PropertyMetadata</code> object with a default value of 1:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>DependencyProperty.Register(nameof(Step), <span style="color:#66d9ef">typeof</span>(<span style="color:#66d9ef">double</span>), <span style="color:#66d9ef">typeof</span>(NumberBox), <span style="color:#66d9ef">new</span> PropertyMetadata(<span style="color:#ae81ff">1.0</span>));</span></span></code></pre></div><p>The <code>DependencyProperty.Register()</code> method returns a registered <code>DependencyObject</code> to serve as a key for accessing our new property.  To make sure we can access this key from <em>other</em> classes, we define it as a field that is <code>public</code>, <code>static</code>, and <code>readonly</code>.  The naming convention for <code>DependencyProperties</code> is to name this field by appending &ldquo;Property&rdquo; to the name of the property.</p>
<p>Thus, the complete registration, including saving the result to the public static field is:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// Identifies the NumberBox.Step XAML attached property</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">readonly</span> DependencyProperty StepProperty = DependencyProperty.Register(nameof(Step), <span style="color:#66d9ef">typeof</span>(<span style="color:#66d9ef">double</span>), <span style="color:#66d9ef">typeof</span>(NumberBox), <span style="color:#66d9ef">new</span> PropertyMetadata(<span style="color:#ae81ff">1.0</span>)); </span></span></code></pre></div><p>We also want to declare a traditional property with the name &ldquo;Step&rdquo;.  But instead of declaring a backing field, we will use the key/value pair stored in our <code>DependencyObject</code> using <code>GetValue()</code> and <code>SetValue()</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// The amount each increment or decrement operation should change the value by</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> Step
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">double</span>)GetValue(StepProperty); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">set</span> { SetValue(StepProperty, <span style="color:#66d9ef">value</span>); }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>As dependency property values are stored as an <code>object</code>, we need to cast the value to a the appropriate type when it is returned.</p>
<p>One of the great benefits of dependency properties is that they can be set using XAML.  I.e. we could declare an instance of our <code>&lt;NumberBox&gt;</code> and set its <code>Step</code> using an attribute:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;NumberBox</span> <span style="color:#a6e22e">Step=</span><span style="color:#e6db74">&#34;3.0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/StackPanel&gt;</span></span></span></code></pre></div>
            <footer class="footline">

            </footer>
          </article>
        </div>
      </main>
    </div>
    
    
    
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/clipboard.min.js?1709159295" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/perfect-scrollbar.min.js?1709159295" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/theme.js?1709159295" defer></script>
    
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/embed-iframe.js?1709159295 defer"></script>
  </body>
</html>
