




	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		
		
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.117.0">
    <meta name="generator" content="Relearn 5.18.0">
    <meta name="description" content="K-State CIS 400 Textbook">
    <meta name="author" content="Nathan Bean">
    <title>CollectionChanged :: K-State CIS 400 Textbook</title>
    <link href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/03-events/09-collection-changed/index.html" rel="canonical" type="text/html" title="CollectionChanged :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/03-events/09-collection-changed/index.xml" rel="alternate" type="application/rss+xml" title="CollectionChanged :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/03-events/09-collection-changed/index.print.html" rel="alternate" type="text/html" title="CollectionChanged :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/03-events/09-collection-changed/embed.html" rel="alternate" type="text/html" title="CollectionChanged :: K-State CIS 400 Textbook">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/fontawesome-all.min.css?1709046381" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/fontawesome-all.min.css?1709046381" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/nucleus.css?1709046381" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/auto-complete.css?1709046381" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/auto-complete.css?1709046381" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/perfect-scrollbar.min.css?1709046381" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/fonts.css?1709046381" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/fonts.css?1709046381" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/theme.css?1709046381" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/theme-auto.css?1709046381" rel="stylesheet" id="variant-style">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/variant.css?1709046381" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/print.css?1709046381" rel="stylesheet" media="print">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/ie.css?1709046381" rel="stylesheet">
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/url.js?1709046381"></script>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/variant.js?1709046381"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="https://ksu-cs-textbooks.github.io/cis400/index.search.js";
      var root_url="https://ksu-cs-textbooks.github.io/cis400/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/ksu-cs-textbooks.github.io\/cis400/';
      window.variants && variants.init( [ 'auto', 'light-theme', 'dark-theme' ] );
    </script>
    
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/custom.css?1709046381" rel="stylesheet">

  </head>
  <body class="mobile-support tele disableInlineCopyToClipboard" data-url="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/03-events/09-collection-changed/index.html">
    
    <div id="tele" class="tele mirror">
    
    <div id="body" class="default-animation">
      
      
      
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>
<h1 id="collectionchanged">CollectionChanged</h1>

<p>The <code>PropertyChanged</code> event notifies us when a <em>property</em> of an object changes, which covers most of our GUI notification needs.  However, there are some concepts that aren&rsquo;t covered by it - specifically, when an item is added or removed from a collection.  We use a different event, <code>NotifyCollectionChanged</code> to convey when this occurs.</p>
<h3 id="the-inotifycollectionchanged-interface">The INotifyCollectionChanged Interface</h3>
<p>The <code>INotifyCollectionChanged</code> interface defined in the <code>System.Collections.Specialized</code> namespace indicates the collection implements the <code>NotifyCollectionChangedEventHandler</code>, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> NotifyCollectionChangedEventHandler? NotifyCollectionChanged;</span></span></code></pre></div><p>And, as you would expect, this event is triggered any time the collection&rsquo;s contents change, much like the <code>PropertyChanged</code> event we discussed earlier was triggered when a property changed.  However, the <code>NotifyCollectionChangedEventArgs</code> provides a <em>lot</em> more information than we saw with the <code>PropertyChangedEventArgs</code>,as you can see in the UML diagram below:</p>
<p>
<a href="#image-26291b6f8580f998152c61f303ac6040" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.3.9.1.png" alt="UML or NotifyCollectionChangedEventArgs and PropertyChangedEventArgs" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-26291b6f8580f998152c61f303ac6040">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.3.9.1.png" alt="UML or NotifyCollectionChangedEventArgs and PropertyChangedEventArgs" class="lightbox-image" loading="lazy">
</a></p>
<p>With <code>PropertyChangedEventArgs</code> we simply provide the name of the property that is changing.  But with <code>NotifyCollectionChangedEventArgs</code>, we are describing both <em>what</em> the change is (i.e. an Add, Remove, Replace, Move, or Reset), and what item(s) we affected.  So if the action was adding an item, the <code>NotifyCollectionChangedEventArgs</code> will let us know what item was added to the collection, and possibly at what position it was added at.</p>
<p>When implementing the <code>INotifyCollectionChanged</code> interface, you must supply a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.collections.specialized.notifycollectionchangedeventargs?view=net-5.0" target="_blank"><code>NotifyCollectionChangedEventArgs</code> object</a> that describes the change to the collection.  This class has multiple constructors, and you must select the correct one, or your code will cause a runtime error when the event is invoked.</p>

  
  
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>You might be wondering why <code>PropertyChangedEventArgs</code> contains so little information compared to <code>NotifyCollectionChangedEventArgs</code>.  Most notably, the <em>old</em> and <em>new</em> values of the property could have been included. I suspect the reason they were not is that there are many times where you don&rsquo;t actually need to know what the property value is - just that it changed, and you can always retrieve that value once you know you need to.</p>
<p>In contrast, there are situations where a GUI displaying a collection may have hundreds of entries. Identifying <em>exactly</em> which ones have changed means that only those entries need to be modified in the GUI.  If we didn&rsquo;t have that information, we&rsquo;d have to retrieve the <em>entire</em> collection and re-render it, which can be a very computationally expensive process.</p>
<p>But ultimately, the two interfaces were developed by different teams at different times, which probably accounts for most of the differences.</p>
</div>
</div>
<h4 id="notifycollectionchangedaction">NotifyCollectionChangedAction</h4>
<p>The only property of the <code>NotifyCollectionChangedArgs</code> that will <em>always</em> be populated is the <code>Action</code> property.  The type of htis property is the <code>NotifyCollectionChangedAction</code> enumeration, and its values (and what they represent) are:</p>
<ul>
<li><code>NotifyCollectionChangedAction.Add</code> - one or more items were added to the collection</li>
<li><code>NotifyCollectionChangedAction.Move</code> - an item was moved in the collection</li>
<li><code>NotifyCollectionChangedAction.Remove</code> - one or more items were removed from the collection</li>
<li><code>NotifyCollectionChangedAction.Replace</code> - an item was replaced in the collection</li>
<li><code>NotifyCollectionChangedAction.Reset</code> - drastic changes were made to the collection</li>
</ul>
<h4 id="notifycollectionchangedeventargs-constructors">NotifyCollectionChangedEventArgs Constructors</h4>
<p>A second feature you probably noticed from the UML is that there are a <em>lot</em> of constructors for the <code>NotifyCollectionChangedEventArgs</code>.  Each represents a different situation, and you must pick the appropriate one.</p>
<p>For example, the <code>NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction)</code> constructor represents a <code>NotifyCollectionChangedAction.Reset</code> change. This indicates the collection&rsquo;s content changed <em>dramatically</em>, and the best recourse for a GUI is to ask for the full collection again and rebuild the display.  You should <em>only</em> use this one-argument constructor for a Reset action.</p>

  
  
<div class="box notices cstyle warning">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div>
  <div class="box-content">

<p>In C#, there is no mechanism for limiting a constructor to specific argument values. So you actually <em>can</em> call the above constructor for a different kind of event, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">new</span> NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Add);</span></span></code></pre></div><p>However, doing so will throw a <code>InvalidArgumentException</code> when the code is actually executed.</p>
</div>
</div>
<p>In general, if you are adding or removing an <code>object</code>, you need to provide the <code>object</code> to the constructor. If you are adding or removing multiple objects, you will need to provide an <code>IList</code> of the affected objects.  And you may also need to provide the object&rsquo;s index in the collection. You can read more about the available constructors and their uses in the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.collections.specialized.notifycollectionchangedeventargs.-ctor?view=net-6.0#system-collections-specialized-notifycollectionchangedeventargs-ctor%28system-collections-specialized-notifycollectionchangedaction-system-object%29" target="_blank">Microsoft Documentation</a>
.</p>

            <footer class="footline">

            </footer>
          </article>
        </div>
      </main>
    </div>
    
    </div>
    
    
    
    
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/clipboard.min.js?1709046383" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/perfect-scrollbar.min.js?1709046383" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/theme.js?1709046383" defer></script>
    
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/tele-scroll.js?1709046383 defer"></script>
    
  </body>
</html>
