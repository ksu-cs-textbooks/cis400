




	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		
		
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.117.0">
    <meta name="generator" content="Relearn 5.18.0">
    <meta name="description" content="K-State CIS 400 Textbook">
    <meta name="author" content="Nathan Bean">
    <title>Desktop Development :: K-State CIS 400 Textbook</title>
    <link href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/index.html" rel="canonical" type="text/html" title="Desktop Development :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/index.xml" rel="alternate" type="application/rss+xml" title="Desktop Development :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/tele.html" rel="alternate" type="text/html" title="Desktop Development :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/embed.html" rel="alternate" type="text/html" title="Desktop Development :: K-State CIS 400 Textbook">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/fontawesome-all.min.css?1710866800" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/fontawesome-all.min.css?1710866800" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/nucleus.css?1710866800" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/auto-complete.css?1710866800" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/auto-complete.css?1710866800" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/perfect-scrollbar.min.css?1710866800" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/fonts.css?1710866800" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/fonts.css?1710866800" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/theme.css?1710866800" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/theme-auto.css?1710866800" rel="stylesheet" id="variant-style">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/variant.css?1710866800" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/print.css?1710866800" rel="stylesheet" media="print">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/format-print.css?1710866800" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/ie.css?1710866800" rel="stylesheet">
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/url.js?1710866800"></script>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/variant.js?1710866800"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="https://ksu-cs-textbooks.github.io/cis400/index.search.js";
      var root_url="https://ksu-cs-textbooks.github.io/cis400/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/ksu-cs-textbooks.github.io\/cis400/';
      window.variants && variants.init( [ 'auto', 'light-theme', 'dark-theme' ] );
    </script>
    
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/custom.css?1710866800" rel="stylesheet">

  </head>
  <body class="mobile-support print disableInlineCopyToClipboard" data-url="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/index.html">
    <div id="body" class="default-animation">
      <div id="sidebar-overlay"></div>
      <div id="toc-overlay"></div>
      <nav id="topbar" class="highlightable">
        <div>
          <div id="top-tele-link">
            <a class="print-link" title='Teleprompter View' href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/tele.html">
              <i class="fas fa-tv fa-fw"></i>
            </a>
          </div>
          <div id="top-embed-link">
            <a class="print-link" title='Embeddable Version' href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/embed.html">
              <i class="fas fa-expand-arrows-alt fa-fw"></i>
            </a>
          </div>
          <div id="breadcrumbs">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" class="topbar-link" title='Menu (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a>
            </span>
            <ol class="links" itemscope itemtype="http://schema.org/BreadcrumbList">
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="https://ksu-cs-textbooks.github.io/cis400/index.html"><span itemprop="name">CIS 400: Object-Oriented Design, Implementation, and Testing</span></a><meta itemprop="position" content="1"> &gt; </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Desktop Development</span><meta itemprop="position" content="2"></li>
            </ol>
          </div>
        </div>
      </nav>
      <main id="body-inner" class="highlightable chapter narrow" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="chapter">
            <header class="headline">
            </header>


<div class="article-subheading">Chapter II</div>
<h1 id="desktop-development">Desktop Development</h1>

<p>Objects Go to Work</p>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Desktop Development</h1>
    
    
          <article class="chapter">
            <header class="headline">
            </header>


<div class="article-subheading">Chapter 1</div>
<h1 id="windows-presentation-foundation">Windows Presentation Foundation</h1>

<p>Some clever statement&hellip;</p>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Windows Presentation Foundation</h1>
    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="introduction">Introduction</h1>

<p>Windows Presentation Foundation (WPF) is a open-source system for rendering Windows application user interfaces.  It was released as part of the .NET framework in 2006.  In many ways, it is intended to be a successor to Windows Forms. This chapter will examine the basics of working with WPF in detail.</p>
<h2 id="key-terms">Key Terms</h2>
<p>Some key terms to learn in this chapter are:</p>
<ul>
<li>Graphical User Interface (GUI)</li>
<li>Windows Presentation Foundation (WPF)</li>
<li>Extensible Application Markup Language (XAML)</li>
<li>Codebehind</li>
<li>Layouts</li>
<li>Controls</li>
<li>Component-Based Design</li>
<li>Composition</li>
</ul>
<h2 id="key-skills">Key Skills</h2>
<p>The key skill to learn in this chapter is how to use C# and XAML to develop WPF user interfaces that adapt to device screen dimensions.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="wpf-features">WPF Features</h1>

<p>Windows Presentation Foundation is a library and toolkit for creating Graphical User Interfaces - a user interface that is presented as a combination of interactive graphical and text elements commonly including buttons, menus, and various flavors of editors and inputs.  GUIs represent a major step forward in usability from earlier programs that were interacted with by typing commands into a text-based terminal (the EPIC software we looked at in the beginning of this textbook is an example of this earlier form of user interface).</p>
<p>You might be wondering why Microsoft introduced WPF when it already had support for creating GUIs in its earlier Windows Forms product.  In part, this decision was driven by the evolution of computing technology.</p>
<h3 id="screen-resolution-and-aspect-ratio">Screen Resolution and Aspect Ratio</h3>
<p>No doubt you are used to having a wide variety of screen resolutions available across a plethora of devices.  But this was not always the case.  Computer monitors once came in very specific, standardized resolutions, and only gradually were these replaced by newer, higher-resolution monitors.  The table below summarizes this time, indicating the approximate period each resolution dominated the market.</p>
<table>
  <tr>
    <th>Standard</th>
    <th>Size</th>
    <th>Peak Years</th>
  </tr>
  <tr>
    <td>VGA</td>
    <td>640x480</td>
    <td>1987-1990</td>
  </tr>
  <tr>
    <td>SVGA</td>
    <td>800x600</td>
    <td>1990-2003</td>
  </tr>
  <tr>
    <td>XGA</td>
    <td>1024x768</td>
    <td>2007-2015</td>
  </tr>
</table>
<p>Windows Forms was introduced in the early 2000&rsquo;s, at a time where the most popular screen resolution in the United States was transitioning from SVGA to XGA, and screen resolutions (especially for business computers running Windows) had remained remarkably consistent for long periods.  Moreover, these resolutions were all using the 4:3 aspect ratio (the ratio of width to height of the screen).  Hence, the developers of Windows forms did not consider the need to support vastly different screen resolutions and aspect ratios.  Contrast that with trends since that time:</p>
<p>
<a href="#image-f401e9cfda962ed9101a0e857062084d" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.2.1.png" alt="Screen Resolutions in US from 2009-2020" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-f401e9cfda962ed9101a0e857062084d">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.2.1.png" alt="Screen Resolutions in US from 2009-2020" class="lightbox-image" loading="lazy">
</a></p>
<p>There is no longer a clearly dominating resolution, nor even an aspect ratio! Thus, it has become increasingly important for Windows applications to adapt to different screen resolutions.  Windows Forms does not do this easily - each element in a Windows Forms application has a statically defined width and height, as well as its position in the window.  Altering these values in response to different screen resolution requires significant calculations to resize and reposition the elements, and the code to perform these calculations must be written by the programmer.</p>
<p>In contrast, WPF adopts a multi-pass layout mechanism similar to that of a web browser, where it calculates the necessary space for each element within the GUI, then adapts the layout based on the actual space.  With careful design, the need for writing code to position and size elements is eliminated, and the resulting GUIs adapt well to the wide range of available screen sizes.</p>
<h3 id="direct3d-and-hardware-graphics-acceleration">Direct3D and Hardware Graphics Acceleration</h3>
<p>Another major technology shift was the widespread adoption of hardware-accelerated 3D graphics.  In the 1990&rsquo;s this technology was limited to computers built specifically for playing video games, 3D modeling, video composition, or other graphics-intensive tasks.  But by 2006, this hardware had become so widely accepted that with Windows Vista, Microsoft redesigned the Windows kernel to leverage this technology to take on the task of rendering windows applications.</p>
<p>WPF leveraged this decision and offloads much of the rendering work to the graphics hardware.  This meant that WPF controls could be vector-based, instead of the raster-based approach adopted by Windows Forms.  Vector-based rendering means the image to be drawn on-screen is created from instructions as needed, rather than copied from a bitmap.  This allows controls to look as sharp when scaled to different screen resolutions or enhanced by software intended to support low-vision users.  Raster graphics scaled the same way will look pixelated and jagged.</p>
<p>Leveraging the power of hardware accelerated graphics also allowed for the use of more powerful animations and transitions, as well as freeing up the CPU for other tasks.  It also simplifies the use of 3D graphics in windows applications.  WPF also leveraged this power to provide a rich storyboarding and animation system as well as inbuilt support for multimedia. In contrast, Windows Forms applications are completely rendered using the CPU and offer only limited support for animations and multimedia resources.</p>
<h3 id="customizable-styling-and-template-system">Customizable Styling and Template System</h3>
<p>One additional shift is that Windows forms leverage controls built around graphical representations provided directly by the hosting Windows operating system.  This helped keep windows applications looking and feeling like the operating system they were deployed on, but limits the customizability of the controls.  A commonly attempted feature - placing an image on a button - becomes an onerous task within Windows Forms.  Attempting to customize controls often required the programmer to take over the rendering work entirely, providing the commands to render the raw shapes of the control directly onto the control&rsquo;s canvas.  Unsurprisingly, an entire secondary market for pre-developed custom controls emerged to help counter this issue.</p>
<p>In contrast, WPF separated control rendering from windows subsystems, and implemented a declarative style of defining user interfaces using Extensible Application Markup Language (XAML).  This provides the programmer complete control over how controls are rendered, and multiple mechanisms of increasing complexity to accomplish this.  Style properties can be set on individual controls, or bundled into &ldquo;stylesheets&rdquo; and applied en-masse.  Further, each control&rsquo;s default style is determined by a template that can be replaced with a custom implementation, completely altering the appearance of a control.</p>
<p>This is just the tip of the iceberg - WPF also features a new and robust approach to data binding that will be subject of its own chapter, and allows for UI to be completely separated from logic, allowing for more thorough unit testing of application code.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="xaml">XAML</h1>

<p>Windows Presentation Foundation builds upon Extensible Application Markup Language (XAML), an extension of the XML language we&rsquo;ve discussed previously.  Just like XML, it consists of elements defined by opening and closing tags.</p>
<p>For example, a button is represented by:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Button&gt;&lt;/Button&gt;</span></span></span></code></pre></div><p>Which, because it has no children, could also be expressed with a self-closing tag:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Button/&gt;</span></span></span></code></pre></div><p>In addition, elements can have <em>attributes</em>, i.e we could add a height, width, and content to our button:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;30&#34;</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;120&#34;</span> <span style="color:#a6e22e">Content=</span><span style="color:#e6db74">&#34;Click Me!&#34;</span><span style="color:#f92672">/&gt;</span></span></span></code></pre></div><p>XAML also offers an <em>expanded</em> property syntax that is an alternative to attributes.  For example, we could re-write the above button as:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Button&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Button.Height&gt;</span>30<span style="color:#f92672">&lt;/Button.Height&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Button.Width&gt;</span>120<span style="color:#f92672">&lt;/Button.Width&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Button.Content&gt;</span>Click Me!<span style="color:#f92672">&lt;/Button.Content&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Button&gt;</span></span></span></code></pre></div><p>Note how we repeat the tag name (<code>Button</code>) and append the attribute name (<code>Height</code>, <code>Width</code>, and <code>Content</code> to it with a period between the two).  This differentiates the expanded property from nested elements, i.e. in this XAML code:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ColumnDefinition</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ColumnDefinition</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ColumnDefinition</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Grid.RowDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;RowDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;RowDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/Grid.RowDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;30&#34;</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;120&#34;</span> <span style="color:#a6e22e">Content=</span><span style="color:#e6db74">&#34;Click Me!&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Grid&gt;</span></span></span></code></pre></div><p><code>&lt;Grid.ColumnDefinitions&gt;</code> and <code>&lt;Grid.RowDefinitions&gt;</code> are attributes of the <code>&lt;Grid&gt;</code>, while <code> &lt;Button Height=&quot;30&quot; Width=&quot;120&quot; Content=&quot;Click Me!&quot;/&gt;</code> is a child element of the <code>&lt;Grid&gt;</code> element.</p>
<p>Because XAML is an extension of XML, we can add comments the same way, by enclosing the comment within a <code>&lt;!--</code> and <code>--&gt;</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- I am a comment --&gt;</span></span></span></code></pre></div><h2 id="xaml-defines-objects">XAML Defines Objects</h2>
<p>What makes XAML different from vanilla XML is that <em>it defines objects</em>.  The XAML used for Windows Presentation Foundation is drawn from the <div style="display:inline"><a href="http://schemas.microsoft.com/winfx/2006/xaml/presentation" target="_blank">http://schemas.microsoft.com/winfx/2006/xaml/presentation</a>
</div> namespace.  This namespace defines exactly what elements exist in this flavor of XAML, and they correspond to specific classes defined in the WPF namespaces.</p>
<p>For example, the <code>&lt;Button&gt;</code> class corresponds to the WPF <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.button?view=netcore-3.1" target="_blank">Button</a>
 class. This class has a <code>Content</code> property which defines the text or other content displayed on the button.  Additionally, it has a <code>Width</code> and <code>Height</code> property.  Thus the XAML:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;30&#34;</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;120&#34;</span> <span style="color:#a6e22e">Content=</span><span style="color:#e6db74">&#34;Click Me!&#34;</span><span style="color:#f92672">/&gt;</span></span></span></code></pre></div><p>Effectively says <em>construct an instance of the <code>Button</code> class with its <code>Height</code> property set to 30, its <code>Width</code> property set to 120, and its <code>Content</code> property set to the string <code>&quot;Click Me!&quot;</code></em>.  Were we to write the corresponding C# code, it would look like:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> button = <span style="color:#66d9ef">new</span> Button();
</span></span><span style="display:flex;"><span>button.Height = <span style="color:#ae81ff">30</span>;
</span></span><span style="display:flex;"><span>button.Width = <span style="color:#ae81ff">120</span>;
</span></span><span style="display:flex;"><span>button.Content = <span style="color:#e6db74">&#34;Click Me!&#34;</span>;</span></span></code></pre></div><p>This is why XAML stands for Extensible <em>Application</em> Markup Language - it&rsquo;s effectively another way of writing programs! You can find the documentation for all the controls declared in the xaml/presentation namespace on <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls?view=netcore-3.1" target="_blank">docs.microsoft.com</a>
.</p>
<h2 id="xaml-and-partial-classes">XAML and Partial Classes</h2>
<p>In addition to being used to define objects, XAML can also be used to define part of a class.  Consider this <code>MainWindow</code> XAML code, which is generated by the Visual Studio WPF Project Template:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Window</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;WpfApp1.MainWindow&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:WpfApp1&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Title=</span><span style="color:#e6db74">&#34;MainWindow&#34;</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;800&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Window&gt;</span></span></span></code></pre></div><p>And its corresponding C# file:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> WpfApp1
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Interaction logic for MainWindow.xaml</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MainWindow</span> : Window
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> MainWindow()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            InitializeComponent();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Notice the use of the <code>partial</code> modifier in the C# code?  This indicates that the <code>MainWindow</code> class is only <em>partially</em> defined in this file (<em>MainWindow.xaml.cs</em>) - the rest of the definition exists in another file.  That&rsquo;s the previously referenced XAML file (<em>MainWindow.xaml</em>).  Notice in the XAML that the <code>&lt;Window&gt;</code> element has the attribute <code>x:Class=&quot;WpfApp1.MainWindow&quot;</code>?  That indicates that it defines part of the class <code>MainWindow</code> defined in the <code>WpfApp1</code> namespace - it&rsquo;s the other part of our file!</p>
<p>When we compile this project, the XAML is actually transformed into a temporary C# file as part of the build process, and that C# file is joined with the other C# file.  This temporary file defines the <code>InitializeComponent()</code> method, which would look something like this:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> InitializeComponent() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.Title = <span style="color:#e6db74">&#34;MainWindow&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.Height = <span style="color:#ae81ff">450</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.Width = <span style="color:#ae81ff">800</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> grid = <span style="color:#66d9ef">new</span> Grid();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.Content = grid;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Notice how it sets the properties corresponding to the attributes defined on the <code>&lt;MainWindow&gt;</code> element?  Further, it assigns the child of that element (a <code>&lt;Grid&gt;</code> element) as the <code>Content</code> property of the <code>Window</code>.  Nested XAML elements are typically assigned to either <code>Content</code> or <code>Children</code> properties, depending on if the element in question is a container element or not (container elements can have multiple children, all other elements are limited to a single child).</p>
<p>Any structure defined in our XAML is set up during this <code>InitializeComponent()</code> call.  This means you should <strong>never remove the <code>InitializeComponent();</code> invocation</strong> from a WPF class, or your XAML-defined content will not be added.  Similarly, you should not manipulate that structure until the <code>InitializeComponent();</code> method has been invoked, or the structure will not exist!</p>
<p>This strategy of splitting GUI code into two files is known in Microsoft parlance as <em>codebehind</em>, and it allows the GUI&rsquo;s visual aspect to be created independently of the code that provides its logic.  This approach has been a staple of both Windows Forms and Windows Presentation Foundation.  This separation also allows for graphic designers to create the GUI look-and-feel without ever needing to write a line of code.  There is a companion application to Visual Studio called <a href="https://en.wikipedia.org/wiki/Microsoft_Blend" target="_blank">Blend</a>
 that can be used to write the XAML files for a project without needing the full weight and useability of Visual Studio.</p>

  
  
<div class="box notices cstyle tip">
  <div class="box-label"><i class="fa-fw fas fa-lightbulb"></i> Tip</div>
  <div class="box-content">

<p>Occasionally, Visual Studio will encounter a problem while building the temporary file from the XAML definition, and the resulting temporary file may become corrupted.  When this happens, your changes to the XAML are no longer incorporated into the program when you compile, because the process can&rsquo;t overwrite the corrupted temporary file.  Instead, the corrupted temporary file is used - resulting in weird and unexpected behavior.  If this happens to you, just run the <strong>&ldquo;Build &gt; Clean&rdquo;</strong> menu option on the project to delete all the temporary files.</p>
</div>
</div>

  
  
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>Partial classes weren&rsquo;t a WPF-specific innovation - Windows Forms used them first.  In Windows Forms, when you create a form, Visual Studio actually creates <em>two</em> C# files.  One of these is the one intended for you to edit, and the other is used by the drag-and-drop editor, which fills it with auto-generated C# code.  If you ever make the mistake of editing <em>this</em> file, it will cause all kinds of problems for the drag-and-drop editor (and you)!  In contrast, the drag-and-drop editor for WPF actually modifies the same XAML file you do - allowing you to use the editor, manually edit the XAML, or any combination of the two.</p>
</div>
</div>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="layouts">Layouts</h1>

<p>Windows Presentation Foundation provides a number of container elements that fulfill the specialized purpose of <em>layouts</em>.  Unlike most WPF controls, they can have multiple children, which they organize on-screen.  And unlike Windows Forms, these layouts adjust to the available space.</p>
<p>Let&rsquo;s examine each of five layouts in turn:</p>
<h2 id="the-grid">The Grid</h2>
<p>The default layout is the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.grid?view=netcore-3.1" target="_blank">Grid</a>
, which lays out its children elements in a grid pattern. A <code>&lt;Grid&gt;</code> is composed of columns and rows, the number and characteristics of which are defined by the grid&rsquo;s <code>ColumnDefinitions</code> and <code>RowDefinitions</code> properties.  These consist of a collection of <code>ColumnDefinition</code> and <code>&lt;RowDefinition/&gt;</code> elements.  Each <code>&lt;ColumnDefinition/&gt;</code> is typically given a <code>Width</code> property value, while each <code>&lt;RowDefinition/&gt;</code> is given a <code>Height</code> property value.</p>
<p>Thus, you might expect the code:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ColumnDefinition</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ColumnDefinition</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ColumnDefinition</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Grid.RowDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;RowDefinition</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;100&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;RowDefinition</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;100&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/Grid.RowDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;30&#34;</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;120&#34;</span> <span style="color:#a6e22e">Content=</span><span style="color:#e6db74">&#34;Click Me!&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Grid&gt;</span></span></span></code></pre></div><p>Creates a grid with three columns, each 200 logical units wide, and two rows, each 100 logical units high. However, it will <em>actually</em> create a grid like this:</p>
<p>
<a href="#image-fa9f1011150ae790d4ae5ba99ca42fa1" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.4.1.png" alt="The resulting Grid" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-fa9f1011150ae790d4ae5ba99ca42fa1">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.4.1.png" alt="The resulting Grid" class="lightbox-image" loading="lazy">
</a></p>
<p>Remember, all WPF containers will fill the available space - so the grid stretches the last column and row to fill the remaining space.  Also, any element declared as a child of the grid (in this case, our button), will be placed in the first grid cell - [0,0] (counted from the top-left corner).</p>
<p>When declaring measurements in WPF, integer values correspond to logical units, which are 1/96th of an inch.  We can also use relative values, by following a measurement with a <code>*</code>.  This indicates the ratio of remaining space a column or row should take up after the elements with an exact size are positioned. I.e. a column with a width of <code>2*</code> will be twice as wide as one with a width of <code>1*</code>.</p>
<p>Thus, to create a 3x3 grid centered in the available space to represent a game of Tic-Tac-Toe we might use:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ColumnDefinition</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;1*&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ColumnDefinition</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;100&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ColumnDefinition</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;100&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ColumnDefinition</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;100&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ColumnDefinition</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;1*&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid.RowDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;RowDefinition</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;1*&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;RowDefinition</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;100&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;RowDefinition</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;100&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;RowDefinition</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;100&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;RowDefinition</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;1*&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid.RowDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">FontSize=</span><span style="color:#e6db74">&#34;100&#34;</span> <span style="color:#a6e22e">VerticalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span> <span style="color:#a6e22e">HorizontalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span><span style="color:#f92672">&gt;</span>X<span style="color:#f92672">&lt;/TextBlock&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#a6e22e">FontSize=</span><span style="color:#e6db74">&#34;100&#34;</span> <span style="color:#a6e22e">VerticalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span> <span style="color:#a6e22e">HorizontalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span><span style="color:#f92672">&gt;</span>O<span style="color:#f92672">&lt;/TextBlock&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">FontSize=</span><span style="color:#e6db74">&#34;100&#34;</span> <span style="color:#a6e22e">VerticalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span> <span style="color:#a6e22e">HorizontalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span><span style="color:#f92672">&gt;</span>X<span style="color:#f92672">&lt;/TextBlock&gt;</span>        
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Grid&gt;</span></span></span></code></pre></div><p>Which would create:</p>
<p>
<a href="#image-1a96371a847143740c858aabe07480c1" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.4.2.png" alt="The resulting Tic-Tac-Toe grid" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-1a96371a847143740c858aabe07480c1">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.4.2.png" alt="The resulting Tic-Tac-Toe grid" class="lightbox-image" loading="lazy">
</a></p>
<p>Note too that we use the properties <code>Grid.Column</code> and <code>Grid.Row</code> in the <code>&lt;TextBlock&gt;</code> elements to assign them to cells in the grid.  The row and column indices start at 0 in the upper-left corner of the grid, and increase to the right and down.</p>
<h2 id="the-stackpanel">The StackPanel</h2>
<p>The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.stackpanel?view=netcore-3.1" target="_blank">StackPanel</a>
 arranges content into a single row or column (defaults to vertical).  For example, this XAML:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Banana<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Orange<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Mango<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Strawberry<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Blackberry<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Peach<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Watermelon<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/StackPanel&gt;</span></span></span></code></pre></div><p>Creates this layout:</p>
<p>
<a href="#image-b19ec82e9a2fe74f2a4d1ce88e935d8e" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.4.3.png" alt="The StackPanel Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-b19ec82e9a2fe74f2a4d1ce88e935d8e">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.4.3.png" alt="The StackPanel Example" class="lightbox-image" loading="lazy">
</a></p>
<p>The StackPanel can be set to a horizontal orientation by setting its <code>Orientation</code> property to <code>Horizontal</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;StackPanel</span> <span style="color:#a6e22e">Orientation=</span><span style="color:#e6db74">&#34;Horizontal&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Banana<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Orange<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Mango<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Strawberry<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Blackberry<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Peach<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Watermelon<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/StackPanel&gt;</span></span></span></code></pre></div><h2 id="the-wrappanel">The WrapPanel</h2>
<p>The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.wrappanel?view=netcore-3.1" target="_blank">WrapPanel</a>
 layout is like the <code>&lt;StackPanel&gt;</code>, with the additional caveat that if there is not enough space for its contents, it will wrap to an additional line. For example, this XAML code:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;WrapPanel&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Banana<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Orange<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Mango<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Strawberry<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Blackberry<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Peach<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Watermelon<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/WrapPanel&gt;</span></span></span></code></pre></div><p>Produces this layout when there is ample room:</p>
<p>
<a href="#image-2b76b94f1121fe6aa1fb2e42baa4ac8b" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.4.4.png" alt="The WrapPanel Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-2b76b94f1121fe6aa1fb2e42baa4ac8b">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.4.4.png" alt="The WrapPanel Example" class="lightbox-image" loading="lazy">
</a></p>
<p>And this one when things get tighter:</p>
<p>
<a href="#image-9ff44e086031b52dc6d1b251447105df" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.4.5.png" alt="The Squeezed WrapPanel Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-9ff44e086031b52dc6d1b251447105df">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.4.5.png" alt="The Squeezed WrapPanel Example" class="lightbox-image" loading="lazy">
</a></p>
<h2 id="the-dockpanel">The DockPanel</h2>
<p>The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.dockpanel?view=netcore-3.1" target="_blank">DockPanel</a>
 layout should be familiar to you - it&rsquo;s what Visual Studio uses.  Its content items can be &lsquo;docked&rsquo; to one of the sides, as defined by the <code>Dock</code> enum: <code>Bottom</code>, <code>Top</code>, <code>Left</code>, or <code>Right</code> by setting the <code>DockPanel.Dock</code> property on that item. The last item specified will also fill the central space.  If more than one child is specified for a particular side, it will be stacked with that side.</p>
<p>Thus, this XAML:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;DockPanel&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">DockPanel.Dock=</span><span style="color:#e6db74">&#34;Top&#34;</span><span style="color:#f92672">&gt;</span>Top<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">DockPanel.Dock=</span><span style="color:#e6db74">&#34;Left&#34;</span><span style="color:#f92672">&gt;</span>Left<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">DockPanel.Dock=</span><span style="color:#e6db74">&#34;Right&#34;</span><span style="color:#f92672">&gt;</span>Right<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">DockPanel.Dock=</span><span style="color:#e6db74">&#34;Bottom&#34;</span><span style="color:#f92672">&gt;</span>Bottom<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Center<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/DockPanel&gt;</span></span></span></code></pre></div><p>Generates this layout:</p>
<p>
<a href="#image-60b728b604b7f01d75cdbee616b65203" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.4.6.png" alt="The DockPanel Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-60b728b604b7f01d75cdbee616b65203">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.4.6.png" alt="The DockPanel Example" class="lightbox-image" loading="lazy">
</a></p>
<h2 id="the-canvas">The Canvas</h2>
<p>Finally, the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.canvas?view=netcore-3.1" target="_blank">Canvas</a>
 lays its content out strictly by their position within the <code>&lt;Canvas&gt;</code>, much like Windows Forms. This approach provides precise placement and size control, at the expense of the ability to automatically adjust to other screen resolutions.  For example, the code:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Canvas&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Canvas.Top=</span><span style="color:#e6db74">&#34;40&#34;</span> <span style="color:#a6e22e">Canvas.Right=</span><span style="color:#e6db74">&#34;40&#34;</span><span style="color:#f92672">&gt;</span>Do Something<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Canvas.Left=</span><span style="color:#e6db74">&#34;200&#34;</span> <span style="color:#a6e22e">Canvas.Bottom=</span><span style="color:#e6db74">&#34;80&#34;</span><span style="color:#f92672">&gt;</span>Other thing<span style="color:#f92672">&lt;/TextBlock&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Canvas</span> <span style="color:#a6e22e">Canvas.Top=</span><span style="color:#e6db74">&#34;30&#34;</span> <span style="color:#a6e22e">Canvas.Left=</span><span style="color:#e6db74">&#34;300&#34;</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;300&#34;</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;300&#34;</span> <span style="color:#a6e22e">Background=</span><span style="color:#e6db74">&#34;SaddleBrown&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Canvas&gt;</span></span></span></code></pre></div><p>Creates this layout:</p>
<p>
<a href="#image-f693aafe2d82e8b8e613489ba1173f44" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.4.7.png" alt="The Canvas Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-f693aafe2d82e8b8e613489ba1173f44">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.4.7.png" alt="The Canvas Example" class="lightbox-image" loading="lazy">
</a></p>
<p>If there is a chance the <code>&lt;Canvas&gt;</code> might be resized, it is a good idea to anchor all elements in the canvas relative to the same corner (i.e. top right) so that they all are moved the same amount.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="controls">Controls</h1>

<p>In addition to the layout controls, WPF provides a number of useful (and often familiar) controls that we can use to compose our applications.  Let&rsquo;s take a look at some of the most commonly used.</p>
<h3 id="border">Border</h3>
<p>A <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.border?view=netcore-3.1" target="_blank">Border</a>
 is a control that draws a border around its contents.  The properties specific to a border include <code>BorderBrush</code> (which sets the color of the border, see the discussion of brushes on the next page), <code>BorderThickness</code> the number of units thick the border should be drawn, <code>CornerRadius</code>, which adds rounded corners, and <code>Padding</code> which adds space between the border and its contents.</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Border</span> <span style="color:#a6e22e">BorderBrush=</span><span style="color:#e6db74">&#34;Green&#34;</span> <span style="color:#a6e22e">BorderThickness=</span><span style="color:#e6db74">&#34;5&#34;</span> <span style="color:#a6e22e">CornerRadius=</span><span style="color:#e6db74">&#34;5&#34;</span> <span style="color:#a6e22e">Padding=</span><span style="color:#e6db74">&#34;10&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>Do Something<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Border&gt;</span></span></span></code></pre></div><p>
<a href="#image-8bdd202bdd28a3e2357dc3df35ea3eb0" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.1.png" alt="A Border Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-8bdd202bdd28a3e2357dc3df35ea3eb0">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.1.png" alt="A Border Example" class="lightbox-image" loading="lazy">
</a></p>
<h3 id="button">Button</h3>
<p>A <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.button?view=netcore-3.1" target="_blank">Button</a>
 is a control that draws a button. This button can be interacted with by the mouse, and clicking on it triggers any <code>Click</code> event handlers that have been attached to it.  Unlike Windows Forms buttons, it can contain any other WPF control, including images and layouts.  Thus, a button featuring an image might be created with:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Click=</span><span style="color:#e6db74">&#34;TriggerBroadcast&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;StackPanel</span> <span style="color:#a6e22e">Orientation=</span><span style="color:#e6db74">&#34;Horizontal&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Image</span> <span style="color:#a6e22e">Source=</span><span style="color:#e6db74">&#34;dish.jpg&#34;</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;100&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">FontSize=</span><span style="color:#e6db74">&#34;25&#34;</span> <span style="color:#a6e22e">VerticalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span><span style="color:#f92672">&gt;</span>Broadcast<span style="color:#f92672">&lt;/TextBlock&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/StackPanel&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Button&gt;</span></span></span></code></pre></div><p>
<a href="#image-db88a0240d507ed22e89e10aa1942002" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.2.png" alt="A Button Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-db88a0240d507ed22e89e10aa1942002">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.2.png" alt="A Button Example" class="lightbox-image" loading="lazy">
</a></p>
<p>The event handler for the button needs to be declared in the corresponding <em>.xaml.cs</em> file, and will take two parameters, an <code>object</code> and <code>RoutedEventArgs</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// An event handler that triggers a broadcast</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;param name=&#34;sender&#34;&gt;The object sending this message&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;param name=&#34;args&#34;&gt;The event data&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> TriggerBroadcast(<span style="color:#66d9ef">object</span> sender, RoutedEventArgs args) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TODO: Send Broadcast</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>We&rsquo;ll be discussing events in more detail soon.</p>
<h3 id="checkbox">CheckBox</h3>
<p>A <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.checkbox?view=netcore-3.1" target="_blank">CheckBox</a>
 provides a checkable box corresponding to a boolean value.  The <code>IsChecked</code> property reflects the checked or unchecked state of the checkbox.  A checkbox also exposes <code>Checked</code> and <code>Unchecked</code> event handlers.</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;CheckBox</span> <span style="color:#a6e22e">IsChecked=</span><span style="color:#e6db74">&#34;True&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    The sky is blue
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/CheckBox&gt;</span>  </span></span></code></pre></div><p>
<a href="#image-ecfbf32c2a3391b6255679afeeaaf017" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.3.png" alt="A CheckBox Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-ecfbf32c2a3391b6255679afeeaaf017">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.3.png" alt="A CheckBox Example" class="lightbox-image" loading="lazy">
</a></p>
<h3 id="combobox">ComboBox</h3>
<p>A <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.combobox?view=netcore-3.1" target="_blank">ComboBox</a>
 provides a drop-down selection list.  The selected value can be accessed through the <code>SelectedItem</code> property, and the <code>IsEditable</code> boolean property determines if the combo box can be typed into, or simply selected from.  It exposes a <code>SelectionChanged</code> event.  The items in the <code>ComboBox</code> can be set declaratively:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;ComboBox&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ComboBoxItem&gt;</span>Apple<span style="color:#f92672">&lt;/ComboBoxItem&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ComboBoxItem&gt;</span>Orange<span style="color:#f92672">&lt;/ComboBoxItem&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ComboBoxItem&gt;</span>Peach<span style="color:#f92672">&lt;/ComboBoxItem&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ComboBoxItem&gt;</span>Pear<span style="color:#f92672">&lt;/ComboBoxItem&gt;</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/ComboBox&gt;</span></span></span></code></pre></div><p>
<a href="#image-1931d7bc4423c0266c6e249a4552b67e" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.6.png" alt="A ComboBox Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-1931d7bc4423c0266c6e249a4552b67e">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.6.png" alt="A ComboBox Example" class="lightbox-image" loading="lazy">
</a></p>
<p>Note that the ComboBox dropdown doesn&rsquo;t work in the editor - it only operates while the application is running.</p>
<p>Alternatively, you can expose the <code>ComboBox</code> in the codebehind <code>.xaml.cs</code> file by giving it a <code>Name</code> property.</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;ComboBox</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;FruitSelection&#34;</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;Fruits&#34;</span> <span style="color:#a6e22e">SelectedValue=</span><span style="color:#e6db74">&#34;Apple&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/ComboBox&gt;</span></span></span></code></pre></div><p>Then, after the combo box has been initialized, use the <code>ItemsSource</code> to specify a collection declared in the corresponding <code>.xaml.cs</code> file.</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// Interaction logic for UserControl1.xaml</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserControl1</span> : UserControl
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> UserControl1()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        InitializeComponent();
</span></span><span style="display:flex;"><span>        FruitSelection.ItemsSource = <span style="color:#66d9ef">new</span> List&lt;<span style="color:#66d9ef">string</span>&gt;
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Apple&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Orange&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Peach&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Pear&#34;</span>
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>We could also leverage <em>data binding</em> to bind the item collection dynamically.  We&rsquo;ll discuss this approach later.</p>
<h3 id="image">Image</h3>
<p>The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.image?view=netcore-3.1" target="_blank">Image</a>
 control displays an image.  The image to display is determined by the <code>Source</code> property. If the image is not exactly the same size as the <code>&lt;Image&gt;</code> control, the <code>Stretch</code> property determines how to handle this case.  Its possible values are:</p>
<ul>
<li><code>&quot;None&quot;</code> (the default) - the image is displayed at its original size</li>
<li><code>&quot;Fill&quot;</code> - the image is resized to the element&rsquo;s size.  This will result in stretching if the aspect ratios are not the same</li>
<li><code>&quot;Uniform&quot;</code> - the image is resized to fit into the element.  If the aspect ratios are different, there will be blank areas in the element (letterboxing)</li>
<li><code>&quot;UniformToFill&quot;</code> - the image is resized to fill the element.  If the aspect ratios are different, part of the image will be cropped out</li>
</ul>
<p>The stretch values effects are captured by this graphic:</p>
<p>
<a href="#image-b665934d410381f78b98dd2726cc9453" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.17.png" alt="The applied Stretch property" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-b665934d410381f78b98dd2726cc9453">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.17.png" alt="The applied Stretch property" class="lightbox-image" loading="lazy">
</a></p>
<p>The stretching behavior can be further customized by the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.stretchdirection?view=netcore-3.1" target="_blank">StretchDirection</a>
 property.</p>
<p>Images can also be used for <code>Background</code> or <code>Foreground</code> properties, as discussed on the next page.</p>
<h3 id="label">Label</h3>
<p>A <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.label?view=netcore-3.1" target="_blank">Label</a>
 displays text on a form, and can be as simple as:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Label&gt;</span>First Name:<span style="color:#f92672">&lt;/Label&gt;</span></span></span></code></pre></div><p>
<a href="#image-4b6fb019c4f67e61f5515b2649aa56e5" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.4.png" alt="A Label Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-4b6fb019c4f67e61f5515b2649aa56e5">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.4.png" alt="A Label Example" class="lightbox-image" loading="lazy">
</a></p>
<p>What distinguishes it from other text controls is that it can also be associated with a specific control specified by the <code>Target</code> parameter, whose value should be bound to the name of the control.  It can then provide an access key (aka a mnemonic) that will transfer focus to that control when the corresponding key is pressed.  The access key is indicated by preceding the corresponding character in the text with an underscore:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Label</span> <span style="color:#a6e22e">Target=</span><span style="color:#e6db74">&#34;{Binding ElementName=firstNameTextBox}&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;AccessText&gt;</span>_First Name:<span style="color:#f92672">&lt;/AccessText&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Label&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;firstNameTextBox&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/StackPanel&gt;</span></span></span></code></pre></div><p>
<a href="#image-f520ae583fa2e1a37909073411d1a50e" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.5.png" alt="A Label with Access Key Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-f520ae583fa2e1a37909073411d1a50e">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.5.png" alt="A Label with Access Key Example" class="lightbox-image" loading="lazy">
</a></p>
<p>Now when the program is running, the user can press <code>ALT + F</code> to shift focus to the textbox, so they can begin typing (Note the character &ldquo;F&rdquo; is underlined in the GUI).  Good use of access keys means users can navigate forms completely with the keyboard.</p>
<h3 id="listbox">ListBox</h3>
<p>A <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.listbox?view=netcore-3.1" target="_blank">ListBox</a>
 displays a list of items that can be selected.  The <code>SelectionMode</code> property can be set to either <code>&quot;Single&quot;</code> or <code>&quot;Multiple&quot;</code>, and the <code>&quot;SelectedItems&quot;</code> read-only property provides those selected items. The <code>ItemsSource</code> property can be set declaratively using <code>&lt;ListBoxItem&gt;</code> contents.  It also exposes a <code>SelectionChanged</code> event handler:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;ListBox&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ListBoxItem&gt;</span>Apple<span style="color:#f92672">&lt;/ListBoxItem&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ListBoxItem&gt;</span>Orange<span style="color:#f92672">&lt;/ListBoxItem&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ListBoxItem&gt;</span>Peach<span style="color:#f92672">&lt;/ListBoxItem&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ListBoxItem&gt;</span>Pear<span style="color:#f92672">&lt;/ListBoxItem&gt;</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/ListBox&gt;</span></span></span></code></pre></div><p>
<a href="#image-75a8174af2b4be1bb211883622f7733f" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.7.png" alt="A Label with Access Key Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-75a8174af2b4be1bb211883622f7733f">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.7.png" alt="A Label with Access Key Example" class="lightbox-image" loading="lazy">
</a></p>
<h3 id="radiobutton">RadioButton</h3>
<p>A group of <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.radiobutton?view=netcore-3.1" target="_blank">RadioButton</a>
 elements is used to present multiple options where only one can be selected.  To group radio buttons, specify a shared <code>GroupName</code> property.  Like other buttons, radio buttons have a <code>Click</code> event handler, and also a <code>Checked</code> and <code>Unchecked</code> event handler:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;RadioButton</span> <span style="color:#a6e22e">GroupName=</span><span style="color:#e6db74">&#34;Fruit&#34;</span><span style="color:#f92672">&gt;</span>Apple<span style="color:#f92672">&lt;/RadioButton&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;RadioButton</span> <span style="color:#a6e22e">GroupName=</span><span style="color:#e6db74">&#34;Fruit&#34;</span><span style="color:#f92672">&gt;</span>Orange<span style="color:#f92672">&lt;/RadioButton&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;RadioButton</span> <span style="color:#a6e22e">GroupName=</span><span style="color:#e6db74">&#34;Fruit&#34;</span><span style="color:#f92672">&gt;</span>Peach<span style="color:#f92672">&lt;/RadioButton&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;RadioButton</span> <span style="color:#a6e22e">GroupName=</span><span style="color:#e6db74">&#34;Fruit&#34;</span><span style="color:#f92672">&gt;</span>Pear<span style="color:#f92672">&lt;/RadioButton&gt;</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/StackPanel&gt;</span></span></span></code></pre></div><p>
<a href="#image-ba229e49e3f3c113030c09116bd7f5f8" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.8.png" alt="A Radio Button Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-ba229e49e3f3c113030c09116bd7f5f8">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.8.png" alt="A Radio Button Example" class="lightbox-image" loading="lazy">
</a></p>
<h3 id="textblock">TextBlock</h3>
<p>A <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.textblock?view=netcore-3.1" target="_blank">TextBlock</a>
 can be used to display arbitrary text.  It also makes available a <code>TextChanged</code> event that is triggered when its text changes.</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextBlock&gt;</span>Hi, I have something important to say.  I&#39;m a text block.<span style="color:#f92672">&lt;/TextBlock&gt;</span></span></span></code></pre></div><p>
<a href="#image-13fabe6a751d933dc8342f7e929e763b" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.9.png" alt="A TextBlock Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-13fabe6a751d933dc8342f7e929e763b">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.9.png" alt="A TextBlock Example" class="lightbox-image" loading="lazy">
</a></p>
<h3 id="textbox">TextBox</h3>
<p>And a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.textbox?view=netcore-3.1" target="_blank">TextBox</a>
 is an editable text box.  It&rsquo;s text can be accessed through the <code>Text</code> property:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;And I&#39;m a textbox!&#34;</span><span style="color:#f92672">/&gt;</span></span></span></code></pre></div><p>
<a href="#image-d55ed0506d5a5c44998920e2dfb2c12d" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.10.png" alt="A TextBlock Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-d55ed0506d5a5c44998920e2dfb2c12d">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.10.png" alt="A TextBlock Example" class="lightbox-image" loading="lazy">
</a></p>
<h3 id="togglebutton">ToggleButton</h3>
<p>Finally, a <a href="">ToggleButton</a>
 is a button that is either turned on or off.  This can be determined from its <code>IsChecked</code> property.  It also has event handlers for <code>Checked</code> and <code>Unchecked</code> events:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;ToggleButton&gt;</span>On or Off<span style="color:#f92672">&lt;/ToggleButton&gt;</span></span></span></code></pre></div><p>Off looks like:</p>
<p>
<a href="#image-54b64240d5f54d8a8d4c023e89484e14" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.11.png" alt="A ToggleButton Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-54b64240d5f54d8a8d4c023e89484e14">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.11.png" alt="A ToggleButton Example" class="lightbox-image" loading="lazy">
</a></p>
<p>And on looks like:</p>
<p>
<a href="#image-0101a5f5945e6f59875ec074bbefee68" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.12.png" alt="A ToggleButton Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-0101a5f5945e6f59875ec074bbefee68">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.5.12.png" alt="A ToggleButton Example" class="lightbox-image" loading="lazy">
</a></p>
<h3 id="other-controls">Other Controls</h3>
<p>This is just a sampling of some of the most used controls.  You can also reference the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls?view=netcore-3.1" target="_blank">System.Windows.Controls</a>
 namespace documentation, or the <a href="https://www.tutorialspoint.com/wpf/wpf_controls.htm" target="_blank">TutorialsPoint WPF Controls</a>
 reference.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="control-properties">Control Properties</h1>

<p>All WPF controls (including the layout controls we&rsquo;ve already seen) derive from common base classes, i.e. <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.uielement?view=windowsdesktop-6.0" target="_blank">UIElement</a>
 and <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.frameworkelement?view=windowsdesktop-6.0" target="_blank">FrameworkElement</a>
, which means they all inherit common properties.  Some of the most commonly used are described here.</p>
<h3 id="size--placement-modifying-properties">Size &amp; Placement Modifying Properties</h3>
<p>Perhaps the most important of the control properties are those that control sizing and placement.  Let&rsquo;s take a look at the most important of these.</p>
<h4 id="size">Size</h4>
<p>WPF controls use three properties to determine the height of the element.  These are <code>MinHeight</code>, <code>Height</code>, and <code>MaxHeight</code>.  They are doubles expressed in device-independent units (measuring 1/96 of an inch).  The rendering algorithm treats <code>Height</code> as a suggestion, but limits the calculated height to fall in the range between <code>MinHeight</code> and <code>MaxHeight</code>. The height determined by the algorithm can be accessed from the <code>ActualHeight</code> read-only property. Similar values exist for width: <code>MinWidth</code>, <code>Width</code>, <code>MaxWidth</code>, and <code>ActualWidth</code>.</p>
<table>
  <tr>
    <th>Property</th>
    <th>Default Value</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>MinHeight</td>
    <td>0.0</td>
    <td>The minimum element height</td>
  </tr>
  <tr>
    <td>Height</td>
    <td><code>NaN</code></td>
    <td>The suggested element height</th>
  </tr>
  <tr>
    <td>MaxHeight</td>
    <td><code>PositiveInfinity<code></td>
    <td>The maximum element height</td>
  </tr>
  <tr>
    <td>MinWidth</td>
    <td>0.0</td>
    <td>The minimum element width</td>
  </tr>
  <tr>
    <td>Width</td>
    <td><code>NaN</code></td>
    <td>The suggested element width</td>
  </tr>
  <tr>
    <td>MaxWidth</td>
    <td><code>PositiveInfinity</code></td>
    <td>The maximum element width</td>
  </tr>
</table>
<h4 id="margins">Margins</h4>
<p>In addition to the size of the element, we can set margins around the element, adding empty space between this and other elements.  The <code>Margin</code> property is actually of type <code>Thickness</code>, a structure with four properties: <em>left, top, right,</em> and <em>bottom</em>.  We can set the <code>Margin</code> property in several ways using XAML.</p>
<p>To set all margins to be the same size, we just supply a single value:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;3&#34;</span><span style="color:#f92672">&gt;</span>Do something<span style="color:#f92672">&lt;/Button&gt;</span></span></span></code></pre></div><p>To set different values for the horizontal and vertical margins, use two comma-separated values (horizontal comes first):</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;10, 20&#34;</span><span style="color:#f92672">&gt;</span>Do Something<span style="color:#f92672">&lt;/Button&gt;</span> </span></span></code></pre></div><p>And finally, they can <em>all</em> be set separately as a comma-separated list (the order is <em>left, top, right,</em> and then <em>bottom</em>).</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;10, 20, 30, 50&#34;</span><span style="color:#f92672">&gt;</span>Do Something<span style="color:#f92672">&lt;/Button&gt;</span></span></span></code></pre></div><h4 id="alignment">Alignment</h4>
<p>You can also align the elements within the space allocated for them using the <code>VerticalAlignment</code> and <code>HorizontalAlignment</code> properties.  Similarly, you can align the <em>contents</em> of an element with the <code>VerticalContentAlignment</code> and <code>HorizontalContentAlignment</code> properties.</p>
<p>For most controls, these are <code>&quot;Stretch&quot;</code> by default, which means the control or its contents will expand to fill the available space.  Additional values include <code>&quot;Bottom&quot;</code>, <code>&quot;Center&quot;</code>, and <code>&quot;Top&quot;</code> for vertical, and <code>&quot;Left&quot;</code>, <code>&quot;Center&quot;</code>, and <code>&quot;Right&quot;</code> for horizontal.  These options do <em>not</em> fill the available space - the control is sized in that dimension based on its suggested size.</p>
<table>
  <tr>
    <th colspan="2">HorizontalAlignment</th>
  </tr>
  <tr>
    <th>Option</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>Stretch</td>
    <td>Control fills the available horizontal space</td>
  </tr>
  <tr>
    <td>Left</td>
    <td>Control is aligned along the left of the available space</td>
  </tr>
  <tr>
    <td>Center</td>
    <td>Control is centered in the available horizontal space</td>
  </tr>
  <tr>
    <td>Right</td>
    <td>Control is aligned along the right of the available space</td>
  </tr>
  <tr>
    <th colspan="2">VerticalAlignment</th>
  </tr>
  <tr>
    <th>Option</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>Stretch</td>
    <td>Control fills the available vertical space</td>
  </tr>
  <tr>
    <td>Top</td>
    <td>Control is aligned along the top side of the available space</td>
  </tr>
  <tr>
    <td>Center</td>
    <td>Control is centered in the available vertical space</td>
  </tr>
  <tr>
    <td>Bottom</td>
    <td>Control is aligned along the bottom side of the available space</td>
  </tr>
</table>
<h3 id="text-and-font-properties">Text and Font Properties</h3>
<p>As most controls prominently feature text, it is important to discuss the properties that effect how this text is presented.</p>
<h4 id="font-family">Font Family</h4>
<p>The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.textblock.fontfamily?view=windowsdesktop-6.0" target="_blank">FontFamily</a>
 property sets the font used by the control.  This font needs to be installed on the machine.  You can supply a single font, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">FontFamily=</span><span style="color:#e6db74">&#34;Arial&#34;</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div><p>Or a list of font families to supply fallback options if the requested font is not available:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">FontFamily=</span><span style="color:#e6db74">&#34;Arial, Century Gothic&#34;</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div><h4 id="font-size">Font Size</h4>
<p>The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.textblock.fontsize?view=windowsdesktop-6.0" target="_blank">FontSize</a>
 property determines the size of the font used in the control.</p>
<h4 id="font-style">Font Style</h4>
<p>The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.textblock.fontstyle?view=windowsdesktop-6.0" target="_blank">FontStyle</a>
 property sets the style of the font used. This can include <code>&quot;Normal&quot;</code>, <code>&quot;Italic&quot;</code>, or <code>&quot;Oblique&quot;</code>.  Italic is typically defined in the font itself (and created by the font creator), while Oblique is created from the normal font by applying a mathematical rendering transformation, and can be used for fonts that do not have a defined italic style.</p>
<p>
<a href="#image-666f44dedf58e6ea736ed4623771be28" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.16.png" alt="Font Styles" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-666f44dedf58e6ea736ed4623771be28">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.16.png" alt="Font Styles" class="lightbox-image" loading="lazy">
</a></p>
<h4 id="font-weight">Font Weight</h4>
<p>The <code>FontWeight</code> refers to how thick a stroke is used to draw the font.  It can be set to values like <code>&quot;Light&quot;</code>, <code>&quot;Normal&quot;</code>, <code>&quot;Bold&quot;</code>, or <code>&quot;Ultra Bold&quot;</code>.  A list of all available options can be found <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.fontweights?view=windowsdesktop-6.0#remarks" target="_blank">here</a>
.</p>
<h4 id="text-alignment">Text Alignment</h4>
<p>The <code>TextAlignment</code> property defines how the text is aligned within its element.  Possible values are <code>&quot;Left&quot;</code> (the default), <code>&quot;Center&quot;</code>, <code>&quot;Justify&quot;</code>, and <code>&quot;Right&quot;</code>, and behave just like these options in your favorite text editor.</p>
<p>There is no corresponding vertical alignment option - instead use <code>VerticalContentAlignment</code> discussed above.</p>
<h3 id="appearance--interactability-modifying-properties">Appearance &amp; Interactability Modifying Properties</h3>
<p>There are often times in working with a GUI where you might want to disable or even hide a control.  WPF controls provide several properties that affect the rendering and interaction of controls.</p>
<h4 id="isenabled">IsEnabled</h4>
<p>The <code>IsEnabled</code> property is a boolean that indicates if this control is currently enabled. It defaults to <code>true</code>.  Exactly what &rsquo;enabled&rsquo; means for a control is specific to that kind of control, but usually means the control cannot be interacted with.  For example, a button with <code>IsEnabled=false</code> cannot be clicked on, and will be rendered grayed out, i.e.:</p>
<p>
<a href="#image-3c3b4745019dc67cfd5d94b99dd434d8" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.1.png" alt="Enabled vs. Disabled Buttons" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-3c3b4745019dc67cfd5d94b99dd434d8">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.1.png" alt="Enabled vs. Disabled Buttons" class="lightbox-image" loading="lazy">
</a></p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">IsEnabled=</span><span style="color:#e6db74">&#34;False&#34;</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;10&#34;</span><span style="color:#f92672">&gt;</span>I&#39;m Disabled<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;10&#34;</span><span style="color:#f92672">&gt;</span>I&#39;m Enabled<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Grid&gt;</span></span></span></code></pre></div><h4 id="opacity">Opacity</h4>
<p>A similar effect can be obtained by changing an element&rsquo;s <code>Opacity</code> property, a double that ranges from 0.0 (completely transparent) to 1.0 (completely solid).  Below you can see two <code>&lt;TextBlock&gt;</code> elements, with the one on the left set to an opacity of 0.40:</p>
<p>
<a href="#image-f0ed87efb588ffa1b9b343f5c6225087" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.2.png" alt="Opacity Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-f0ed87efb588ffa1b9b343f5c6225087">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.2.png" alt="Opacity Example" class="lightbox-image" loading="lazy">
</a></p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Opacity=</span><span style="color:#e6db74">&#34;0.4&#34;</span> <span style="color:#a6e22e">Foreground=</span><span style="color:#e6db74">&#34;Purple&#34;</span> <span style="color:#a6e22e">VerticalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span> <span style="color:#a6e22e">HorizontalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      I&#39;m semi-translucent!
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/TextBlock&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">Foreground=</span><span style="color:#e6db74">&#34;Purple&#34;</span> <span style="color:#a6e22e">VerticalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span> <span style="color:#a6e22e">HorizontalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      I&#39;m solid!
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/TextBlock&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Grid&gt;</span></span></span></code></pre></div><p>Alerting an elements&rsquo; opacity does not have any effect on its functionality, i.e. a completely transparent button can still be clicked.</p>
<h4 id="visibility">Visibility</h4>
<p>Finally, the Visible property alters how the element is considered in the WPF rendering algorithm.  It has three possible values: <code>&quot;Visible&quot;</code>, <code>&quot;Hidden&quot;</code>, and <code>&quot;Collapsed&quot;</code>. The default value is <code>&quot;Visible&quot;</code>, and the element renders normally, as &ldquo;Button One&rdquo; does in the example below:</p>
<p>
<a href="#image-19b74e7aa4a9321d55ebacf97ce65d37" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.3.png" alt="Visible Visibility Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-19b74e7aa4a9321d55ebacf97ce65d37">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.3.png" alt="Visible Visibility Example" class="lightbox-image" loading="lazy">
</a></p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Visibility=</span><span style="color:#e6db74">&#34;Visible&#34;</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;10&#34;</span><span style="color:#f92672">&gt;</span>Button One<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;10&#34;</span><span style="color:#f92672">&gt;</span>Button Two<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/StackPanel&gt;</span></span></span></code></pre></div><p>The <code>&quot;Hidden&quot;</code> value will hide the element, but preserve its place in the layout.  A hidden element cannot be interacted with, so this is similar to setting the <code>Opacity</code> to 0 and <code>IsEnabled</code> to false:</p>
<p>
<a href="#image-37a14046d4292bded631deba12619626" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.4.png" alt="Hidden Visibility Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-37a14046d4292bded631deba12619626">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.4.png" alt="Hidden Visibility Example" class="lightbox-image" loading="lazy">
</a></p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Visibility=</span><span style="color:#e6db74">&#34;Hidden&#34;</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;10&#34;</span><span style="color:#f92672">&gt;</span>Button One<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;10&#34;</span><span style="color:#f92672">&gt;</span>Button Two<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/StackPanel&gt;</span></span></span></code></pre></div><p>Finally, the <code>&quot;Collapsed&quot;</code> value will leave the element out of the layout calculations, as though it were not a part of the control at all.  A hidden element cannot be interacted with. Note that in the example below, &ldquo;Button Two&rdquo; has been rendered in the space previously occupied by &ldquo;Button One&rdquo;:</p>
<p>
<a href="#image-3e8ab728e0eaa721cd3668bf5f141b2e" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.5.png" alt="Collapsed Visibility Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-3e8ab728e0eaa721cd3668bf5f141b2e">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.5.png" alt="Collapsed Visibility Example" class="lightbox-image" loading="lazy">
</a></p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Visibility=</span><span style="color:#e6db74">&#34;Collapsed&#34;</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;10&#34;</span><span style="color:#f92672">&gt;</span>Button One<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;10&#34;</span><span style="color:#f92672">&gt;</span>Button Two<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/StackPanel&gt;</span></span></span></code></pre></div><h3 id="backgrounds-and-foregrounds">Backgrounds and Foregrounds</h3>
<p>You may have noticed the previous examples that colors can be accomplished through the <code>Background</code> and <code>Foreground</code> properties - where the <code>Background</code> determines the color of the element, and <code>Foreground</code> determines the color of text and other foreground elements.  While this is true, it is also just the beginning of what is possible.  Both of these properties have the type <code>Brush</code>, which deserves a deeper look.</p>
<p>Simply put, a brush determines how to paint graphical objects.  This can be as simple as painting a solid color, or as complex as painting an image.  The effect used is determined by the type of brush - the <code>Brush</code> class itself serving as a base class for several specific types brush.</p>
<h4 id="solid-color-brushes">Solid Color Brushes</h4>
<p>What we&rsquo;ve been using up to this point have been <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.solidcolorbrush?view=windowsdesktop-6.0" target="_blank">SolidColorBrush</a>
 objects.  This is the simplest of the brush classes, and simply paints with a solid color, i.e.:</p>
<p>
<a href="#image-d55b42656a637bf03f05f59db7503eec" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.6.png" alt="Solid Color Brush Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-d55b42656a637bf03f05f59db7503eec">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.6.png" alt="Solid Color Brush Example" class="lightbox-image" loading="lazy">
</a></p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Foreground=</span><span style="color:#e6db74">&#34;BlueViolet&#34;</span> <span style="color:#a6e22e">Background=</span><span style="color:#e6db74">&#34;DarkSeaGreen&#34;</span> <span style="color:#a6e22e">FontSize=</span><span style="color:#e6db74">&#34;25&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  Look, Ma!  I&#39;m in color!
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/TextBlock&gt;</span></span></span></code></pre></div><p>The simplest way to set the color in XAML is to use a value from the predefined <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.brushes?view=windowsdesktop-6.0#remarks" target="_blank">brush name list</a>
, like the <code>&quot;BlueViolet&quot;</code> and <code>&quot;DarkSeaGreen&quot;</code> in the example.</p>
<p>Alternatively, you can use a hexadecimal number defining the red, green, and blue channels in that order, i.e. to use K-State purple and white we&rsquo;d use:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Foreground=</span><span style="color:#e6db74">&#34;#FFFFFF&#34;</span> <span style="color:#a6e22e">Background=</span><span style="color:#e6db74">&#34;#512888&#34;</span> <span style="color:#a6e22e">FontSize=</span><span style="color:#e6db74">&#34;25&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  Look, Ma!  I&#39;m in color!
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/TextBlock&gt;</span></span></span></code></pre></div><p>The various formats the hex values can be given are detailed <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.solidcolorbrush?view=windowsdesktop-6.0#xaml-attribute-usage" target="_blank">here</a>
</p>
<h4 id="gradient-brushes">Gradient Brushes</h4>
<p>Gradient brushes gradually transition between colors.  There are two kinds of gradient brushes in WPF: with a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.lineargradientbrush?view=windowsdesktop-6.0" target="_blank">LinearGradientBrush</a>
 the brush gradually changes along a line.  With a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.radialgradientbrush?view=windowsdesktop-6.0" target="_blank">RadialGradientBrush</a>
, the color changes radially from a center point.</p>
<p>In both cases, the gradient is defined in terms of <code>&lt;GradientStops&gt;</code> - a distance along the line (or from the center) where the expected color value is defined.  In the spaces between gradient stops, the color value is interpolated between the two stops on either side of the point.  The gradient stop needs both an <code>Offset</code> value (a double indicating the percentage of how far along the line or from the center this stop falls, between 0.0 and 1.0) and a <code>Color</code> value (which can be defined as with solid color brushes).</p>
<p>For example, the XAML:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Foreground=</span><span style="color:#e6db74">&#34;#FFFFFF&#34;</span> <span style="color:#a6e22e">FontSize=</span><span style="color:#e6db74">&#34;25&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;TextBlock.Background&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;LinearGradientBrush&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;LinearGradientBrush.GradientStops&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Red&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Yellow&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.25&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Green&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.50&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Blue&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.75&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Violet&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;1.0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;/LinearGradientBrush.GradientStops&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/LinearGradientBrush&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/TextBlock.Background&gt;</span>
</span></span><span style="display:flex;"><span>  Look, Ma!  I&#39;m in color!
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/TextBlock&gt;</span></span></span></code></pre></div><p>Produces this rainbow gradient:</p>
<p>
<a href="#image-d67cb2c572c65bf2ae43c017903488df" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.8.png" alt="Rainbow Linear Gradient Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-d67cb2c572c65bf2ae43c017903488df">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.8.png" alt="Rainbow Linear Gradient Example" class="lightbox-image" loading="lazy">
</a></p>
<p>Further, the line along which the linear gradient is created is defined by the <code>StartPoint</code> and <code>EndPoint</code> properties of the <code>&lt;LinearGradientBrush&gt;</code>.  These points are relative to the area the brush is covering (i.e. the space occupied by the element), and fall in the range of [0.0 .. 1.0].  The default (as seen above) is a diagonal line from the upper left corner (0,0) to the lower right corner (1.0, 1.0).</p>
<p>To make the above gradient fall in the center half of the element, and be horizontal, we could tweak the gradient definition:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Foreground=</span><span style="color:#e6db74">&#34;#FFFFFF&#34;</span> <span style="color:#a6e22e">FontSize=</span><span style="color:#e6db74">&#34;25&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;TextBlock.Background&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;LinearGradientBrush</span> <span style="color:#a6e22e">StartPoint=</span><span style="color:#e6db74">&#34;0.25, 0.5&#34;</span> <span style="color:#a6e22e">EndPoint=</span><span style="color:#e6db74">&#34;0.75, 0.5&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;LinearGradientBrush.GradientStops&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Red&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Yellow&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.25&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Green&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.50&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Blue&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.75&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Violet&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;1.0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/LinearGradientBrush.GradientStops&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/LinearGradientBrush&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/TextBlock.Background&gt;</span>
</span></span><span style="display:flex;"><span>    Look, Ma!  I&#39;m in color!
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/TextBlock&gt;</span></span></span></code></pre></div><p>
<a href="#image-a59fb6a394060b9555134a2710c148e4" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.9.png" alt="Rainbow Linear Gradient with Start and End Points Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-a59fb6a394060b9555134a2710c148e4">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.9.png" alt="Rainbow Linear Gradient with Start and End Points Example" class="lightbox-image" loading="lazy">
</a></p>
<p>A <code>&lt;RadialGradientBrush&gt;</code> is defined similarly through the use of <code>GradientStops</code>, only this time they are in relation to the center around which the gradient radiates:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Foreground=</span><span style="color:#e6db74">&#34;#FFFFFF&#34;</span> <span style="color:#a6e22e">FontSize=</span><span style="color:#e6db74">&#34;25&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;TextBlock.Background&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;RadialGradientBrush&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;RadialGradientBrush.GradientStops&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Red&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Yellow&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.25&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Green&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.50&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Blue&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.75&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Violet&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;1.0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/RadialGradientBrush.GradientStops&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/RadialGradientBrush&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/TextBlock.Background&gt;</span>
</span></span><span style="display:flex;"><span>    Look, Ma!  I&#39;m in color!
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/TextBlock&gt;</span></span></span></code></pre></div><p>
<a href="#image-d4c430e284343538a5e29588e24c6735" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.10.png" alt="Rainbow Radial Gradient Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-d4c430e284343538a5e29588e24c6735">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.10.png" alt="Rainbow Radial Gradient Example" class="lightbox-image" loading="lazy">
</a></p>
<p>The gradient fills an ellipse defined by the <code>Center</code> property and the <code>RadiusX</code> and <code>RadiusY</code> properties.  By default these values are (0.5. 0.5), 0.5, and 0.5 respectively.  Like other gradient properties, they are doubles between 0.0 and 1.0.  Finally, the gradient emanates from the <code>GradientOrigin</code>, also a point with values defined by this coordinate system.</p>
<p>To center the above gradient in the left half of the block, we would therefore use:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextBlock.Background&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;RadialGradientBrush</span> <span style="color:#a6e22e">Center=</span><span style="color:#e6db74">&#34;0.25, 0.5&#34;</span> <span style="color:#a6e22e">RadiusX=</span><span style="color:#e6db74">&#34;0.25&#34;</span> <span style="color:#a6e22e">RadiusY=</span><span style="color:#e6db74">&#34;0.5&#34;</span> <span style="color:#a6e22e">GradientOrigin=</span><span style="color:#e6db74">&#34;0.25, 0.5&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;RadialGradientBrush.GradientStops&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Red&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Yellow&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.25&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Green&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.50&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Blue&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.75&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Violet&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;1.0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/RadialGradientBrush.GradientStops&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/RadialGradientBrush&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/TextBlock.Background&gt;</span></span></span></code></pre></div><p>
<a href="#image-4c419c0730ef348a28d5418e9f7ab880" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.11.png" alt="Rainbow Positioned Radial Gradient Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-4c419c0730ef348a28d5418e9f7ab880">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.11.png" alt="Rainbow Positioned Radial Gradient Example" class="lightbox-image" loading="lazy">
</a></p>
<p>And of course, we can use a gradient for a <code>Foreground</code> property as well:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Background=</span><span style="color:#e6db74">&#34;White&#34;</span> <span style="color:#a6e22e">FontSize=</span><span style="color:#e6db74">&#34;40&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;TextBlock.Foreground&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;LinearGradientBrush&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;LinearGradientBrush.GradientStops&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Red&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Yellow&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.25&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Green&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.50&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Blue&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.75&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Violet&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;1.0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/LinearGradientBrush.GradientStops&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/LinearGradientBrush&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/TextBlock.Foreground&gt;</span>
</span></span><span style="display:flex;"><span>    Look, Ma!  I&#39;m in color!
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/TextBlock&gt;</span></span></span></code></pre></div><p>
<a href="#image-e2346cc2899c8ce72e52b3185205fd66" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.12.png" alt="Gradient Foreground Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-e2346cc2899c8ce72e52b3185205fd66">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.12.png" alt="Gradient Foreground Example" class="lightbox-image" loading="lazy">
</a></p>
<h4 id="image-brushes">Image Brushes</h4>
<p>To draw a saved image, we use an <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.imagebrush?view=windowsdesktop-6.0" target="_blank">ImageBrush</a>
, setting its <code>ImageSource</code> property to the image we want to use.  In XAML, that can be as simple as:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;40&#34;</span> <span style="color:#a6e22e">Foreground=</span><span style="color:#e6db74">&#34;White&#34;</span> <span style="color:#a6e22e">FontSize=</span><span style="color:#e6db74">&#34;30&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button.Background&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ImageBrush</span> <span style="color:#a6e22e">ImageSource=</span><span style="color:#e6db74">&#34;Dish.jpg&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Button.Background&gt;</span>
</span></span><span style="display:flex;"><span>    Broadcast
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Button&gt;</span></span></span></code></pre></div><p>
<a href="#image-de411dae7737d81bdf902c050ca48e50" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.13.png" alt="Image Brush Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-de411dae7737d81bdf902c050ca48e50">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.13.png" alt="Image Brush Example" class="lightbox-image" loading="lazy">
</a></p>
<p>We can apply image brushes to any WPF control, allowing for some interesting layering effects, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid.Background&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ImageBrush</span> <span style="color:#a6e22e">ImageSource=</span><span style="color:#e6db74">&#34;watering-can.jpg&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid.Background&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid.RowDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;RowDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;RowDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;RowDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid.RowDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;40&#34;</span> <span style="color:#a6e22e">Foreground=</span><span style="color:#e6db74">&#34;White&#34;</span> <span style="color:#a6e22e">FontSize=</span><span style="color:#e6db74">&#34;30&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button.Background&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ImageBrush</span> <span style="color:#a6e22e">ImageSource=</span><span style="color:#e6db74">&#34;Dish.jpg&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Button.Background&gt;</span>
</span></span><span style="display:flex;"><span>        Broadcast
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Grid&gt;</span></span></span></code></pre></div><p>
<a href="#image-c20826a31d6b8f221bcdd7267275b65b" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.14.png" alt="Image Brush Layering Example" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-c20826a31d6b8f221bcdd7267275b65b">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.14.png" alt="Image Brush Layering Example" class="lightbox-image" loading="lazy">
</a></p>
<p>You probably notice that the dish image on the button is distorted.  We can correct this by changing the <a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/graphics-multimedia/tilebrush-overview?view=netframeworkdesktop-4.8#the-base-tile" target="_blank">Stretch</a>
 property.  The possible values are: <code>&quot;None&quot;</code>, <code>&quot;Fill&quot;</code>, <code>&quot;Uniform&quot;</code>, and <code>&quot;UniformToFill&quot;</code>.  This graphic from the documentation visual shows these properties:</p>
<p>
<a href="#image-3b2065b3e2a28070a9c187a388175ea7" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.17.png" alt="The applied Stretch property" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-3b2065b3e2a28070a9c187a388175ea7">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.17.png" alt="The applied Stretch property" class="lightbox-image" loading="lazy">
</a></p>
<p>The <code>ImageBrush</code> extends the <code>TileBrush</code>, so the image can actually be <em>tiled</em> if the tile size is set to be smaller than the element that it is painting. The <a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/graphics-multimedia/tilebrush-overview" target="_blank">TileBrush Overview</a>
 provides a detailed breakdown of applying tiling.</p>

  
  
<div class="box notices cstyle warning">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div>
  <div class="box-content">

<p>When using images with Visual Studio, it is important to understand how those are used and distributed.  You should make sure the images are physically located within the project folder (so that they are included in your source control).  Additionally, you want to mark the property &ldquo;Copy to Output Directory&rdquo; to either &ldquo;Copy Always&rdquo; or &ldquo;Copy if Newer.&rdquo;  When distributing your project, these files will also need to be distributed, or the image will be unavailable to your executable.

<a href="#image-b1490ac647e956aae113204b3b6f9153" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.15.png" alt="Copy to Output Directory" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-b1490ac647e956aae113204b3b6f9153">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.6.15.png" alt="Copy to Output Directory" class="lightbox-image" loading="lazy">
</a></p>
</div>
</div>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="editing-wpf-controls">Editing WPF Controls</h1>

<p>To create a new WPF control from within Visual Studio, we usually choose <strong>&ldquo;Add &gt; User Control (WPF&hellip;)&rdquo;</strong> from the solution context menu.</p>
<p>
<a href="#image-4d1a025cec205f7dddddb904055dfe73" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.7.1.png" alt="Adding a UserControl in Visual Studio" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-4d1a025cec205f7dddddb904055dfe73">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.7.1.png" alt="Adding a UserControl in Visual Studio" class="lightbox-image" loading="lazy">
</a></p>
<p>This creates two files, the <em>[filename].xaml</em>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;WpfApp1.UserControl1&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:WpfApp1&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;100&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;400&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div><p>and the codebehind for that XAML file, <em>[filename].xaml.cs</em> (where [filename] is the name you supplied):</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Collections.Generic;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Collections.ObjectModel;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Text;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows.Controls;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows.Data;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows.Documents;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows.Input;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows.Media;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows.Media.Imaging;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows.Navigation;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows.Shapes;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> WpfApp1
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Interaction logic for UserControl1.xaml</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserControl1</span> : UserControl
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> UserControl1()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            InitializeComponent();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>As was mentioned previously, the <code>InitializeComponent()</code> call in the constructor is what builds the structure specified in the XAML file to the object, so it should not be removed, nor should any manipulation of that structure be done before this method invocation.</p>

  
  
<div class="box notices cstyle tip">
  <div class="box-label"><i class="fa-fw fas fa-lightbulb"></i> Tip</div>
  <div class="box-content">

<p>Most custom controls are subclasses of the <code>UserControl</code> class, and choosing this option has Visual Studio create the boilerplate for us.  However, if you need to extend a <em>specific</em> control, i.e. a <code>ListView</code>, it is often easiest to start with a <code>UserControl</code> made this way, and then change the base class to <code>ListView</code> in the <em>[filename].xaml.cs</em> file, as well as changing the <code>&lt;UserControl&gt;</code> element to a <code>&lt;ListView&gt;</code> element in the <em>[filename].xaml</em>.</p>
</div>
</div>
<h3 id="namespaces-and-assemblies">Namespaces and Assemblies</h3>
<p>Also, notice how the attributes of the control in the XAML file contain a <em>local</em> namespace:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span> xmlns:local=&#34;clr-namespace:WpfApp1&#34;</span></span></code></pre></div><p>This is the equivalent of a <code>using</code> statement for XAML; it creates the <code>local</code> namespace and ties it to the project&rsquo;s primary namespace. We can then create an element corresponding to any class in that namespace.  Let&rsquo;s say we have another custom control, <code>ThingAMaJig</code> that we want to utilize in this control.  We can use the element notation to add it to our grid:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;local:ThingAMaJig&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span></span></span></code></pre></div><p>Note that we must preface the class name in the element with the <code>local</code> namespace, with a colon (<code>:</code>) separating the two.</p>
<p>We can also add additional namespace statements.  For example:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>xmlns:system=&#34;clr-namespace:System;assembly=mscorlib&#34;</span></span></code></pre></div><p>This brings in the <code>System</code> namespace, so now we can use the classes and types defined there, i.e <code>String</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;system:String&gt;</span>Hello World!<span style="color:#f92672">&lt;/system:String&gt;</span></span></span></code></pre></div><p>Note that for the namespace attribute, we also included the assembly information.  This is necessary for any assemblies that are not defined by this project (i.e. exist in their own DLL files).</p>
<h3 id="the-wpf-editor">The WPF Editor</h3>
<p>In Visual Studio, opening a WPF XAML file will open a special editor that provides a side-by-side visual and XAML code editors for the control:</p>
<p>
<a href="#image-8b23155af39e6c91c1e59870c295ec82" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.7.2.png" alt="The Visual Studio WPF XAML Editor" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-8b23155af39e6c91c1e59870c295ec82">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.7.2.png" alt="The Visual Studio WPF XAML Editor" class="lightbox-image" loading="lazy">
</a></p>
<p>As you edit the XAML, it also updates the visualization in the visual editor.  Also, many element properties can be edited from the visual editor or the properties pane - and these changes are automatically applied to the XAML. And, just like with Windows Forms, you can drag controls from the toolbox into the visualization to add them to the layout.</p>
<p>However, you will likely find yourselves often directly editing the XAML. This is often the fastest and most foolproof way of editing WPF controls.  Remember that in WPF controls resize to fit the available space, and are not positioned by coordinates.  For this reason, the visual editor will actually apply <em>margins</em> instead of positioning elements, which can cause unexpected results if your application is viewed at a different resolution (including some controls being inaccessible as they are covered by other controls).</p>
<p>A couple of buttons in the editor deserve some closer attention:</p>
<p>
<a href="#image-b0f340a163c81881b0092ebc1312cf64" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.7.3.png" alt="Visual Studio WPF XAML Editor Button Detail 1" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-b0f340a163c81881b0092ebc1312cf64">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.7.3.png" alt="Visual Studio WPF XAML Editor Button Detail 1" class="lightbox-image" loading="lazy">
</a></p>
<ol>
<li>The zoom factor in the design editor</li>
<li>Refreshes the design editor - sometimes it hangs on re-rendering, and you need to click this.</li>
<li>Toggles rendering effects (These use the graphics hardware, and can be computationally involved. Turning them off can improve performance on weaker machines)</li>
<li>Toggles the snap grid (provides grid lines for easier layout)</li>
<li>Toggles snap-to-grid</li>
<li>Toggles the artboard background (which provides a checkered background to make it easier to judge what is transparent)</li>
<li>Toggles snapping to snap lines (those lines that appear between controls to help you align them)</li>
<li>Toggles showing platform-only vs. all controls (for when targeting multiple platforms)</li>
</ol>
<p>
<a href="#image-ae0c8802d0270106f06dfab68476f98a" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.7.4.png" alt="Visual Studio WPF XAML Editor Button Detail 2" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-ae0c8802d0270106f06dfab68476f98a">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.7.4.png" alt="Visual Studio WPF XAML Editor Button Detail 2" class="lightbox-image" loading="lazy">
</a></p>
<ol start="9">
<li>Switches to a vertical split between the design editor and XAML editor</li>
<li>Switches to a horizontal split between the design editor and XAML editor</li>
<li>Switches to showing only the design editor or XAML editor</li>
</ol>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="component-based-design">Component-Based Design</h1>

<p>WPF and XAML lend themselves to a design approach known as Component-Based Design or Component-Based Development, which rather than focusing on developing the entire GUI in one go, focuses on decomposing user experiences (UX) into individual, focused, and potentially reusable components.  These can, in turn, be used to build larger components, and eventually, the entire GUI (see <a href="https://opensenselabs.com/blog/articles/uxprinciples-cbs" target="_blank">&ldquo;UX Principles for Designing Component Based Systems&rdquo;</a>
 for more details).</p>
<p>Let&rsquo;s dig deeper by focusing on a specific example.  Let&rsquo;s say we want to build an application for keeping track of multiple shopping lists.  So our core component is a displayed list, plus a mechanism for adding to it. Let&rsquo;s create a <code>UserComponent</code> to represent this.</p>
<p>For laying out the component, let&rsquo;s say at the very top, we place the text &ldquo;Shopping List For&rdquo;, and directly below that we have an editable text box where the user can enter a store name.  On the bottom, we&rsquo;ll have a text box to enter a new item, and a button to add that item to the list.  And in the space between, we&rsquo;ll show the list in its current form.  This sounds like an ideal fit for the <code>DockPanel</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;ShopEasy.ShoppingList&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:ShopEasy&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;DockPanel&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">DockPanel.Dock=</span><span style="color:#e6db74">&#34;Top&#34;</span> <span style="color:#a6e22e">FontWeight=</span><span style="color:#e6db74">&#34;Bold&#34;</span> <span style="color:#a6e22e">TextAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            Shopping List For:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/TextBlock&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">DockPanel.Dock=</span><span style="color:#e6db74">&#34;Top&#34;</span> <span style="color:#a6e22e">FontWeight=</span><span style="color:#e6db74">&#34;Bold&#34;</span> <span style="color:#a6e22e">TextAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">DockPanel.Dock=</span><span style="color:#e6db74">&#34;Bottom&#34;</span> <span style="color:#a6e22e">Click=</span><span style="color:#e6db74">&#34;AddItemToList&#34;</span><span style="color:#f92672">&gt;</span>Add Item To List<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;itemTextBox&#34;</span> <span style="color:#a6e22e">DockPanel.Dock=</span><span style="color:#e6db74">&#34;Bottom&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ListView</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;itemsListView&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/DockPanel&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div><p>Now in our codebehind, we&rsquo;ll need to define the <code>AddItemToList</code> event handler:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows.Controls;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> ShopEasy
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Interaction logic for ShoppingList.xaml</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ShoppingList</span> : UserControl
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// Constructs a new ShoppingList</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> ShoppingList()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            InitializeComponent();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// Adds the item in the itemTextBox to the itemsListView</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;param name=&#34;sender&#34;&gt;The object sending the event&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;param name=&#34;e&#34;&gt;The events describing the event&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">void</span> AddItemToList(<span style="color:#66d9ef">object</span> sender, RoutedEventArgs e)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Make sure there&#39;s an item to add</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (itemTextBox.Text.Length == <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Add the item to the list</span>
</span></span><span style="display:flex;"><span>            itemsListView.Items.Add(itemTextBox.Text);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Clear the text box</span>
</span></span><span style="display:flex;"><span>            itemTextBox.Clear();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>This particular component is pretty much self-contained.  We can use it in other components that need a shopping list.  In our case, we&rsquo;ll add it to a collection of shopping lists we can flip through with a couple of buttons, as well as create new lists in.  Let&rsquo;s call this control <code>ListSwitcher</code>.</p>
<p>This time, let&rsquo;s use a <code>Grid</code> layout and divide the available space into three columns and two rows.  The columns we&rsquo;ll leave with the default width (<code>&quot;1*&quot;</code>), but the bottom row we&rsquo;ll set as 100 units high, leaving the top row to expand to fill the remaining space.  Along the bottom we&rsquo;ll create three buttons to navigate between shopping lists.  On the top, we&rsquo;ll use the <code>Grid.ColumnSpan</code> property on a <code>Border</code> to span the three columns, creating a container where we&rsquo;ll display the current <code>ShoppingList</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;ShopEasy.ListSwitcher&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:ShopEasy&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Grid.RowDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;RowDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;RowDefinition</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;100&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Grid.RowDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Border</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;listContainer&#34;</span> <span style="color:#a6e22e">Grid.ColumnSpan=</span><span style="color:#e6db74">&#34;3&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Border&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">Click=</span><span style="color:#e6db74">&#34;OnPriorList&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            &amp;lt; Prior List
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">Click=</span><span style="color:#e6db74">&#34;OnNewList&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            New List
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#a6e22e">Click=</span><span style="color:#e6db74">&#34;OnNextList&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            Next List &amp;gt;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div><p>Now we&rsquo;ll implement the three button <code>Click</code> event handlers in the codebehind, as well as creating a <code>List&lt;ShoppingList&gt;</code> to store all of our lists:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Collections.Generic;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows.Controls;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> ShopEasy
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Interaction logic for ListSwitcher.xaml</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ListSwitcher</span> : UserControl
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// The list of shopping lists managed by this control</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>        List&lt;ShoppingList&gt; lists = <span style="color:#66d9ef">new</span> List&lt;ShoppingList&gt;();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// The index of the currently displayed shopping list</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> currentListIndex = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// Constructs a new ListSwitcher</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> ListSwitcher()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            InitializeComponent();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// Creates a new ShoppingList and displays it</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;param name=&#34;sender&#34;&gt;What triggered this event&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;param name=&#34;e&#34;&gt;The parameters of this event&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">void</span> OnNewList(<span style="color:#66d9ef">object</span> sender, RoutedEventArgs e)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Create a new shopping list</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> list = <span style="color:#66d9ef">new</span> ShoppingList();
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// The current count of lists will be the index of the next list added</span>
</span></span><span style="display:flex;"><span>            currentListIndex = lists.Count;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Add the list to the list of shopping lists</span>
</span></span><span style="display:flex;"><span>            lists.Add(list);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Display the list on the control</span>
</span></span><span style="display:flex;"><span>            listContainer.Child = list;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// Displays the prior shopping list</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;param name=&#34;sender&#34;&gt;What triggered this event&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;param name=&#34;e&#34;&gt;The parameters of this event&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">void</span> OnPriorList(<span style="color:#66d9ef">object</span> sender, RoutedEventArgs e)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// don&#39;t try to access an empty list </span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (lists.Count == <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// decrement the currentListIndex</span>
</span></span><span style="display:flex;"><span>            currentListIndex--;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// make sure we don&#39;t go below the first index in the list (0)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (currentListIndex &lt; <span style="color:#ae81ff">0</span>) currentListIndex = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// display the indexed list </span>
</span></span><span style="display:flex;"><span>            listContainer.Child = lists[currentListIndex];
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// Displays the next shopping list</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;param name=&#34;sender&#34;&gt;What triggered this event&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;param name=&#34;e&#34;&gt;The parameters of this event&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">void</span> OnNextList(<span style="color:#66d9ef">object</span> sender, RoutedEventArgs e)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// don&#39;t try to access an empty list </span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (lists.Count == <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// increment the currentListIndex</span>
</span></span><span style="display:flex;"><span>            currentListIndex++;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// make sure we don&#39;t go above the last index in the list (Count - 1)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (currentListIndex &gt; lists.Count - <span style="color:#ae81ff">1</span>) currentListIndex = lists.Count - <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// display the indexed list </span>
</span></span><span style="display:flex;"><span>            listContainer.Child = lists[currentListIndex];
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>And finally, we&rsquo;ll modify our <code>MainWindow</code> XAML to display a <code>ListSwitcher</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Window</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;ShopEasy.MainWindow&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:ShopEasy&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Title=</span><span style="color:#e6db74">&#34;MainWindow&#34;</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;local:ListSwitcher/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Window&gt;</span></span></span></code></pre></div><p>The resulting app allows us to create multiple shopping lists, and swap between them using the buttons:</p>
<p>
<a href="#image-b802a04ee0767488c75251713194e2c2" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.8.1.png" alt="ShopEasy App" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-b802a04ee0767488c75251713194e2c2">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.1.8.1.png" alt="ShopEasy App" class="lightbox-image" loading="lazy">
</a></p>
<p>Much like we can use objects to break program functionality into smaller, more focused units, we can use component-based design to break GUIs into smaller, more focused units.  Both reflect one of the principles of good programming practice - the Single Responsibility Principle.  This principle suggests each unit of code should focus on a single responsibility, and more complex behaviors be achieved by using multiple units together.  As we see here, this principle extends across multiple programming paradigms.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="summary">Summary</h1>

<p>In this chapter, we introduced a new desktop application programming framework - Windows Presentation Foundation (WPF).  We explored how WPF uses XAML to define partial classes, allowing for a graphical design editor with regular C# codebehind.  We explored XAML syntax and many of the controls found in WPF.  We also compared WPF with Windows Forms, which you have previously explored in prior classes.  Finally, we discussed an approach to developing GUIs, <em>Component-Based Design</em>, which applies the Single Responsibility Principle to controls, and builds more complex controls through <em>composition</em> of these simpler controls.</p>

            <footer class="footline">

            </footer>
          </article>

          </section>
    
    
          <article class="chapter">
            <header class="headline">
            </header>


<div class="article-subheading">Chapter 2</div>
<h1 id="exploring-elements">Exploring Elements</h1>

<p>Our application is a tree?</p>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Exploring Elements</h1>
    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="introduction">Introduction</h1>

<p>In the previous chapter, we introduced Windows Presentation Foundation and XAML, and discussed common layouts and controls, as well as some of the most common features of each of them.  We also saw the concept of component-based design and explored its use.  In this chapter, we&rsquo;ll take a deeper dive into how WPF and XAML structure GUIs into an <em>elements tree</em>, and some different ways we can leverage these features for greater control and customization in our programs.</p>
<h2 id="key-terms">Key Terms</h2>
<ul>
<li>The Elements Tree</li>
<li>Styles</li>
<li>Resources</li>
</ul>
<h2 id="c-keywords-and-elements">C# Keywords and Elements</h2>
<ul>
<li><code>&lt;Style&gt;</code></li>
<li><code>&lt;Setter&gt;</code></li>
<li><code>StaticResource</code></li>
</ul>
<h2 id="key-skills">Key Skills</h2>
<p>In this chapter, you should learn how to navigate the elements tree, declare styles to simplify styling your applications, and declare resources that can be bound to properties of controls.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="the-elements-tree">The Elements Tree</h1>

<p>Consider the <code>ShoppingList</code> class we developed in the last chapter:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;ShopEasy.ShoppingList&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:ShopEasy&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;DockPanel&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">DockPanel.Dock=</span><span style="color:#e6db74">&#34;Top&#34;</span> <span style="color:#a6e22e">FontWeight=</span><span style="color:#e6db74">&#34;Bold&#34;</span> <span style="color:#a6e22e">TextAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            Shopping List For:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/TextBlock&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">DockPanel.Dock=</span><span style="color:#e6db74">&#34;Top&#34;</span> <span style="color:#a6e22e">FontWeight=</span><span style="color:#e6db74">&#34;Bold&#34;</span> <span style="color:#a6e22e">TextAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">DockPanel.Dock=</span><span style="color:#e6db74">&#34;Bottom&#34;</span> <span style="color:#a6e22e">Click=</span><span style="color:#e6db74">&#34;AddItemToList&#34;</span><span style="color:#f92672">&gt;</span>Add Item To List<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;itemTextBox&#34;</span> <span style="color:#a6e22e">DockPanel.Dock=</span><span style="color:#e6db74">&#34;Bottom&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ListView</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;itemsListView&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/DockPanel&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div><p>Each element in this XAML corresponds to an object of a specific Type, and the nesting of the elements implies a tree-like structure we call the <a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/trees-in-wpf?view=netframeworkdesktop-4.8" target="_blank"><em>element tree</em></a>
.  We can draw this out as an actual tree:</p>
<p>
<a href="#image-188dfe9257ead4522cfff6b4bea93467" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.2.2.1.png" alt="The elements tree for the ShoppingList component" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-188dfe9257ead4522cfff6b4bea93467">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.2.2.1.png" alt="The elements tree for the ShoppingList component" class="lightbox-image" loading="lazy">
</a></p>
<p>The relationships in the tree are also embodied in the code.  Each element has either a <code>Child</code> or <code>Children</code> property depending on if it can have just one or multiple children, and these are populated by the elements defined in the XAML.  Thus, because the <code>&lt;DockPanel&gt;</code> has nested within it, a <code>&lt;TextBlock&gt;</code>, <code>&lt;TextBox&gt;</code>, <code>&lt;Button&gt;</code>, <code>&lt;TextBox&gt;</code>, and <code>&lt;ListView&gt;</code>, these are all contained in its <code>Children</code> Property.  In turn, the <code>&lt;Button&gt;</code> element has text as a child, which is implemented as another <code>&lt;TextBlock&gt;</code>.  Also, each component has a <code>Parent</code> property, which references the control that is its immediate parent.</p>
<p>In other words, all the WPF controls are effectively <em>nodes</em> in a <em>tree data structure</em>.  We can modify this data structure by adding or removing nodes.  This is exactly what happens in the <code>ListSwitcher</code> control - when you click the &ldquo;New List&rdquo; button, or the &ldquo;Prior&rdquo; or &ldquo;Next&rdquo; button, you are swapping the subtree that is the child of its <code>&lt;Border&gt;</code> element:</p>
<p>
<a href="#image-280943147e0af6bad34c3d33b9176352" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.2.2.2.png" alt="The elements tree for the ListSwitcher component" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-280943147e0af6bad34c3d33b9176352">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.2.2.2.png" alt="The elements tree for the ListSwitcher component" class="lightbox-image" loading="lazy">
</a></p>
<p>In fact, the entire application is one large tree of elements, with the <code>&lt;Application&gt;</code> as its root:</p>
<p>
<a href="#image-848b116639a9d7a895e9c5603916c2a2" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.2.2.3.png" alt="ShopEasy App element tree" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-848b116639a9d7a895e9c5603916c2a2">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.2.2.3.png" alt="ShopEasy App element tree" class="lightbox-image" loading="lazy">
</a></p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="navigating-the-tree">Navigating the Tree</h1>

<p>When you first learned about trees, you also learned about tree traversal algorithms.  This is one reason that WPF is organized into a tree - the rendering process actually uses a tree traversal algorithm to determine how large to make each control!</p>
<p>You can also traverse the tree yourself, by exploring <code>Child</code>, <code>Children</code>, or <code>Parent</code> properties.  For example, if we needed to gain access to the <code>ListSwitcher</code> from the <code>ShoppingList</code> in the previous example, you could reach it by invoking:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>   ListSwitcher switcher = <span style="color:#66d9ef">this</span>.Parent.Parent.Parent <span style="color:#66d9ef">as</span> ListSwitcher;</span></span></code></pre></div><p>In this example, <code>this</code> is our <code>ShoppingList</code>, the first <code>Parent</code> is the <code>Border</code> containing the <code>ShoppingList</code>, the second <code>Parent</code> is the <code>Grid</code> containing that <code>Border</code>, and the third <code>Parent</code> is the actual <code>ListSwitcher</code>.  We have to cast it to be a <code>ListSwitcher</code> because the type of the <code>Parent</code> property is a <code>DependencyObject</code> (a common base class of all controls).</p>
<p>Of course, this is a rather brittle way of finding an ancestor, because if we add any nodes to the element tree (perhaps move the <code>Grid</code> within a <code>DockPanel</code>), we&rsquo;ll need to rewrite it.  It would be better to use a loop to iteratively climb the tree until we find the control we&rsquo;re looking for.  This is greatly aided by the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.logicaltreehelper?view=netcore-3.1" target="_blank"><code>LogicalTreeHelper</code></a>
 library, which provides standardized static methods for accessing parents and children in the elements tree:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">// Start climbing the tree from this node</span>
</span></span><span style="display:flex;"><span>DependencyObject parent = <span style="color:#66d9ef">this</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Get this node&#39;s parent</span>
</span></span><span style="display:flex;"><span>    parent = LogicalTreeHelper.GetParent(parent);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Invariant: there is a parent element, and it is not a ListSwitcher </span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span>(!(parent <span style="color:#66d9ef">is</span> <span style="color:#66d9ef">null</span> || parent <span style="color:#66d9ef">is</span> ListSwitcher));
</span></span><span style="display:flex;"><span><span style="color:#75715e">// If we get to this point, parent is either null, or the ListSwitcher we&#39;re looking for</span></span></span></code></pre></div><p>Searching the ancestors is a relatively easy task, as each node in the tree has only one parent.  Searching the descendants takes more work, as each node may have many children, with children of their own.</p>
<p>This approach works well for complex applications with complex GUIs, where it is infeasible to keep references around.  However, for our simple application here, it might make more sense to refactor the <code>ShoppingList</code> class to keep track of the <code>ListSwitcher</code> that created it, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows.Controls;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> ShopEasy
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Interaction logic for ShoppingList.xaml</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ShoppingList</span> : UserControl
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// The ListSwitcher that created this list</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> ListSwitcher listSwitcher;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// Constructs a new ShoppingList</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> ShoppingList(ListSwitcher listSwitcher)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            InitializeComponent();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.listSwitcher = listSwitcher;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// Adds the item in the itemTextBox to the itemsListView</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;param name=&#34;sender&#34;&gt;The object sending the event&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;param name=&#34;e&#34;&gt;The events describing the event&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">void</span> AddItemToList(<span style="color:#66d9ef">object</span> sender, RoutedEventArgs e)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Make sure there&#39;s an item to add</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (itemTextBox.Text.Length == <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Add the item to the list</span>
</span></span><span style="display:flex;"><span>            itemsListView.Items.Add(itemTextBox.Text);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Clear the text box</span>
</span></span><span style="display:flex;"><span>            itemTextBox.Clear();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>However, this approach now tightly couples the <code>ListSwitcher</code> and <code>ShoppingList</code> - we can no longer use the <code>ShoppingList</code> for other contexts without a <code>ListSwitcher</code>.</p>
<p>If we instead employed the the traversal algorithm detailed above:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows.Controls;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> ShopEasy
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Interaction logic for ShoppingList.xaml</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ShoppingList</span> : UserControl
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// The ListSwitcher that created this list</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> ListSwitcher listSwitcher { 
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">get</span> {
</span></span><span style="display:flex;"><span>                DependencyObject parent = <span style="color:#66d9ef">this</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// Get this node&#39;s parent</span>
</span></span><span style="display:flex;"><span>                    parent = LogicalTreeHelper.GetParent(parent);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// Invariant: there is a parent element, and it is not a ListSwitcher </span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">while</span>(!(parent <span style="color:#66d9ef">is</span> <span style="color:#66d9ef">null</span> || parent <span style="color:#66d9ef">is</span> ListSwitcher));
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> parent;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// Constructs a new ShoppingList</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> ShoppingList()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            InitializeComponent();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// Adds the item in the itemTextBox to the itemsListView</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;param name=&#34;sender&#34;&gt;The object sending the event&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;param name=&#34;e&#34;&gt;The events describing the event&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">void</span> AddItemToList(<span style="color:#66d9ef">object</span> sender, RoutedEventArgs e)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Make sure there&#39;s an item to add</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (itemTextBox.Text.Length == <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Add the item to the list</span>
</span></span><span style="display:flex;"><span>            itemsListView.Items.Add(itemTextBox.Text);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Clear the text box</span>
</span></span><span style="display:flex;"><span>            itemTextBox.Clear();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>We could invoke the <code>listSwitcher</code> property to get the ancestor <code>ListSwitcher</code>.  If this control is being used without one, the value will be <code>Null</code>.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="styling-the-tree">Styling the Tree</h1>

<p>Windows Presentation Foundation takes advantage of the elements tree in other ways.  One of the big ones is for styling related elements.  Let&rsquo;s say we are creating a calculator GUI:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;Calculator.Calculator&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:Calculator&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;450&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Grid.RowDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;RowDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;RowDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;RowDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;RowDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;RowDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Grid.RowDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">&gt;</span>7<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">&gt;</span>8<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">&gt;</span>9<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;2&#34;</span><span style="color:#f92672">&gt;</span>4<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;2&#34;</span><span style="color:#f92672">&gt;</span>5<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;2&#34;</span><span style="color:#f92672">&gt;</span>6<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;3&#34;</span><span style="color:#f92672">&gt;</span>1<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;3&#34;</span><span style="color:#f92672">&gt;</span>2<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;3&#34;</span><span style="color:#f92672">&gt;</span>3<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;4&#34;</span> <span style="color:#a6e22e">Grid.ColumnSpan=</span><span style="color:#e6db74">&#34;3&#34;</span><span style="color:#f92672">&gt;</span>0<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">&gt;</span>+<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;2&#34;</span><span style="color:#f92672">&gt;</span>-<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;3&#34;</span><span style="color:#f92672">&gt;</span>*<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;4&#34;</span><span style="color:#f92672">&gt;</span>/<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Window&gt;</span></span></span></code></pre></div><p>Once we have the elements laid out, we realize the text of the buttons is too small.  Fixing this would mean setting the <code>FontSize</code> property of each <code>&lt;Button&gt;</code>.  That&rsquo;s a lot of repetitive coding.</p>
<p>Thankfully, the XAML developers anticipated this kind of situation, and allow us to attach a <code>&lt;Style&gt;</code> resource to the control. We typically would do this above the controls we want to style - in this case, either on the <code>&lt;Grid&gt;</code> or the <code>&lt;UserControl&gt;</code>.  If we were to attach it to the <code>&lt;Grid&gt;</code>, we&rsquo;d declare a <code>&lt;Grid.Resources&gt;</code> property, and inside it, a <code>&lt;Style&gt;</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Grid.Resources&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Style&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Style&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Grid.Resources&gt;</span></span></span></code></pre></div><p>The <code>&lt;Style&gt;</code> element allows us to specify a <code>TargetType</code> property, which is the Type we want the style to apply to - in this case <code>&quot;Button&quot;</code>.  Inside the <code>&lt;Style&gt;</code> element, we declare <code>&lt;Setter&gt;</code> elements, which need <code>Property</code> and <code>Value</code> attributes.  As you might guess from the names, the <code>&lt;Setter&gt;</code> will set the specified property to the specified value on each element of the target type.</p>
<p>Therefore, if we use:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Grid.Resources&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Style</span> <span style="color:#a6e22e">TargetType=</span><span style="color:#e6db74">&#34;Button&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;FontSize&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;40&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Style&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Grid.Resources&gt;</span></span></span></code></pre></div><p>The result will be that all buttons that are children of the <code>&lt;Grid&gt;</code> will have their <code>FontSize</code> set to <code>40</code> device-independent pixels.  We don&rsquo;t need to add a separate <code>FontSize=&quot;40&quot;</code> to each one!  However, if we add <code>FontSize=&quot;50&quot;</code> to a single button, that button alone will have a slightly larger font.</p>
<p>We can declare as many <code>&lt;Setters&gt;</code> as we want in a <code>&lt;Style&gt;</code> element, and as many <code>&lt;Style&gt;</code> elements as we want in a <code>&lt;.Resources&gt;</code> element.  Moreover, styles apply to all children in the elements tree.  Closer setters override those farther up the tree, and setting the property directly on an element always gives the final say.</p>
<p>Thus, we might put application-wide styles directly in our <code>MainWindow</code> using <code>&lt;Window.Resources&gt;</code>, and override those further down the elements tree when we want a different behavior.</p>

  
  
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>You may notice some similarities between <code>&lt;Style&gt;</code> elements and the <em>cascading style sheets (css)</em> of web technologies. This is not surprising, as the styling approach used in WPF was inspired by CSS, much as XAML drew inspiration from HTML.  However, the implementation details are necessarily different, as XAML is effectively declaring C# objects.  Hence, the use of &lsquo;setters&rsquo; to set &lsquo;properties&rsquo; to a specific &lsquo;value&rsquo;.</p>
</div>
</div>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="resources">Resources</h1>

<p>The <code>&lt;Style&gt;</code> element represents just one kind of resource.  We can provide other kinds of resources, like raw data.  Say we want to provide a string to display in our program, but want that string declared somewhere easy to find and change (perhaps our customers change their mind frequently).  We could declare the string in the <code>Application</code> resources:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Application</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;WpfTutorialSamples.App&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:sys=</span><span style="color:#e6db74">&#34;clr-namespace:System;assembly=mscorlib&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">StartupUri=</span><span style="color:#e6db74">&#34;WPF application/ExtendedResourceSample.xaml&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Application.Resources&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;sys:String</span> <span style="color:#a6e22e">x:Key=</span><span style="color:#e6db74">&#34;StringToDisplay&#34;</span><span style="color:#f92672">&gt;</span>Hello World!<span style="color:#f92672">&lt;/sys:String&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Application.Resources&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Application&gt;</span></span></span></code></pre></div><p>Then, in our actual control we can use that string as a <em>static resource</em>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{StaticResource StringToDisplay}&#34;</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div><p>As long as that element is a descendant of the element the resource is declared on, it will be used in the property.  In this case, we&rsquo;ll display the string &ldquo;Hello World!&rdquo; in the <code>TextBlock</code>.  Note that we have to use the <code>x:Key</code> property to identify the resource, and repeat the key in the <code>&quot;{StaticResource StringToDisplay}&quot;</code>.  The curly braces and the <code>StaticResource</code> both need to be there (technically, they are setting up a <em>data binding</em>, which we&rsquo;ll talk about in a future chapter).</p>
<p>We can declare any kind of type as a resource and make it available in our XAML this way.</p>
<p>For example, we could create a <code>LinearGradientBrush</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Application</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;WpfTutorialSamples.App&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:sys=</span><span style="color:#e6db74">&#34;clr-namespace:System;assembly=mscorlib&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">StartupUri=</span><span style="color:#e6db74">&#34;WPF application/ExtendedResourceSample.xaml&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Application.Resources&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;LinearGradientBrush</span> <span style="color:#a6e22e">x:Key=</span><span style="color:#e6db74">&#34;Rainbow&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;LinearGradientBrush.GradientStops&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Red&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Yellow&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.25&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Green&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.50&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Blue&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.75&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;Violet&#34;</span> <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;1.0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/LinearGradientBrush.GradientStops&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/LinearGradientBrush&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Application.Resources&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Application&gt;</span></span></span></code></pre></div><p>And then use it as a <code>Background</code> or <code>Foreground</code> property in our controls:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Grid</span> <span style="color:#a6e22e">Background=</span><span style="color:#e6db74">&#34;{StaticResource Rainbow}&#34;</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div><p>Since it is only defined in one place, it is now easier to reuse, and if we ever need to change it, we only need to change it in one location.</p>
<p>Finally, we can create static resources from images and other media.  First, we have to set its build action to &ldquo;Resource&rdquo; in the <strong>&ldquo;Properties&rdquo;</strong> window after adding it to our project:</p>
<p>
<a href="#image-515362a7869222943d89a3dad7ad76b7" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.2.5.1.png" alt="Setting the image properties" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-515362a7869222943d89a3dad7ad76b7">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.2.5.1.png" alt="Setting the image properties" class="lightbox-image" loading="lazy">
</a></p>
<p>Then we can declare a <code>&lt;BitmapImage&gt;</code> resource using a <code>UriSource</code> property that matches the path to the image within our project:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Application</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;WpfTutorialSamples.App&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:sys=</span><span style="color:#e6db74">&#34;clr-namespace:System;assembly=mscorlib&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">StartupUri=</span><span style="color:#e6db74">&#34;WPF application/ExtendedResourceSample.xaml&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Application.Resources&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;BitmapImage</span> <span style="color:#a6e22e">x:Key=</span><span style="color:#e6db74">&#34;MountainImage&#34;</span> <span style="color:#a6e22e">UriSource=</span><span style="color:#e6db74">&#34;Images/mountains.jpg&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Applicaton.Resources&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Application&gt;</span></span></span></code></pre></div><p>And then we can use this as the <code>ImageSource</code> for an <code>ImageBrush</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid.Background&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ImageBrush</span> <span style="color:#a6e22e">ImageSource=</span><span style="color:#e6db74">&#34;{StaticResource MountainImage}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid.Background&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Grid&gt;</span></span></span></code></pre></div><p>The benefit of using images and other media as resources is that they are <em>compiled into the binary assembly</em> (the <em>.dll</em> or <em>.exe</em> file).  This means they don&rsquo;t need to be copied separately when we distribute our application.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="templates">Templates</h1>

<p>Most WPF controls are themselves composed of multiple, simpler, controls. For example, a <code>&lt;Button&gt;</code> is composed of a <code>&lt;Border&gt;</code> and whatever content you place inside the button.  A simplified version of this structure appears below (I removed the styling information and the <code>VisualState</code> components responsible for presenting the button differently when it is enabled, disabled, hovered on, or clicked):</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Border</span> <span style="color:#a6e22e">TextBlock.Foreground=</span><span style="color:#e6db74">&#34;{TemplateBinding Foreground}&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">x:Name=</span><span style="color:#e6db74">&#34;Border&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">CornerRadius=</span><span style="color:#e6db74">&#34;2&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">BorderThickness=</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Border.BorderBrush&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;LinearGradientBrush</span> <span style="color:#a6e22e">StartPoint=</span><span style="color:#e6db74">&#34;0,0&#34;</span>
</span></span><span style="display:flex;"><span>                          <span style="color:#a6e22e">EndPoint=</span><span style="color:#e6db74">&#34;0,1&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;LinearGradientBrush.GradientStops&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GradientStopCollection&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;{DynamicResource BorderLightColor}&#34;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0.0&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;{DynamicResource BorderDarkColor}&#34;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;1.0&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/GradientStopCollection&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/LinearGradientBrush.GradientStops&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/LinearGradientBrush&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/Border.BorderBrush&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Border.Background&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;LinearGradientBrush</span> <span style="color:#a6e22e">EndPoint=</span><span style="color:#e6db74">&#34;0.5,1&#34;</span>
</span></span><span style="display:flex;"><span>                          <span style="color:#a6e22e">StartPoint=</span><span style="color:#e6db74">&#34;0.5,0&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;{DynamicResource ControlLightColor}&#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;GradientStop</span> <span style="color:#a6e22e">Color=</span><span style="color:#e6db74">&#34;{DynamicResource ControlMediumColor}&#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">Offset=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/LinearGradientBrush&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/Border.Background&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;ContentPresenter</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;2&#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">HorizontalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">VerticalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">RecognizesAccessKey=</span><span style="color:#e6db74">&#34;True&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Border&gt;</span></span></span></code></pre></div><p>This has some implications for working with the control - for example, if you wanted to add rounded corners to the <code>&lt;Button&gt;</code>, they would actually need to be added to the <code>&lt;Border&gt;</code> <em>inside</em> the button.  This can be done by nesting styles, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid.Resources&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Style</span> <span style="color:#a6e22e">TargetType=</span><span style="color:#e6db74">&#34;Button&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;Style.Resources&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;Style</span> <span style="color:#a6e22e">TargetType=</span><span style="color:#e6db74">&#34;Border&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;CornerRadius&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;25&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/Style&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/Style.Resources&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Style&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid.Resources&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button&gt;</span>I have rounded corners now!<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Grid&gt;</span></span></span></code></pre></div><p>Note how the <code>&lt;Style&gt;</code> targeting the <code>&lt;Border&gt;</code> is <em>nested inside the <code>Resources</code></em> of the <code>&lt;Style&gt;</code> targeting the <code>&lt;Button&gt;</code>?  This means that the style rules for the <code>&lt;Border&gt;</code> will only be applied to <code>&lt;Border&gt;</code> elements that are part of a <code>&lt;Button&gt;</code>.</p>
<h3 id="templates">Templates</h3>
<p>Above I listed a simplified version of the XAML used to create a button.  The full listing can be found <a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/controls/button-styles-and-templates?view=netframeworkdesktop-4.8#button-controltemplate-example" target="_blank">in the Microsoft Documentation</a></p>
<p>What&rsquo;s more, you can <em>replace</em> this standard rendering in your controls by replacing the <code>Template</code> property.  For example, we could replace our button with a super-simple rounded <code>&lt;Border&gt;</code> that nested a <code>&lt;TextBlock&gt;</code> that does word-wrapping of the button content:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Button.Template&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ControlTemplate&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;Border</span> <span style="color:#a6e22e">CornerRadius=</span><span style="color:#e6db74">&#34;25&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">TextWrapping=</span><span style="color:#e6db74">&#34;Wrap&#34;</span><span style="color:#f92672">&gt;</span>  
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;ContentPresenter</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;2&#34;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#a6e22e">HorizontalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#a6e22e">VerticalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#a6e22e">RecognizesAccessKey=</span><span style="color:#e6db74">&#34;True&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/TextBlock&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/Border&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/ControlTemplate&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Button.ControlTemplate&gt;</span>
</span></span><span style="display:flex;"><span>    This is a simple button!
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Button&gt;</span></span></span></code></pre></div><p>The <code>&lt;ContentPresenter&gt;</code> is what presents the <em>content</em> nested inside the button - in this case, the text <code>This is a simple button!</code>.  Of course, this super-simple button will not change its appearance when you hover over it or click it, or when it is disabled.  But it helps convey the idea of a <code>&lt;ControlTemplate&gt;</code>.  As with any other property, you can also set the <code>Template</code> property of a control using a <code>&lt;Setter&gt;</code> within a <code>&lt;Style&gt;</code> targeting that element.</p>
<p>If you only need a simple tweak - like applying word-wrapping to the text of a button, it often makes more sense to supply as content a control that will do so, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>&lt;Button&gt;
</span></span><span style="display:flex;"><span>    &lt;TextBlock TextWrapping=<span style="color:#e6db74">&#34;Wrap&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        I also wrap text!
</span></span><span style="display:flex;"><span>    &lt;/TextBlock&gt;
</span></span><span style="display:flex;"><span>&lt;/Button&gt;</span></span></code></pre></div><p>This allows the <code>&lt;Button&gt;</code> to continue to use the default <code>ControlTemplate</code> while providing the desired word-wrapping with a minimum of extra code.</p>
<p>A similar idea appears with <code>&lt;DataTemplate&gt;</code>, which allows you to customize how bound data is displayed in a control.  For example, we often want to display the items in a <code>&lt;ListBox&gt;</code> in a different way than the default (a <code>&lt;TextBlock&gt;</code> with minimal styling).  We&rsquo;ll visit this in the upcoming <a href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/04-data-binding/04-binding-lists/" target="_blank">binding lists</a>
 section.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="summary">Summary</h1>

<p>In this chapter, we saw how WPF applications are organized into a tree of controls.  Moreover, we discussed how WPF uses this tree to perform its layout and rendering calculations.  We also saw how we can traverse this tree in our programs to find parent or child elements of a specific type.</p>
<p>In addition, we saw how declaring <em>resources</em> at a specific point in the tree makes them available to all elements descended from that node.  The resources we looked at included <code>&lt;Style&gt;</code> elements, which allow us to declare setters for properties of a specific type of element, to apply consistent styling rules.</p>
<p>We also saw how we could declare resources with a <code>x:Key</code> property, and bind them as static resources to use in our controls - including strings and other common types.  Building on that idea, we saw how we could embed images and other media files as resources.</p>
<p>We also explored how <code>&lt;ControlTemplates&gt;</code> are used to compose complex controls from simpler controls, and make it possible to swap out that implementation for a custom one.  We also briefly discussed when it may make more sense to compose the <em>content</em> of a control differently to get the same effect.</p>
<p>When we explore events and data binding in later chapters, we will see how these concepts <em>also</em> interact with the element tree in novel ways.</p>

            <footer class="footline">

            </footer>
          </article>

          </section>
    
    
          <article class="chapter">
            <header class="headline">
            </header>


<div class="article-subheading">Chapter 3</div>
<h1 id="event-driven-programming">Event-Driven Programming</h1>

<p>I Fight for the Users!</p>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Event-Driven Programming</h1>
    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="introduction">Introduction</h1>

<p>Event-Driven programming is a programming paradigm where the program primarily responds to events - typically generated by a user, but also potentially from sensors, network connections, or other sources.  We cover it here because event-driven programming is a staple of graphical user interfaces.  These typically display a fairly static screen until the user interacts with the program in some meaningful way - moving or clicking the mouse, hitting a key, or the like.</p>
<p>As you might suspect, event-driven programming is often used alongside other programming paradigms, including structured programming and object-orientation.  We&rsquo;ll be exploring how event-driven programming is implemented in C# in this chapter, especially how it interacts with Windows Presentation Foundation.</p>
<h2 id="key-terms">Key Terms</h2>
<ul>
<li>Event</li>
<li>Message Loop</li>
<li>Message Queue</li>
<li>Event Handler</li>
<li>Event Listener</li>
<li>Event Arguments</li>
</ul>
<h2 id="c-keywords-and-operators">C# Keywords and Operators</h2>
<ul>
<li><code>event</code></li>
<li><code>EventArgs</code></li>
<li><code>+=</code></li>
<li><code>-=</code></li>
<li><code>?.</code></li>
</ul>
<h2 id="key-skills">Key Skills</h2>
<p>The key skills to learn in this chapter are how to write event listeners, attach event listeners to event handlers, and how to define custom event handlers.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="message-loops">Message Loops</h1>

<p>At the heart of every Windows program (and most operating systems), is an infinitely repeating loop we call the <em>message loop</em> and a data structure we call a <em>message queue</em> (some languages/operating systems use the term <em>event</em> instead of <em>message</em>).  The message queue is managed by the operating system - it adds new events that the GUI needs to know about (i.e. a mouse click that occurred within the GUI) to this queue.  The message loop is often embedded in the main function of the program, and continuously checks for new messages in the queue.  When it finds one, it processes the message.  Once the message is processed, the message loop again checks for a new message.  The basic code for such a loop looks something like this:</p>
<div class="wrap-code highlight"><pre tabindex="0"><code>function main
    initialize()
    while message != quit
        message := get_next_message()
        process_message(message)
    end while
end function</code></pre></div><p>This approach works well for most GUIs as once the program is drawn initially (during the <code>initialize()</code> function), the appearance of the GUI will not change until it responds to some user action.</p>
<p>In a WPF or Windows Forms application, this loop is buried in the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.application?view=netcore-3.1" target="_blank"><code>Application</code></a>
 class that the <code>App</code> inherits from.  Instead of writing the code to process these system messages directly, this class converts these messages into C# <em>events</em>, which are then consumed by the event listeners the programmer provides.  We&rsquo;ll look at these next.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="event-handlers">Event Handlers</h1>

<p>In C#, we use <em>event handlers</em> (sometimes called <em>event listeners</em> in other languages) to register the behavior we want to happen in response to specific events.  You&rsquo;ve probably already used these, i.e. declaring a handler:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> OnEvent(<span style="color:#66d9ef">object</span> sender, EventArgs e) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TODO: Respond to the event</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Most event handlers follow the same pattern.  They do not have a return value (their return type is <code>void</code>), and take two parameters.  The first is always an <code>object</code>, and it is the source of the event (hence &ldquo;sender&rdquo;).  The second is an <code>EventArgs</code> object, or a class <em>descended</em> from <code>EventArgs</code>, which provides details about the event.</p>
<p>For example, the various events dealing with mouse input (<code>MouseMove</code>, <code>MouseDown</code>, <code>MouseUp</code>) supply a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.mouseeventargs?view=netcore-3.1" target="_blank"><code>MouseEventArgs</code></a>
 object.  This object includes properties defining the mouse location, number of clicks, mouse wheel rotations, and which button was involved in the event.</p>
<p>You&rsquo;ve probably attached event handlers using the <strong>&ldquo;Properties&rdquo;</strong> panel in Visual Studio, but you can also attach them in code:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>Button button = <span style="color:#66d9ef">new</span> Button();
</span></span><span style="display:flex;"><span>button.Click += OnClick;</span></span></code></pre></div><p>Note you <em>don&rsquo;t include parenthesis</em> after the name of the event handler.  You aren&rsquo;t <em>invoking</em> the event handler, you&rsquo;re <em>attaching</em> it (so it can be invoked in the future when the event happens).  Also, note that we use the <code>+=</code> operator to signify attaching an event handler.</p>
<p>This syntax is a deliberate choice to help reinforce the idea that we can attach <em>multiple</em> event handlers in C#, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>Button button = <span style="color:#66d9ef">new</span> Button();
</span></span><span style="display:flex;"><span>button.Click += onClick1;
</span></span><span style="display:flex;"><span>button.Click += onClick2;</span></span></code></pre></div><p>In this case, <em>both</em> <code>onClick1</code> and <code>onClick2</code> will be invoked when the button is clicked.  This is also one reason to attach event handlers programmatically rather than through the <strong>&ldquo;Properties&rdquo;</strong> window (it can only attach one).</p>
<p>We can also <em>remove</em> an event handler if we no longer want it to be invoked when the event happens.  We do this with the <code>-=</code> operator:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>button.Click -= onClick1;</span></span></code></pre></div><p>Again, note we use the handler&rsquo;s name without parenthesis.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="declaring-events">Declaring Events</h1>

<p>Up to this point, you&rsquo;ve probably only used events that were defined on library objects, like the Button&rsquo;s Click event.  However, you can also declare events in your own classes, and even create new event types.</p>
<p>In order to attach an event handler to an object in C#, we must first declare that that object has the corresponding event.  To do so, we need both a <em>name</em> for the event, and a <em>delegate</em>.</p>
<p>In C# a <a href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/delegates/" target="_blank">Delegate</a>
 is a special type that represents a method with a specific method signature and return type. A delegate allows us to associate the delegate with any method that matches that signature and return type. For example, the <code>Click</code> event handler we discussed earlier is a delegate which matches a method that takes two arguments: an <code>object</code> and an <code>EventArgs</code>, and returns void.  Any event listener that we write that matches this specification can be attached to the <code>button.Click</code>.  In a way, a <code>Delegate</code> is like an <code>Interface</code>, only for methods instead of objects.</p>
<p>Consider a class representing an egg.  What if we wanted to define an event to represent when it hatched?  We&rsquo;d need a delegate for that event, which can be declared a couple of ways.  The traditional method would be:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">delegate</span> <span style="color:#66d9ef">void</span> HatchHandler(<span style="color:#66d9ef">object</span> sender, EventArgs args);</span></span></code></pre></div><p>And then in our class we&rsquo;d declare the corresponding event. In C#, these are written much like a field, but with the addition of the <code>event</code> keyword:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> HatchHandler Hatch;</span></span></code></pre></div><p>Like a field declaration, an event declaration can have an access modifier (<code>public</code>, <code>private</code>, or <code>protected</code>), a name (in this case <code>Hatch</code>), and a type (the delegate).  It also gets marked with the <code>event</code> keyword.</p>
<p>When C# introduced generics, it became possible to use a generic delegate as well, <code>EventHandler&lt;T&gt;</code>, where the <code>T</code> is the type for the event arguments.  This simplifies writing an event, because we no longer need to define the delegate ourselves.  So instead of the two lines above, we can just use:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> EventHandler&lt;EventArgs&gt; Hatch;</span></span></code></pre></div><p>The second form is increasingly preferred, as it makes testing our code much easier (we&rsquo;ll see this soon), and it&rsquo;s less code to write.</p>
<h3 id="custom-eventargs">Custom EventArgs</h3>
<p>We might also want to create our own custom event arguments to accompany the event.  Perhaps we want to provide a reference to an object representing the baby chick that hatched.  To do so we can create a new class that inherits from <code>EventArgs</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// A class representing the hatching of a chick </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">HatchEventArgs</span> : EventArgs 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The chick that hatched </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Chick Chick { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">set</span>; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Constructs a new HatchEventArgs </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;chick&#34;&gt;The chick that hatched&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> HatchEventArgs(Chick chick) 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.Chick = chick;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>And we use this custom event args in our event declaration as the type for the generic <code>EventHandler&lt;T&gt;</code> generic:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> EventHandler&lt;HatchEventArgs&gt; Hatch;</span></span></code></pre></div><p>Now let&rsquo;s say we set up our <code>Egg</code> constructor to start a timer to determine when the egg will hatch:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> Egg() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Set a timer to go off in 20 days </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// (ms = 20 days * 24 hours/day * 60 minutes/hour * 60 seconds/minute * 1000 milliseconds/seconds)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> timer = <span style="color:#66d9ef">new</span> System.Timers.Timer(<span style="color:#ae81ff">20</span> * <span style="color:#ae81ff">24</span> * <span style="color:#ae81ff">60</span> * <span style="color:#ae81ff">60</span> * <span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span>    timer.Elapsed += StartHatching;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>In the event handler <code>StartHatching</code>, we&rsquo;ll want to create our new baby chick, and then trigger the <code>Hatch</code> event.  To do this, we need to <em>raise</em> the event to pass to any attached handlers with <code>Hatch.Invoke()</code>, passing in both the event arguments and the source of the event (our egg):</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> StartHatching(<span style="color:#66d9ef">object</span> source, ElapsedEventArgs e) 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> chick = <span style="color:#66d9ef">new</span> Chick();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> args = <span style="color:#66d9ef">new</span> HatchEventArgs(chick);
</span></span><span style="display:flex;"><span>    Hatch.Invoke(<span style="color:#66d9ef">this</span>, args);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>However we might have the case where there are no registered event handlers, in which case <code>Hatch</code> evaluates to <code>null</code>, and attempting to call <code>Invoke()</code> will cause an error.  We can prevent this by wrapping our <code>Invoke()</code> within a conditional:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(Hatch != <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>    Hatch.Invoke(<span style="color:#66d9ef">this</span>, args);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>However, there is a handy shorthand form for doing this (more syntactic sugar):</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>Hatch?.Invoke(<span style="color:#66d9ef">this</span>, args);</span></span></code></pre></div><p>Using the question mark (<code>?</code>) before the method invocation is known as the <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/member-access-operators#null-conditional-operators--and-" target="_blank">Null-condition operator</a>
. We use this to avoid calling the <code>Invoke()</code> method if <code>PropertyChanged</code> is null (which is the case if no event handlers have been assigned to it). It tests the object to see if it is null.  If it is null, the method is not invoked.</p>

  
  
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>You might be wondering why an event with no assigned event handlers is <code>Null</code> instead of some form of empty collection. The answer is rooted in efficiency - remember that each object (even empty collection) requires a certain amount of memory to hold its details.  Now think about all the possible events we might want to listen for in a GUI.  The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.control?view=netcore-3.1#events" target="_blank">System.Windows.Controls.Control</a>
 Class (a base class for all WPF controls) defines around 100 events.  Now multiply that by all the controls used in a single GUI, and you&rsquo;ll see that small amount of memory consumption adds up quickly.  By leaving unused events null, C# saves significant memory!</p>
</div>
</div>
<p>Thus, our complete egg class would be:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// A class representing an egg </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Egg</span> 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// An event triggered when the egg hatches </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> EventHandler&lt;HatchEventArgs&gt; Hatch;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Constructs a new Egg instance </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Egg() 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Set a timer to go off in 20 days </span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// (ms = 20 days * 24 hours/day * 60 minutes/hour * 60 seconds/minute * 1000 milliseconds/seconds)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> timer = <span style="color:#66d9ef">new</span> System.Timers.Timer(<span style="color:#ae81ff">20</span> * <span style="color:#ae81ff">24</span> * <span style="color:#ae81ff">60</span> * <span style="color:#ae81ff">60</span> * <span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span>        timer.Elapsed += StartHatching;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Handles the end of the incubation period </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// by triggering a Hatch event </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> StartHatching(<span style="color:#66d9ef">object</span> source, ElapsedEventArgs e) 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> chick = <span style="color:#66d9ef">new</span> Chick();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> args = <span style="color:#66d9ef">new</span> HatchEventArgs(chick);
</span></span><span style="display:flex;"><span>        Hatch?.Invoke(<span style="color:#66d9ef">this</span>, args);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="events-as-messages">Events as Messages</h1>

<p>It might be becoming clear that in many ways, events are another form of <em>message passing</em>, much like methods are.  In fact, they are processed much the same way: the <code>Invoke()</code> method of the event <em>calls</em> each attached event handler in turn.</p>

  
  
<div class="box notices cstyle tip">
  <div class="box-label"><i class="fa-fw fas fa-lightbulb"></i> Tip</div>
  <div class="box-content">

<p>Regular event invocation in C# is <em>synchronous</em>, just as is method calling - invoking an event passes execution to the event handlers one at a time the same way calling a method hands program execution to the method.  Once they have finished executing, program execution continues back in the code that invoked the event.  Let&rsquo;s see a practical example based on our discussion of the Hatch event.  If we were to give our chick a name:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> StartHatching(<span style="color:#66d9ef">object</span> source, ElapsedEventArgs e) 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> chick = <span style="color:#66d9ef">new</span> Chick();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> args = <span style="color:#66d9ef">new</span> HatchEventArgs(chick);
</span></span><span style="display:flex;"><span>    Hatch?.Invoke(<span style="color:#66d9ef">this</span>, args);
</span></span><span style="display:flex;"><span>    chick.Name = <span style="color:#e6db74">&#34;Cluckzilla&#34;</span>;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>And in our event handler, we tried to print that name:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> OnHatch(<span style="color:#66d9ef">object</span> sender, HatchEventArgs e)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    Console.WriteLine(<span style="color:#e6db74">$&#34;Welcome to the world, {e.Chick.Name}!&#34;</span>);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>The <code>OnHatch</code> event handler would be triggered by the <code>Hatch?.Invoke()</code> line <em>before</em> the name was set, so the <code>Chick.Name</code> property would be null!  We would need to move the name assignment to <em>before</em> the <code>Invoke()</code> call for it to be available in any attached event handlers.</p>
</div>
</div>
<p>The <code>EventArgs</code> define what the message contains, the <code>sender</code> specifies which object is sending the event, and the objects defining the event handlers are the ones receiving it.</p>
<p>That last bit is the biggest difference between using an event to pass a message and using a method to pass the same message.  With a method, we always have one object sending and one object receiving.  In contrast, an event can have <em>no</em> objects receiving, one object receiving, or <em>many</em> objects receiving.</p>
<p>An event is therefore more flexible and open-ended.  We can determine which object(s) should receive the message at any point - even at runtime.  In contrast, with a method we need to know what object we are sending the message to (i.e invoking the method of) as we write the code to do so.</p>
<p>Let&rsquo;s look at a concrete example of where this can come into play.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="propertychanged">PropertyChanged</h1>

<p>We often have classes which encapsulate data we might need to look at.  For example, we might have a &ldquo;Smart&rdquo; dog dish, which keeps track of the amount of food it contains in ounces.  So it exposes a <code>Weight</code> property.</p>
<p>Now let&rsquo;s assume we have a few possible add-on products that can be combined with that smart bowl.  One is a &ldquo;dinner bell&rdquo;, which makes noises when the bowl is filled (ostensibly to attract the dog, but mostly just to annoy your neighbors).  Another is a wireless device that sends texts to your phone to let you know when the bowl is empty.</p>
<p>How can the software running on these devices determine when the bowl is empty or full?  One possibility would be to check the bowl&rsquo;s weight constantly, or at a set interval.  We call this strategy <em>polling</em>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// The run button for the Dinner Bell add-on</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> Run()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span>(bowl.Weight != <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Do nothing</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// If we reach here, the bowl is empty!</span>
</span></span><span style="display:flex;"><span>    sendEmptyText();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>The problem with this approach is that it means our program is running full-bore <em>all the time</em>.  If this is a battery-operated device, those batteries will drain quickly.  It might be better if we let the smart bowl notify the Dinner Bell, but if we did this using methods, the Smart Bowl would need a reference to that dinner bell&hellip; and any other accessories we plug in.</p>
<p>This was a common problem in GUI design - sometimes we need to know when a property changes because we are displaying that property&rsquo;s value in the GUI, possibly in multiple places.  But if that property is <em>not</em> part of a GUI display, we may not care when it changes.</p>
<h3 id="the-inotifypropertychanged-interface">The INotifyPropertyChanged Interface</h3>
<p>The standard answer to this dilemma in .NET is the <code>INotifyPropertyChanged</code> interface - an interface defined in the <code>System.ComponentModel</code> namespace that requires you to implement a single event <code>PropertyChanged</code> on the class that is changing.  You can define this event as:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> PropertyChangedEventHandler? PropertyChanged;</span></span></code></pre></div><p>This sets up the <code>PropertyChanged</code> event handler on your class.  Let&rsquo;s first look at writing event listeners to take advantage of this event.</p>
<h4 id="propertychanged-event-listeners">PropertyChanged Event Listeners</h4>
<p>In our example, we would do this with the smart dog bowl, and add listeners to the dinner bell and empty notification tools.  The <code>PropertyChangedEventArgs</code> includes the name of the property that is changing (<code>PropertyName</code>) - so we can check that 1) the property changing is the weight, and 2) that the weight meets our criteria, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// A SmartBowl accessory that sends text notifications when the SmartBowl is empty</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">EmptyTexter</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Constructs a new EmptyTexter object </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param Name=&#34;bowl&#34;&gt;The SmartBowl to listen to&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> EmptyTexter(SmartBowl bowl)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        bowl.PropertyChanged += onBowlPropertyChanged;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Responds to changes in the Weight property of the bowl</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param Name=&#34;Sender&#34;&gt;The bowl sending the event&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param Name=&#34;e&#34;&gt;The event arguments (specifying which property changed)&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> onBowlPropertyChanged(<span style="color:#66d9ef">object</span> sender, PropertyChangedEventArgs e)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Only move forward if the property changing is the weight</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (e.PropertyName == <span style="color:#e6db74">&#34;Weight&#34;</span>)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (sender <span style="color:#66d9ef">is</span> SmartBowl)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">var</span> bowl = sender <span style="color:#66d9ef">as</span> SmartBowl;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (bowl.Weight == <span style="color:#ae81ff">0</span>) textBowlIsEmpty();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Helper method to notify bowl is empty</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> textBowlIsEmpty()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// TODO: Implement texting</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Note that in our event listener, we need to check the specific property that is changing is the one we care about - the <code>Weight</code>.  We also cast the source of the event back into a <code>SmartBowl</code>, but only after checking the cast is possible.  Alternatively, we could have stored the <code>SmartBowl</code> instance in a class variable rather than casting.</p>
<p>Or, we can use the new <a href="https://docs.microsoft.com/en-us/dotnet/csharp/pattern-matching#the-is-type-pattern-expression" target="_blank">is type pattern expression</a>
:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(sender <span style="color:#66d9ef">is</span> SmartBowl bowl) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Inside this body, bowl is the sender cast as a SmartBowl</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TODO: logic goes here</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>This is syntactic sugar for:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(sender <span style="color:#66d9ef">is</span> SmartBowl) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> bowl = sender <span style="color:#66d9ef">as</span> SmartBowl;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TODO: logic goes here</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Notice how the is type pattern expression merges the if test and variable assignment?</p>
<p>Also, notice that the only extra information supplied by our <code>PropertyChangedEventArgs</code> is the name of the property - not its prior value, or any other info.  This helps keep the event lightweight, but it does mean if we need to keep track of prior values, we must implement that ourselves, as we do in the <code>DinnerBell</code> implementation:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// A SmartBowl accessory that makes noise when the bowl is filled</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DinnerBell</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Caches the previous weight measurement </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">double</span> lastWeight;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Constructs a new DinnerBell object </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param Name=&#34;bowl&#34;&gt;The SmartBowl to listen to&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> DinnerBell(SmartBowl bowl)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        lastWeight = bowl.Weight;
</span></span><span style="display:flex;"><span>        bowl.PropertyChanged += onBowlPropertyChanged;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Responds to changes in the Weight property of the bowl</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param Name=&#34;Sender&#34;&gt;The bowl sending the event&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param Name=&#34;e&#34;&gt;The event arguments (specifying which property changed)&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> onBowlPropertyChanged(<span style="color:#66d9ef">object</span> sender, PropertyChangedEventArgs e)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Only move forward if the property changing is the weight</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (e.PropertyName == <span style="color:#e6db74">&#34;Weight&#34;</span>)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Cast the sender to a smart bowl using the is type expression</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (sender <span style="color:#66d9ef">is</span> SmartBowl bowl)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// Ring the dinner bell if the bowl is now heavier </span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// (i.e. food has been added)</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (bowl.Weight &gt; lastWeight) ringTheBell();
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// Cache the new weight</span>
</span></span><span style="display:flex;"><span>                lastWeight = bowl.Weight;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Helper method to make noise </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> ringTheBell()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// TODO: Implement noisemaking</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><h4 id="propertychanged-event-declaration">PropertyChanged Event Declaration</h4>
<p>For the event listeners to work as expected, we need to implement the <code>PropertyChanged</code> event in our <code>SmartBowl</code> class with:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> PropertyChangedEventHandler? PropertyChanged;</span></span></code></pre></div><p>Which makes it available for the event handlers to attach to.  But this is only <em>part</em> of the process, we also need to <em>invoke</em> this event when it happens.  This is done with the <code>Invoke(object sender, EventArgs e)</code> method defined for every event handler. It takes two parameters, an <code>object</code> which is the source of the event, and the <code>EventArgs</code> defining the event.  The specific kind of <code>EventArgs</code> corresponds to the event declaration - in our case, <code>PropertyChangedEventArgs</code>.</p>
<p>Let&rsquo;s start with a straightforward example.  Assume we have a <code>Name</code> property in the <code>SmartBowl</code> that is a customizable string, allowing us to identify the bowl, i.e. &ldquo;Water&rdquo; or &ldquo;Food&rdquo;.  When we change it, we need to invoke the <code>PropertyChanged</code> event, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">string</span> name = <span style="color:#e6db74">&#34;Bowl&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> Name {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">get</span> {<span style="color:#66d9ef">return</span> name;}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">set</span> 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        name = <span style="color:#66d9ef">value</span>;
</span></span><span style="display:flex;"><span>        PropertyChanged?.Invoke(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">new</span> PropertyChangedEventArgs(<span style="color:#e6db74">&#34;Name&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Notice how we use the setter for <code>Name</code> to invoke the <code>PropertyChanged</code> event handler, <em>after</em> the change to the property has been made.  This invocation needs to be done <em>after</em> the change, or the responding event listener may grab the <em>old</em> value (remember, event listeners are triggered <em>synchronously</em>).</p>
<p>Also note that we use the  null-conditional operator <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/member-access-operators#null-conditional-operators--and-" target="_blank"><code>?.</code></a>
 to avoid calling the <code>Invoke()</code> method if <code>PropertyChanged</code> is null (which is the case if no event listeners have been assigned).</p>
<p>Now let&rsquo;s tackle a more complex example.  Since our <code>SmartBowl</code> uses a sensor to measure the weight of its contents, we might be able to read the sensor data - probably through a driver or a class representing the sensor. Rather than doing this constantly, let&rsquo;s set a polling interval of 1 minute:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// A class representing a &#34;smart&#34; dog bowl.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SmartBowl</span> : INotifyPropertyChanged 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Event triggered when a property changes</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> PropertyChangedEventHandler? PropertyChanged;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The weight sensor installed in the bowl</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    Sensor sensor;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">string</span> name = <span style="color:#e6db74">&#34;Bowl&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The name of this bowl</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> Name
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> name; }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">set</span>
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            name = <span style="color:#66d9ef">value</span>;
</span></span><span style="display:flex;"><span>            PropertyChanged?.Invoke(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">new</span> PropertyChangedEventArgs(<span style="color:#e6db74">&#34;Name&#34;</span>));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">double</span> weight;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The weight of the bowl contents, measured in ounces</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> Weight
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> weight; }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">set</span>
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// We only want to treat the weight as changing </span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// if the change is more than a 16th of an ounce</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (Math.Abs(weight - <span style="color:#66d9ef">value</span>) &gt; <span style="color:#ae81ff">1</span> / <span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                weight = <span style="color:#66d9ef">value</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// Notify of the property changing</span>
</span></span><span style="display:flex;"><span>                PropertyChanged?.Invoke(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">new</span> PropertyChangedEventArgs(<span style="color:#e6db74">&#34;Weight&#34;</span>));
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Constructs a new SmartBowl </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param Name=&#34;sensor&#34;&gt;the weight sensor&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> SmartBowl(Sensor sensor)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.sensor = sensor;
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Set the initial weight</span>
</span></span><span style="display:flex;"><span>        weight = sensor.Value;
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Set a timer to go off in 1 minute  </span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// (ms = 60 seconds/minute * 1000 milliseconds/seconds)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> timer = <span style="color:#66d9ef">new</span> System.Timers.Timer(<span style="color:#ae81ff">60</span> * <span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Set the timer to reset when it goes off </span>
</span></span><span style="display:flex;"><span>        timer.AutoReset = <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Trigger a sensor read each time the timer elapses</span>
</span></span><span style="display:flex;"><span>        timer.Elapsed += readSensor;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Handles the elapsing of the polling timer by updating the weight</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> readSensor(<span style="color:#66d9ef">object</span> Sender, System.Timers.ElapsedEventArgs e)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.Weight = sensor.Value;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Notice in this code, we use the setter of the <code>Weight</code> property to trigger the <code>PropertyChanged</code> event.  Because we&rsquo;re dealing with a real-world sensor that may have slight variations in the readings, we also only treat changes of more than 1/16th of an ounce as significant enough to change the property.</p>

  
  
<div class="box notices cstyle warning">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div>
  <div class="box-content">

<p>With the <code>INotifyPropertyChanged</code> interface, the <em>only</em> aspect Visual Studio checks is that the <code>PropertyChanged</code> event is declared.  There is no built-in check that the programmer is using it as expected.  Therefore it is upon you, the programmer, to ensure that you meet the expectation that comes with implementing this interface: <em>that any public or protected property that changes will invoke the <code>PropertyChanged</code> event</em>.</p>
</div>
</div>
<h4 id="testing-the-propertychanged-event">Testing the PropertyChanged Event</h4>
<p>Finally, we should write unit tests to confirm that our <code>PropertyChanged</code> event works as expected:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SmartBowlUnitTests</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// A mock sensor that increases its reading by one ounce </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// every time its Value property is invoked.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MockChangingWeightSensor</span> : Sensor
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">double</span> <span style="color:#66d9ef">value</span> = <span style="color:#ae81ff">0.0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> Value {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">get</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">value</span> += <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">value</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">
</span></span></span><span style="display:flex;"><span><span style="color:#a6e22e">    [Fact]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> NameChangeShouldTriggerPropertyChanged() 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> bowl = <span style="color:#66d9ef">new</span> SmartBowl(<span style="color:#66d9ef">new</span> MockChangingWeightSensor());
</span></span><span style="display:flex;"><span>        Assert.PropertyChanged(bowl, <span style="color:#e6db74">&#34;Name&#34;</span>, () =&gt; {
</span></span><span style="display:flex;"><span>            bowl.Name = <span style="color:#e6db74">&#34;New Name&#34;</span>;
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">
</span></span></span><span style="display:flex;"><span><span style="color:#a6e22e">    [Fact]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> WeightChangeShouldTriggerPropertyChanged()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> bowl = <span style="color:#66d9ef">new</span> SmartBowl(<span style="color:#66d9ef">new</span> MockChangingWeightSensor());
</span></span><span style="display:flex;"><span>        Assert.PropertyChangedAsync(bowl, <span style="color:#e6db74">&#34;Weight&#34;</span>, () =&gt; {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> Task.Delay(<span style="color:#ae81ff">2</span> * <span style="color:#ae81ff">60</span> * <span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>The <code>PropertyChanged</code> interface is so common in C# programming that we have <em>two</em> assertions dealing with it.  The first we use to test the <code>Name</code> property:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#a6e22e">[Fact]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> NameChangeShouldTriggerPropertyChanged() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> bowl = <span style="color:#66d9ef">new</span> SmartBowl(<span style="color:#66d9ef">new</span> MockChangingWeightSensor());
</span></span><span style="display:flex;"><span>    Assert.PropertyChanged(bowl, <span style="color:#e6db74">&#34;Name&#34;</span>, () =&gt; {
</span></span><span style="display:flex;"><span>        bowl.Name = <span style="color:#e6db74">&#34;New Name&#34;</span>;
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Notice that <code>Assert.PropertyChanged(@object obj, string propertyName, Action action)</code> takes three arguments - first the object with the property that should be changing, second the name of the property we expect to change, and third an action that should trigger the event.  In this case, we change the name property.</p>
<p>The second is a bit more involved, as we have an event that happens based on a timer.  To test it therefore, we have to wait for the timer to have had an opportunity to trigger.  We do this with an asynchronous action, so we use the <code>Assert.PropertyChangedAsync(@object obj, string propertyName, Func&lt;Task&gt; action)</code>.  The first two arguments are the same, but the last one is a <code>Func</code> (a function) that returns an asynchronous <code>Task</code> object.  The simplest one to use here is <code>Task.Delay</code>, which delays for the supplied period of time (in our case, two minutes).  Since our property should change on one-minute intervals, we&rsquo;ll know if there was a problem if it doesn&rsquo;t change after two minutes.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="inheritance-and-events">Inheritance And Events</h1>

<p>Considering that C# was developed as an object-oriented language from the ground up, you would expect that events would be inheritable just like properties, fields, and methods.  Unfortunately this is not the case.  Remember, the C# language is compiled into intermediate language to run on the .NET Runtime, and this Runtime proceeded C# (it is also used to compile Visual Basic), and the way events are implemented in intermediate language does not lend itself to inheritance patterns.</p>
<p>This has some important implications for writing C# events:</p>
<ul>
<li>You cannot invoke events defined in a base class in a derived class</li>
<li>The <code>virtual</code> and <code>override</code> keywords used with events do not actually create an overridden event - you instead end up with two separate implementations.</li>
</ul>
<p>The standard way programmers have adapted to this issue is to:</p>
<ol>
<li>Define the event normally in the base class</li>
<li>Add a <code>protected</code> helper method to that base class that will invoke the event, taking whatever parameters are needed</li>
<li>Calling that helper method from derived classes.</li>
</ol>
<p>For example, the <code>PropertyChanged</code> event we discussed previously is often invoked from a helper method named <code>OnPropertyChanged()</code> that is defined like this:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> OnPropertyChanged(<span style="color:#66d9ef">string</span> propertyName)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.PropertyChanged?.Invoke(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">new</span> PropertyChangedEventArgs(propertyName));
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>In derived classes, you can indicate a property is changing by calling this event, and passing in the property name, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">object</span> _tag = <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// An object to represent whatever you need </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">object</span> Tag {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">get</span> =&gt; _obj;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">set</span> 
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(<span style="color:#66d9ef">value</span> != _obj) 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      _obj = <span style="color:#66d9ef">value</span>;
</span></span><span style="display:flex;"><span>      OnPropertyChanged(nameof(<span style="color:#66d9ef">this</span>.Tag));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Note the call to <code>OnPropertyChanged()</code> - this will trigger the <code>PropertyChanged</code> event handler on the base class.</p>

  
  
<div class="box notices cstyle tip">
  <div class="box-label"><i class="fa-fw fas fa-lightbulb"></i> Tip</div>
  <div class="box-content">

<p>You might have noticed the use of <code>nameof(this.Tag)</code> in the example code above.  The <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/nameof" target="_blank">nameof expression</a> returns the <em>name</em> of a property as a string.  This approach is preferred over just writing the string, as it makes it less likely a typo will result in your code not working as expected.</p>
</div>
</div>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="routed-events">Routed Events</h1>

<p>While events exist in Windows Forms, Windows Presentation Foundation adds a twist with their concept of <em>routed events</em>.  Routed events are similar to regular C# events, but provide additional functionality.  One of the most important of these is the ability of the routed event to &ldquo;bubble&rdquo; up the <a href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/02-element-tree/">elements tree</a>
.  Essentially, the event will be passed up each successive WPF element until one chooses to &ldquo;handle&rdquo; it, or the top of the tree is reached (in which case the event is ignored).</p>
<p>Consider a Click event handler for a button.  In Windows Forms, we have to attach our listener <em>directly to the button</em>, i.e:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> WindowsFormsApp1
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Form1</span> : Form
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> Form1()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            InitializeComponent();
</span></span><span style="display:flex;"><span>            IncrementButton.Click += HandleClick;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> HandleClick(<span style="color:#66d9ef">object</span> sender, EventArgs e)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// TODO: Handle our click</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>With WPF we can also attach an event listener directly to the button, but we can <em>also</em> attach an event listener to an <em>ancestor</em> of the button (a component further up the element tree).  The click event will &ldquo;bubble&rdquo; up the element tree, and each successive parent will have the opportunity to handle it.  I.e. we can define a button in the <code>ChildControl</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;WpfApp1.ChildControl&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:WpfApp1&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;800&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;IncrementButton&#34;</span><span style="color:#f92672">&gt;</span>Count<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div><p>And add an instance of <code>ChildControl</code> to our <code>MainWindow</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>&lt;Window x:Class=<span style="color:#e6db74">&#34;WpfApp1.MainWindow&#34;</span>
</span></span><span style="display:flex;"><span>        xmlns=<span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>        xmlns:x=<span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>        xmlns:d=<span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span>
</span></span><span style="display:flex;"><span>        xmlns:mc=<span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span>
</span></span><span style="display:flex;"><span>        xmlns:local=<span style="color:#e6db74">&#34;clr-namespace:WpfApp1&#34;</span>
</span></span><span style="display:flex;"><span>        mc:Ignorable=<span style="color:#e6db74">&#34;d&#34;</span>
</span></span><span style="display:flex;"><span>        Title=<span style="color:#e6db74">&#34;MainWindow&#34;</span> Height=<span style="color:#e6db74">&#34;450&#34;</span> Width=<span style="color:#e6db74">&#34;800&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;Grid Button.Click=<span style="color:#e6db74">&#34;HandleClick&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;local:ChildControl/&gt;        
</span></span><span style="display:flex;"><span>    &lt;/Grid&gt;
</span></span><span style="display:flex;"><span>&lt;/Window&gt;</span></span></code></pre></div><p>Note that in our <code>&lt;Grid&gt;</code> we attached a <code>Button.Click</code> handler?  The attached listener, <code>HandleClick</code>, will be invoked for <em>all</em> <code>Click</code> events arising from <code>Buttons</code> that are nested under the <code>&lt;Grid&gt;</code> in the elements tree.  We can then write this event handler in the codebehind of our <code>MainWindow</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> WpfApp1
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Interaction logic for MainWindow.xaml</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MainWindow</span> : Window
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> MainWindow()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            InitializeComponent();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> HandleClick(Object sender, RoutedEventArgs e)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span>(e.OriginalSource <span style="color:#66d9ef">is</span> Button button &amp;&amp; button.Name == <span style="color:#e6db74">&#34;IncrementButton&#34;</span>)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// TODO: Handle increment;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                e.Handled = <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Note that because this event listener will be triggered for <em>all</em> buttons, we need to make sure it&rsquo;s a button we care about - so we cast the <code>OriginalSource</code> of the event to be a button and check its <code>Name</code> property.  We use the <code>RoutedEventArgs.OriginalSource</code> because the <code>sender</code> won&rsquo;t necessarily be the specific control the event originated in - in this case it actually is the <code>Grid</code> containing the button.  Also, note that we mark <code>e.Handled</code> as <code>true</code>.  This tells WPF it can stop &ldquo;bubbling&rdquo; the event, as we have taken care of it.</p>
<p>We&rsquo;ll cover routed events in more detail in the upcoming <a href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/05-dependency-objects/">Dependency Objects</a>
 chapter, but for now you need to know that the GUI events you know from Windows Forms (Click, Select, Focus, Blur), are all routed events in WPF, and therefore take a <code>RoutedEventArgs</code> object instead of the event arguments you may be used to.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="collectionchanged">CollectionChanged</h1>

<p>The <code>PropertyChanged</code> event notifies us when a <em>property</em> of an object changes, which covers most of our GUI notification needs.  However, there are some concepts that aren&rsquo;t covered by it - specifically, when an item is added or removed from a collection.  We use a different event, <code>NotifyCollectionChanged</code> to convey when this occurs.</p>
<h3 id="the-inotifycollectionchanged-interface">The INotifyCollectionChanged Interface</h3>
<p>The <code>INotifyCollectionChanged</code> interface defined in the <code>System.Collections.Specialized</code> namespace indicates the collection implements the <code>NotifyCollectionChangedEventHandler</code>, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> NotifyCollectionChangedEventHandler? NotifyCollectionChanged;</span></span></code></pre></div><p>And, as you would expect, this event is triggered any time the collection&rsquo;s contents change, much like the <code>PropertyChanged</code> event we discussed earlier was triggered when a property changed.  However, the <code>NotifyCollectionChangedEventArgs</code> provides a <em>lot</em> more information than we saw with the <code>PropertyChangedEventArgs</code>,as you can see in the UML diagram below:</p>
<p>
<a href="#image-fe70244b991fb51ed4d718e732ada220" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.3.9.1.png" alt="UML or NotifyCollectionChangedEventArgs and PropertyChangedEventArgs" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-fe70244b991fb51ed4d718e732ada220">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.3.9.1.png" alt="UML or NotifyCollectionChangedEventArgs and PropertyChangedEventArgs" class="lightbox-image" loading="lazy">
</a></p>
<p>With <code>PropertyChangedEventArgs</code> we simply provide the name of the property that is changing.  But with <code>NotifyCollectionChangedEventArgs</code>, we are describing both <em>what</em> the change is (i.e. an Add, Remove, Replace, Move, or Reset), and what item(s) we affected.  So if the action was adding an item, the <code>NotifyCollectionChangedEventArgs</code> will let us know what item was added to the collection, and possibly at what position it was added at.</p>
<p>When implementing the <code>INotifyCollectionChanged</code> interface, you must supply a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.collections.specialized.notifycollectionchangedeventargs?view=net-5.0" target="_blank"><code>NotifyCollectionChangedEventArgs</code> object</a> that describes the change to the collection.  This class has multiple constructors, and you must select the correct one, or your code will cause a runtime error when the event is invoked.</p>

  
  
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>You might be wondering why <code>PropertyChangedEventArgs</code> contains so little information compared to <code>NotifyCollectionChangedEventArgs</code>.  Most notably, the <em>old</em> and <em>new</em> values of the property could have been included. I suspect the reason they were not is that there are many times where you don&rsquo;t actually need to know what the property value is - just that it changed, and you can always retrieve that value once you know you need to.</p>
<p>In contrast, there are situations where a GUI displaying a collection may have hundreds of entries. Identifying <em>exactly</em> which ones have changed means that only those entries need to be modified in the GUI.  If we didn&rsquo;t have that information, we&rsquo;d have to retrieve the <em>entire</em> collection and re-render it, which can be a very computationally expensive process.</p>
<p>But ultimately, the two interfaces were developed by different teams at different times, which probably accounts for most of the differences.</p>
</div>
</div>
<h4 id="notifycollectionchangedaction">NotifyCollectionChangedAction</h4>
<p>The only property of the <code>NotifyCollectionChangedArgs</code> that will <em>always</em> be populated is the <code>Action</code> property.  The type of This property is the <code>NotifyCollectionChangedAction</code> enumeration, and its values (and what they represent) are:</p>
<ul>
<li><code>NotifyCollectionChangedAction.Add</code> - one or more items were added to the collection</li>
<li><code>NotifyCollectionChangedAction.Move</code> - an item was moved in the collection</li>
<li><code>NotifyCollectionChangedAction.Remove</code> - one or more items were removed from the collection</li>
<li><code>NotifyCollectionChangedAction.Replace</code> - an item was replaced in the collection</li>
<li><code>NotifyCollectionChangedAction.Reset</code> - drastic changes were made to the collection</li>
</ul>
<h4 id="notifycollectionchangedeventargs-constructors">NotifyCollectionChangedEventArgs Constructors</h4>
<p>A second feature you probably noticed from the UML is that there are a <em>lot</em> of constructors for the <code>NotifyCollectionChangedEventArgs</code>.  Each represents a different situation, and you must pick the appropriate one.</p>
<p>For example, the <code>NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction)</code> constructor represents a <code>NotifyCollectionChangedAction.Reset</code> change. This indicates the collection&rsquo;s content changed <em>dramatically</em>, and the best recourse for a GUI is to ask for the full collection again and rebuild the display.  You should <em>only</em> use this one-argument constructor for a Reset action.</p>

  
  
<div class="box notices cstyle warning">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div>
  <div class="box-content">

<p>In C#, there is no mechanism for limiting a constructor to specific argument values. So you actually <em>can</em> call the above constructor for a different kind of event, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">new</span> NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Add);</span></span></code></pre></div><p>However, doing so will throw a <code>InvalidArgumentException</code> when the code is actually executed.</p>
</div>
</div>
<p>In general, if you are adding or removing an <code>object</code>, you need to provide the <code>object</code> to the constructor. If you are adding or removing multiple objects, you will need to provide an <code>IList</code> of the affected objects.  And you may also need to provide the object&rsquo;s index in the collection. You can read more about the available constructors and their uses in the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.collections.specialized.notifycollectionchangedeventargs.-ctor?view=net-6.0#system-collections-specialized-notifycollectionchangedeventargs-ctor%28system-collections-specialized-notifycollectionchangedaction-system-object%29" target="_blank">Microsoft Documentation</a>
.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="testing-generic-events">Testing Generic Events</h1>

<p>In the testing chapter, we introduced the XUnit assertion for testing events, <code>Assert.Raises&lt;T&gt;</code>.  Let&rsquo;s imagine a doorbell class that raises a <code>Ring</code> event when it is pressed, with information about the door, which can be used to do things like ring a physical bell, or send a text notification:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// A class representing details of a ring event </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RingEventArgs</span> : EventArgs 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">string</span> _door;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The identity of the door for which the doorbell was activated</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> Door =&gt; _door;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Constructs a new RingEventArgs </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> RingEventArgs(<span style="color:#66d9ef">string</span> door) 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      _door = door;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// A class representing a doorbell</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Doorbell</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// An event triggered when the doorbell rings </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> EventHandler&lt;RingEventArgs&gt; Ring;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The name of the door where this doorbell is mounted </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> Identifier {<span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>;}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Handles the push of a doorbell</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// by triggering a Ring event </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> Push() 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        Ring?.Invoke(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">new</span> RingEventArgs(Identifier));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>To test this doorbell, we&rsquo;d want to make sure that the <code>Ring</code> event is invoked when the <code>Push()</code> method is called.  The <code>Assert.Raises&lt;T&gt;</code> does exactly this:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#a6e22e">[Fact]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> PressingDoorbellShouldRaiseRingEvent
</span></span><span style="display:flex;"><span>Doorbell db = <span style="color:#66d9ef">new</span> Doorbell();
</span></span><span style="display:flex;"><span>Assert.Raises&lt;RingEventArgs&gt;(
</span></span><span style="display:flex;"><span>  handler =&gt; db.Ring += handler,
</span></span><span style="display:flex;"><span>  handler =&gt; db.Ring -= handler, 
</span></span><span style="display:flex;"><span>  () =&gt; {
</span></span><span style="display:flex;"><span>    db.Push();
</span></span><span style="display:flex;"><span>  });</span></span></code></pre></div><p>This code may be a bit confusing at first, so let&rsquo;s step through it.  The <code>&lt;T&gt;</code> is the type of event arguments we expect to receive, in this case, <code>RingEventArgs</code>.  The first argument is a lambda expression that attaches an event handler <code>handler</code> (provided by the <code>Assert.Raises</code> method) to our object to test, <code>db</code>.  The second argument is a lambda expression that removes the event handler <code>handler</code>.  The third is an action (also written as a lambda expression) that should trigger the event if the code we are testing is correct.</p>
<p>This approach allows us to test events declared with the generic <code>EventHandler&lt;T&gt;</code>, which is one of the reasons we prefer it.  It will not work with custom event handlers though; for those we&rsquo;ll need a different approach.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="testing-custom-events">Testing Custom Events</h1>

<p>In the previous section, we discussed using XUnit&rsquo;s <code>Assert.Raises&lt;T&gt;</code> to test generic events (events declared with the <code>EventHandler&lt;T&gt;</code> generic).  However, this approach does not work with non-generic events, like <code>PropertyChanged</code> and <code>CollectionChanged</code>.  That is why XUnit provides an <code>Assert.PropertyChanged()</code> method.  Unfortunately, it does not offer a corresponding test for <code>CollectionChanged</code>.  So to test for this expectation we will need to write our own assertions.</p>
<p>To do that, we need to understand how assertions in the XUnit framework work.  Essentially, they test the truthfulness of what is being asserted (i.e. two values are equal, a collection contains an item, etc.).  If the assertion is not true, then the code raises an exception - specifically, a <code>XunitException</code> or a class derived from it. This class provides a <code>UserMessage</code> (the message you get when the test fails) and a <code>StackTrace</code> (the lines describing where the error was thrown). With this in mind, we can write our own assertion method.  Let&rsquo;s start with a simple example that asserts the value of a string is &ldquo;Hello World&rdquo;:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyAssert</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">HelloWorldAssertionException</span>: XunitException 
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">public</span> HelloWorldAssertionException(<span style="color:#66d9ef">string</span> actual) : <span style="color:#66d9ef">base</span>(<span style="color:#e6db74">$&#34;Expected \&#34;</span>Hello World<span style="color:#960050;background-color:#1e0010">\</span><span style="color:#e6db74">&#34; but instead saw \&#34;{actual}\&#34;&#34;</span>) {}
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> HelloWorld(<span style="color:#66d9ef">string</span> phrase)
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(phrase != <span style="color:#e6db74">&#34;Hello World&#34;</span>) <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> HelloWorldAssertionException(phrase);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Note that we use the <code>base</code> keyword to execute the <code>XunitException</code> constructor as part of the <code>HelloWorldAssertionException</code>, and pass along the <code>string</code> parameter <code>actual</code>.  Then the body of the <code>XunitException</code> constructor does all the work of setting values, so the body of our constructor is empty.</p>
<p>Now we can use this assertion in our own tests:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#a6e22e">[Theory]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">[InlineData(&#34;Hello World&#34;)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">[InlineData(&#34;Hello Bob&#34;)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> ShouldBeHelloWorld(<span style="color:#66d9ef">string</span> phrase)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  MyAssert.HelloWorld(phrase);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>The first <code>InlineData</code> will pass, and the second will fail with the report <code>Expected &quot;Hello World&quot; but instead saw &quot;Hello Bob&quot;</code>.</p>
<p>This was of course, a silly example, but it shows the basic concepts.  We would probably never use this in our own work, as <code>Assert.Equal()</code> can do the same thing.  Now let&rsquo;s look at a more complex example that we <em>would</em> use.</p>
<h2 id="assertions-for-collectionchanged">Assertions for CollectionChanged</h2>
<p>As we discussed previously, the <code>CollectionChanged</code> event cannot be tested with the Xunit <code>Assert.Throws</code>.  So this is a great candidate for custom assertions.  To be thorough, we should test <em>all</em> the possible actions (and we would do this if expanding the Xunit library).  But for how we plan to use it, we really only need two actions covered - adding and removing items <em>one at a time</em> from the collection.  Let&rsquo;s start with our exception definitions:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyAssert</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NotifyCollectionChangedNotTriggeredException</span>: XunitException 
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">public</span> NotifyCollectionChangedNotTriggeredException(NotifyCollectionChangedAction expectedAction) : <span style="color:#66d9ef">base</span>(<span style="color:#e6db74">$&#34;Expected a NotifyCollectionChanged event with an action of {expectedAction} to be invoked, but saw none.&#34;</span>) {}
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NotifyCollectionChangedWrongActionException</span>: XunitException 
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">public</span> NotifyCollectionChangedWrongActionException(NotifyCollectionChangedAction expectedAction, NotifyCollectionChangedAction actualAction) : <span style="color:#66d9ef">base</span>(<span style="color:#e6db74">$&#34;Expected a NotifyCollectionChanged event with an action of {expectedAction} to be invoked, but saw {actualAction}&#34;</span>) {}
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NotifyCollectionChangedAddException</span>: XunitException 
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">public</span> NotifyCollectionChangedAddException(<span style="color:#66d9ef">object</span> expected, <span style="color:#66d9ef">object</span> actual) : <span style="color:#66d9ef">base</span>(<span style="color:#e6db74">$&#34;Expected a NotifyCollectionChanged event with an action of Add and object {expected} but instead saw {actual}&#34;</span>) {}
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NotifyCollectionChangedRemoveException</span> : XunitException
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> NotifyCollectionChangedRemoveException(<span style="color:#66d9ef">object</span> expectedItem, <span style="color:#66d9ef">int</span> expectedIndex, <span style="color:#66d9ef">object</span> actualItem, <span style="color:#66d9ef">int</span> actualIndex) : <span style="color:#66d9ef">base</span>(<span style="color:#e6db74">$&#34;Expected a NotifyCollectionChanged event with an action of Remove and object {expectedItem} at index {expectedIndex} but instead saw {actualItem} at index  {actualIndex}&#34;</span>) {}
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>We have four different exceptions, each with a very specific message conveying what the failure was due to - no event being triggered, an event with the wrong action being triggered, or an event with the wrong information being triggered.  We could also handle this with one exception class using multiple constructors (much like the <code>NotifyCollectionChangedEventArgs</code> does).</p>
<p>Then we need to write our assertions, which are more involved than our previous example as 1) the event uses a generic type, so our assertion also must be a generic, and 2) we need to handle an event - so we need to attach an event handler, and trigger code that should make that event occur.  Let&rsquo;s start with defining the signature of the <code>Add</code> method:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyAssert</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> NotifyCollectionChangedAdd&lt;T&gt;(INotifyCollectionChanged collection, T item, Action testCode) 
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Assertion tests here.</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>We use the generic type <code>T</code> to allow our assertion to be used with any kind of collection - and the second parameter <code>item</code> is <em>also</em> this type.  That is the object we are trying to add to the <code>collection</code>.  Finally, the <code>Action</code> is the code the test will execute that would, in theory, add <code>item</code> to <code>collection</code>.  Let&rsquo;s flesh out the method body now:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyAssert</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> NotifyCollectionChangedAdd&lt;T&gt;(INotifyCollectionChanged collection, T newItem, Action testCode)
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// A flag to indicate if the event triggered successfully</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">bool</span> notifySucceeded = <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// An event handler to attach to the INotifyCollectionChanged and be </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// notified when the Add event occurs.</span>
</span></span><span style="display:flex;"><span>    NotifyCollectionChangedEventHandler handler = (sender, args) =&gt;
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Make sure the event is an Add event</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (args.Action != NotifyCollectionChangedAction.Add)
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> NotifyCollectionChangedWrongActionException(NotifyCollectionChangedAction.Add, args.Action);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Make sure we added just one item</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (args.NewItems?.Count != <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// We&#39;ll use the collection of added items as the second argument</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> NotifyCollectionChangedAddException(newItem, args.NewItems);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Make sure the added item is what we expected</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (!args.NewItems[<span style="color:#ae81ff">0</span>].Equals(newItem))
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Here we only have one item in the changed collection, so we&#39;ll report it directly</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> NotifyCollectionChangedAddException(newItem, args.NewItems[<span style="color:#ae81ff">0</span>]);
</span></span><span style="display:flex;"><span>      } 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// If we reach this point, the NotifyCollectionChanged event was triggered successfully</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// and contains the correct item! We&#39;ll set the flag to true so we know.</span>
</span></span><span style="display:flex;"><span>      notifySucceeded = <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Now we connect the event handler </span>
</span></span><span style="display:flex;"><span>    collection.CollectionChanged += handler;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// And attempt to trigger the event by running the actionCode</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// We place this in a try/catch to be able to utilize the finally </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// clause, but don&#39;t actually catch any exceptions</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      testCode();
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// After this code has been run, our handler should have </span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// triggered, and if all went well, the notifySucceed is true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (!notifySucceeded)
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// If notifySucceed is false, the event was not triggered</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// We throw an exception denoting that</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> NotifyCollectionChangedNotTriggeredException(NotifyCollectionChangedAction.Add);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// We don&#39;t actually want to catch an exception - we want it to </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// bubble up and be reported as a failing test.  So we don&#39;t </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// have a catch () {} clause to this try/catch.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">finally</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// However, we *do* want to remove the event handler. We do </span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// this in a finally block so it will happen even if we do </span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// have an exception occur. </span>
</span></span><span style="display:flex;"><span>      collection.CollectionChanged -= handler;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Now we can test this in our code.  For example, if we had a collection of <code>ShoppingList</code> objects named <code>shoppingLists</code> that implemented <code>INotifyCollectionChanged</code>, we could test adding a new shopping list, <code>shoppingList</code>, to it with:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> newList = <span style="color:#66d9ef">new</span> ShoppingList();
</span></span><span style="display:flex;"><span>MyAssert.NotifyCollectionChangedAdd(shoppingLists, newList, () =&gt; {
</span></span><span style="display:flex;"><span>  shoppingLists.Add(newList);
</span></span><span style="display:flex;"><span>});</span></span></code></pre></div><p>Note that we didn&rsquo;t need to explicitly state <code>T</code> in this case is <code>ShoppingList</code> - the compiler infers this from the arguments supplied to the method.</p>
<p>Our assertion method handles adding a <em>single</em> item. We can use method <em>overloading</em> providing another method of the same name with different arguments to handle when <em>multiple</em> items are added. For that case, the signature might look like:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> NotifyCollectionChangedAdd&lt;T&gt;(INotifyCollectionChanged collection, ICollection&lt;T&gt; items, Action testCode) 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Assertion tests here.</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>We&rsquo;d also want to write assertion methods for handling removing items, and any other actions we might need to test.  I&rsquo;ll leave these as exercises for the reader.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="summary">Summary</h1>

<p>In this chapter we discussed the Windows Message Loop and Queue, and how messages provided to this loop are transformed into C# events by the <code>Application</code> class.  We examined C#&rsquo;s approach to events, which is a more flexible form of message passing.  We learned how to write both C# event listeners and handlers, and how to invoke event handlers with <code>Invoke()</code>.  We also learned how to create and trigger our own custom events with custom event arguments.</p>
<p>In addition, we learned about the <code>INotifyPropertyChanged</code> interface, and how it can be used to notify listeners that one of an Object&rsquo;s properties have changed through a <code>NotifyPropertyChanged</code> event handler.  We also saw how to test our implementations of <code>INotifyPropertyChanged</code> using xUnit.  In our next chapter on <a href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/04-data-binding/">Data Binding</a>
, we will see how this interface is used by Windows Presentation Foundation to update user interfaces automatically when bound data objects change.</p>
<p>We saw that Windows Presentation Foundation also uses Routed Events, which can bubble up the elements tree and be handled by any ancestor element.  This approach replaces many of the familiar UI events from Windows Forms.  We&rsquo;ll take a deeper look at this approach, including defining our own Routed Events and alternative behaviors like &ldquo;tunnelling&rdquo; down the elements tree in the upcoming <a href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/05-dependency-objects/">Dependency Objects</a>
 chapter.</p>
<p>Finally, we discussed testing strategies for testing if our events work as expected.  We revisited the Xunit <code>Assert.Raises&lt;t&gt;()</code> and discussed how it works with generic event handlers.  We also saw how for non-generic event handlers, we may have to author our own assertions, and even created one for the <code>CollectionChanged</code> event.</p>

            <footer class="footline">

            </footer>
          </article>

          </section>
    
    
          <article class="chapter">
            <header class="headline">
            </header>


<div class="article-subheading">Chapter 4</div>
<h1 id="data-binding">Data Binding</h1>

<p>Linking GUIs to Data</p>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Data Binding</h1>
    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="introduction">Introduction</h1>

<p>The term <em>data binding</em> refers to binding two objects together programmatically so that one has access to the data of the other.  We most commonly see this with user interfaces and data objects - the user interface <em>exposes</em> some of the state of the data object to the user.  As with many programming tasks, there are a number of ways to approach data binding.  The Windows Presentation Foundation in C# has adopted an event and component-based approach that we will explore in this chapter.</p>
<h2 id="key-terms">Key Terms</h2>
<p>Some key terms to learn in this chapter are:</p>
<ul>
<li>Data Binding</li>
<li>One-way data binding</li>
<li>Two-way data binding</li>
<li>Data Context</li>
</ul>
<h2 id="key-skills">Key Skills</h2>
<p>Some key skills you need to develop in this chapter are:</p>
<ul>
<li>Binding data objects to UI Components</li>
<li>Implementing (realizing) the <code>INotifyPropertyChanged</code> interface</li>
<li>Invoking event handlers</li>
<li>Using the <code>DataContext</code> property</li>
<li>Casting objects to a specific Type without triggering errors</li>
</ul>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="data-binding">Data Binding</h1>

<p>Data binding is a technique for synchronizing data between a provider and consumer, so that any time the data changes, the change is reflected in the bound elements.  This strategy is commonly employed in graphical user interfaces (GUIs) to bind controls to data objects.  Both Windows Forms and Windows Presentation Foundation employ data binding.</p>
<p>In WPF, the data object is essentially a normal C# object, which represents some data we want to display in a control. However, this object must implement the <code>INotifyPropertyChanged</code> interface in order for changes in the data object to be automatically applied to the WPF control it is bound to.  Implementing this interface comes with two requirements.  First, the class will define a <code>PropertyChanged</code> event:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> PropertyChangedEventHandler? PropertyChanged;</span></span></code></pre></div><p>And second, it will invoke that <code>PropertyChanged</code> event handler <em>whenever</em> one of its properties changes:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>PropertyChanged?.Invoke(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">new</span> PropertyChangedEventArgs(<span style="color:#e6db74">&#34;ThePropertyName&#34;</span>));</span></span></code></pre></div><p>The string provided to the <code>PropertyChangedEventArgs</code> constructor <em>must</em> match the property name <em>exactly</em>, including capitalization.</p>
<p>For example, this simple person implementation is ready to serve as a data object:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// A class representing a person </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Person</span> : INotifyPropertyChanged
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// An event triggered when a property changes </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> PropertyChangedEventHandler? PropertyChanged;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">string</span> firstName = <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// This person&#39;s first name </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> FirstName
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> firstName; }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">set</span>
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            firstName = <span style="color:#66d9ef">value</span>;
</span></span><span style="display:flex;"><span>            PropertyChanged?.Invoke(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">new</span> PropertyChangedEventArgs(<span style="color:#e6db74">&#34;FirstName&#34;</span>));
</span></span><span style="display:flex;"><span>            PropertyChanged?.Invoke(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">new</span> PropertyChangedEventArgs(<span style="color:#e6db74">&#34;FullName&#34;</span>));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">string</span> lastName = <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// This person&#39;s last name </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> LastName
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> lastName; }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">set</span>
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            lastName = <span style="color:#66d9ef">value</span>;
</span></span><span style="display:flex;"><span>            PropertyChanged?.Invoke(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">new</span> PropertyChangedEventArgs(<span style="color:#e6db74">&#34;LastName&#34;</span>));
</span></span><span style="display:flex;"><span>            PropertyChanged?.Invoke(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">new</span> PropertyChangedEventArgs(<span style="color:#e6db74">&#34;FullName&#34;</span>));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// This persons&#39; full name </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> FullName
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">$&#34;{firstName} {lastName}&#34;</span>; }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Constructs a new person </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param Name=&#34;first&#34;&gt;The person&#39;s first name&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param Name=&#34;last&#34;&gt;The person&#39;s last name&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Person(<span style="color:#66d9ef">string</span> first, <span style="color:#66d9ef">string</span> last)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.firstName = first;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.lastName = last;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>There are several details to note here.  As the <code>FirstName</code> and <code>LastName</code> properties have setters, we must invoke the <code>PropertyChanged</code> event within them.  Because of this extra logic, we can no longer use auto-property syntax.  Similarly, as the value of <code>FullName</code> is derived from these properties, we must <em>also</em> notify that <code>&quot;FullName&quot;</code> changes when one of <code>FirstName</code> or <code>LastName</code> changes.</p>
<p>To accomplish the binding in XAML, we use a syntax similar to that we used for static resources.  For example, to bind a <code>&lt;TextBlock&gt;</code> element to the <code>FullName</code> property, we would use:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=FullName}&#34;</span> <span style="color:#f92672">/&gt;</span></span></span></code></pre></div><p>Just as with our static resource, we wrap the entire value in curly braces (<code>{}</code>), and declare a <code>Binding</code>.  The <code>Path</code> in the binding specifies the <em>property</em> we want to bind to - in this case, <code>FullName</code>.  This is considered a one-way binding, as the <code>TextBlock</code> element only displays text - it is not editable.  The corresponding control for editing a textual property is the <code>&lt;TextBox&gt;</code>.  A two-way binding is declared the same way i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=FirstName}&#34;</span> <span style="color:#f92672">/&gt;</span></span></span></code></pre></div><p>However, we cannot bind a read-only property (one that has no setter) to an editable control - only those with both accessible getters and setters.  The XAML for a complete control for editing a person might look something like:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;DataBindingExample.PersonControl&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span>     
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:DataBindingExample&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:system=</span><span style="color:#e6db74">&#34;clr-namespace:System;assembly=mscorlib&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;400&#34;</span><span style="color:#f92672">&gt;</span>    
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=FullName}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Label&gt;</span>First<span style="color:#f92672">&lt;/Label&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=FirstName}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Label&gt;</span>Last<span style="color:#f92672">&lt;/Label&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=LastName}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/StackPanel&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div><p>We also need to set the <code>DataContext</code> property of the control.  This property holds the specific data object whose properties are bound in the control.  For example, we could pass a <code>Person</code> object into the <code>PersonControl</code>&rsquo;s constructor and set it as the <code>DataContext</code> in the codebehind:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> DataBindingExample
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Interaction logic for PersonControl.xaml</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PersonEntry</span> : UserControl
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// Constructs a new PersonEntrycontrol </span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/// &lt;param Name=&#34;person&#34;&gt;The person object to data bind&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> PersonEntry(Person person)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            InitializeComponent();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.DataContext = person;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>However, this approach means we can no longer declare a <code>&lt;PersonControl&gt;</code> in XAML (as objects declared this way must have a parameterless constructor).  An alternative is to bind the <code>DataContext</code> in the codebehind of an ancestor control; for example, a window containing the control:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Window</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;DataContextExample.MainWindow&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:DataContextExample&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Title=</span><span style="color:#e6db74">&#34;MainWindow&#34;</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;800&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;local:PersonEntry</span> <span style="color:#a6e22e">x:Name=</span><span style="color:#e6db74">&#34;personEntry&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Window&gt;</span></span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> DataContextExample
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Interaction logic for MainWindow.xaml</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MainWindow</span> : Window
</span></span><span style="display:flex;"><span>    {        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> MainWindow()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            InitializeComponent();
</span></span><span style="display:flex;"><span>            personControl.DataContext = <span style="color:#66d9ef">new</span> Person(<span style="color:#e6db74">&#34;Bugs&#34;</span>, <span style="color:#e6db74">&#34;Bunny&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Finally, the <code>DataContext</code> has a very interesting relationship with the elements tree.  If a control in this tree does not have its own <code>DataContext</code> property directly set, it uses the <code>DataContext</code> of the first ancestor where it <em>has</em> been set. I.e. were we to set the <code>DataContext</code> of the window to a person:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> DataContextExample
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Interaction logic for MainWindow.xaml</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MainWindow</span> : Window
</span></span><span style="display:flex;"><span>    {        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> MainWindow()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            InitializeComponent();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.DataContext = <span style="color:#66d9ef">new</span> Person(<span style="color:#e6db74">&#34;Elmer&#34;</span>, <span style="color:#e6db74">&#34;Fudd&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>And have a <code>PersonElement</code> nested somewhere further down the elements tree:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Window</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;DataBindingExample.MainWindow&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:DataBindingExample&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Title=</span><span style="color:#e6db74">&#34;MainWindow&#34;</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;800&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Border&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;local:PersonEntry/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Border&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Window&gt;</span></span></span></code></pre></div><p>The bound person (Elmer Fudd)&rsquo;s information would be displayed in the <code>&lt;PersonEntry&gt;</code>!</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="the-binding-class">The Binding Class</h1>

<p>In Windows Presentation Foundation, data binding is accomplished by a binding object that sits between the <em>binding target</em> (the control) and the <em>binding source</em> (the data object):</p>
<p>
<a href="#image-5f88ef42c2c7faac2b6f952b2b267648" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.4.3.1.png" alt="The WPF Data Binding implementation" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-5f88ef42c2c7faac2b6f952b2b267648">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.4.3.1.png" alt="The WPF Data Binding implementation" class="lightbox-image" loading="lazy">
</a></p>
<p>It is this <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.data.binding?view=windowsdesktop-6.0" target="_blank">Binding</a>
 object that we are defining the properties of in the XAML attribute with <code>&quot;{Binding}&quot;</code>.  Hence, <code>Path</code> is a property defined on this binding.</p>
<p>As we mentioned before, bindings can be <code>OneWay</code> or <code>TwoWay</code> based on the direction the data flows.  The binding mode is specified by the <code>Binding</code> object&rsquo;s <code>Mode</code> property, which can also be set in XAML. There are actually two additional options.  The first is a <code>OneWayToSource</code> that is basically a reversed one-way binding (the control updates the data object, but the data object does not update the control)</p>
<p>For example, we actually <em>could</em> use a <code>&lt;TextEditor&gt;</code> with a read-only property, if we changed the binding mode:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextEditor</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=FullName Mode=OneWay}&#34;</span> <span style="color:#f92672">/&gt;</span></span></span></code></pre></div><p>Though this might cause your user confusion because they would <em>seem</em> to be able to change the property, but the change would not actually be applied to the bound object.  However, if you <em>also</em> set the <code>IsEnabled</code> property to false to prevent the user from making changes:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextEditor</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=FullName Mode=OneWay}&#34;</span> <span style="color:#a6e22e">IsEnabled=</span><span style="color:#e6db74">&#34;False&#34;</span> <span style="color:#f92672">/&gt;</span></span></span></code></pre></div><p>The second binding mode is <code>OneTime</code> which initializes the control with the property, but does not apply any subsequent changes.  This is similar to the behavior you will see from a data object that does not implement the <code>INotifyPropertyChanged</code> interface, as the <code>Binding</code> object depends on it for notifications that the property has changed.</p>
<p>Generally, you&rsquo;ll want to use a control meant to be used with the mode you intend to employ - editable controls default to <code>TwoWay</code> and display controls to <code>OneWay</code>.</p>
<p>One other property of the <code>Binding</code> class that&rsquo;s good to know is the <code>Source</code> property.  Normally this is determined by the <code>DataContext</code> of the control, but you can override it in the XAML.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="binding-lists">Binding Lists</h1>

<p>For list controls, i.e. <code>ListView</code> and <code>ListBox</code>, the appropriate binding is a collection implementing <code>IEnumerable</code>, and we bind it to the <code>ItemsSource</code> property.  Let&rsquo;s say we want to create a directory that displays information for a <code>List&lt;Person&gt;</code>.  We might write a custom <code>DirectoryControl</code> like:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;DataBindingExample.DirectoryControl&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:DataBindingExample&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;800&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ListBox</span> <span style="color:#a6e22e">ItemsSource=</span><span style="color:#e6db74">&#34;{Binding}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div><p>Notice that we didn&rsquo;t supply a <code>Path</code> with our binding.  In this case, we&rsquo;ll be binding directly to the <code>DataContext</code>, which is a list of <code>People</code> objects drawn from the 1996 classic &ldquo;Space Jam&rdquo;, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Window</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;DataBindingExample.MainWindow&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:DataBindingExample&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Title=</span><span style="color:#e6db74">&#34;MainWindow&#34;</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;800&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;local:DirectoryControl</span> <span style="color:#a6e22e">x:Name=</span><span style="color:#e6db74">&#34;directory&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Window&gt;</span></span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// Interaction logic for MainWindow.xaml</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MainWindow</span> : Window
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> MainWindow()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        InitializeComponent();
</span></span><span style="display:flex;"><span>        ObservableCollection&lt;Person&gt; people = <span style="color:#66d9ef">new</span> ObservableCollection&lt;Person&gt;()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> Person(<span style="color:#e6db74">&#34;Bugs&#34;</span>, <span style="color:#e6db74">&#34;Bunny&#34;</span>, <span style="color:#66d9ef">true</span>),
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> Person(<span style="color:#e6db74">&#34;Daffy&#34;</span>, <span style="color:#e6db74">&#34;Duck&#34;</span>, <span style="color:#66d9ef">true</span>),
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> Person(<span style="color:#e6db74">&#34;Elmer&#34;</span>, <span style="color:#e6db74">&#34;Fudd&#34;</span>, <span style="color:#66d9ef">true</span>),
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> Person(<span style="color:#e6db74">&#34;Tazmanian&#34;</span>, <span style="color:#e6db74">&#34;Devil&#34;</span>, <span style="color:#66d9ef">true</span>),
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> Person(<span style="color:#e6db74">&#34;Tweety&#34;</span>, <span style="color:#e6db74">&#34;Bird&#34;</span>, <span style="color:#66d9ef">true</span>),
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> Person(<span style="color:#e6db74">&#34;Marvin&#34;</span>, <span style="color:#e6db74">&#34;Martian&#34;</span>, <span style="color:#66d9ef">true</span>),
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> Person(<span style="color:#e6db74">&#34;Michael&#34;</span>, <span style="color:#e6db74">&#34;Jordan&#34;</span>),
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> Person(<span style="color:#e6db74">&#34;Charles&#34;</span>, <span style="color:#e6db74">&#34;Barkely&#34;</span>),
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> Person(<span style="color:#e6db74">&#34;Patrick&#34;</span>, <span style="color:#e6db74">&#34;Ewing&#34;</span>),
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> Person(<span style="color:#e6db74">&#34;Larry&#34;</span>, <span style="color:#e6db74">&#34;Johnson&#34;</span>)
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        DataContext = people;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Instead of a <code>List&lt;Person&gt;</code>, we&rsquo;ll use an <code>ObservableCollection&lt;Person&gt;</code> which is essentially a list that implements the <code>INotifyPropertyChanged</code> interface.</p>
<p>When we run this code, our results will be:</p>
<p>
<a href="#image-59a89a38550df975cd49fdeec6cd80d3" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.4.4.1.png" alt="The ListView in the running application" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-59a89a38550df975cd49fdeec6cd80d3">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.4.4.1.png" alt="The ListView in the running application" class="lightbox-image" loading="lazy">
</a></p>
<p>This is because the <code>ListBox</code> (and the <code>ListView</code>) by default are composed of <code>&lt;TextBlock&gt;</code> elements, so each <code>Person</code> in the list is being bound to a <code>&lt;TextBlock&gt;</code>&rsquo;s <code>Text</code> property.  This invokes the <code>ToString()</code> method on the <code>Person</code> object, hence the <code>DataBindingExample.Person</code> displayed for each entry.</p>
<p>We could, of course, override the <code>ToString()</code> method on person.  But we can also overwrite the <code>DataTemplate</code> the list uses to display its contents.  Instead of using the default <code>&lt;TextView&gt;</code>, the list will use the <code>DataContext</code>, and the bindings, we supply.  For example, we could re-write the <code>DirectoryControl</code> control as:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;DataBindingExample.DirectoryControl&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:DataBindingExample&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;800&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ListBox</span> <span style="color:#a6e22e">ItemsSource=</span><span style="color:#e6db74">&#34;{Binding}&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ListBox.ItemTemplate&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;DataTemplate&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;Border</span> <span style="color:#a6e22e">BorderBrush=</span><span style="color:#e6db74">&#34;Black&#34;</span> <span style="color:#a6e22e">BorderThickness=</span><span style="color:#e6db74">&#34;2&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=FullName}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;CheckBox</span> <span style="color:#a6e22e">IsChecked=</span><span style="color:#e6db74">&#34;{Binding Path=IsCartoon}&#34;</span> <span style="color:#a6e22e">IsEnabled=</span><span style="color:#e6db74">&#34;False&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>                                Is a Looney Toon
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;/CheckBox&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;/StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;/Border&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/DataTemplate&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/ListBox.ItemTemplate&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/ListBox&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div><p>And the resulting application would display:</p>
<p>
<a href="#image-b7972701bc238b851c2eb4dbd19aabd4" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.4.4.2.png" alt="The updated ListView in the running application" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-b7972701bc238b851c2eb4dbd19aabd4">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.4.4.2.png" alt="The updated ListView in the running application" class="lightbox-image" loading="lazy">
</a></p>
<p>Note that in our <code>DataTemplate</code>, we can bind to properties in the <code>Person</code> object.  This works because as the <code>ListBox</code> processes its <code>ItemsSource</code> property, it creates a new instance of its <code>ItemTemplate</code> (in this case, our custom <code>DataTemplate</code>) and assigns the item from the <code>ItemSource</code> to its <code>DataContext</code>.</p>
<p>Using custom <code>DataTemplates</code> for XAML controls is a powerful feature to customize the appearance and behavior of your GUI.</p>
<p>Lists also can interact with other elements through bindings.  Let&rsquo;s refactor our window so that we have a <code>&lt;PersonRegistry&gt;</code> side-by-side with our <code>&lt;PersonControl&gt;</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Window</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;DataBindingExample.MainWindow&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:DataBindingExample&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Title=</span><span style="color:#e6db74">&#34;MainWindow&#34;</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;800&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;local:PersonControl</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#a6e22e">DataContext=</span><span style="color:#e6db74">&#34;{Binding Path=CurrentItem}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;local:DirectoryControl</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Window&gt;</span></span></span></code></pre></div><p>Note how we bind the <code>&lt;PersonControl&gt;</code>&rsquo;s <code>DataContext</code> to the <code>CurrentItem</code> of the <code>ObservableCollection&lt;Person&gt;</code>.  In our <code>&lt;RegistryControl&gt;</code>&rsquo;s <code>ListBox</code>, we&rsquo;ll also set its <code>IsSynchronizedWithCurrentItem</code> property to true:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;DataBindingExample.DirectoryControl&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:DataBindingExample&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;800&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ListBox</span> <span style="color:#a6e22e">ItemsSource=</span><span style="color:#e6db74">&#34;{Binding}&#34;</span> <span style="color:#a6e22e">HorizontalContentAlignment=</span><span style="color:#e6db74">&#34;Stretch&#34;</span> <span style="color:#a6e22e">IsSynchronizedWithCurrentItem=</span><span style="color:#e6db74">&#34;True&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ListBox.ItemTemplate&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;DataTemplate&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;Border</span> <span style="color:#a6e22e">BorderBrush=</span><span style="color:#e6db74">&#34;Black&#34;</span> <span style="color:#a6e22e">BorderThickness=</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=FullName}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;CheckBox</span> <span style="color:#a6e22e">IsChecked=</span><span style="color:#e6db74">&#34;{Binding Path=IsCartoon, Mode=OneWay}&#34;</span> <span style="color:#a6e22e">IsEnabled=</span><span style="color:#e6db74">&#34;False&#34;</span><span style="color:#f92672">&gt;</span>Cartoon<span style="color:#f92672">&lt;/CheckBox&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;/StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;/Border&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/DataTemplate&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/ListBox.ItemTemplate&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/ListBox&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div><p>With these changes, when we select a person in the <code>&lt;RegistryControl&gt;</code>, their information will appear in the <code>&lt;PersonControl&gt;</code>:</p>
<p>
<a href="#image-19c13bb3f8057ed294076dc0278662d0" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.4.4.3.png" alt="The bound controls" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-19c13bb3f8057ed294076dc0278662d0">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.4.4.3.png" alt="The bound controls" class="lightbox-image" loading="lazy">
</a></p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="binding-enumerations">Binding Enumerations</h1>

<p>Now let&rsquo;s delve into a more complex data binding examples - binding enumerations.  For this discussion, we&rsquo;ll use a simple enumeration of fruits:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// Possible fruits</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">enum</span> Fruit
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    Apple,
</span></span><span style="display:flex;"><span>    Orange,
</span></span><span style="display:flex;"><span>    Peach,
</span></span><span style="display:flex;"><span>    Pear
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>And add a <code>FavoriteFruit</code> property to our <code>Person</code> class:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> Fruit favoriteFruit;
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// The person&#39; favorite fruit</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> Fruit FavoriteFruit
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> favoriteFruit; }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">set</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        favoriteFruit = <span style="color:#66d9ef">value</span>;
</span></span><span style="display:flex;"><span>        PropertyChanged?.Invoke(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">new</span> PropertyChangedEventArgs(<span style="color:#e6db74">&#34;FavoriteFruit&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>For example, what if we wanted to use a <code>ListView</code>  to select an item out of this enumeration?  We&rsquo;d actually need to bind <em>two</em> properties, the <code>ItemSource</code> to get the enumeration values, and the <code>SelectedItem</code> to mark the item being used.  To accomplish this binding, we&rsquo;d need to first make the fruits available for binding by creating a static resource to hold them using an <code>ObjectDataProvider</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;ObjectDataProvider</span> <span style="color:#a6e22e">x:Key=</span><span style="color:#e6db74">&#34;fruits&#34;</span> <span style="color:#a6e22e">ObjectType=</span><span style="color:#e6db74">&#34;system:Enum&#34;</span> <span style="color:#a6e22e">MethodName=</span><span style="color:#e6db74">&#34;GetValues&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ObjectDataProvider.MethodParameters&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;x:Type</span> <span style="color:#a6e22e">TypeName=</span><span style="color:#e6db74">&#34;local:Fruit&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/ObjectDataProvider.MethodParameters&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/ObjectDataProvider&gt;</span></span></span></code></pre></div><p>The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.data.objectdataprovider?view=netcore-3.1" target="_blank"><code>ObjectDataProvider</code></a>
 is an object that can be used as a data source for WPF bindings, and wraps around an object and invokes a method to get the data - in this case the <code>Enum</code> class, and its static method <code>GetValues()</code>, which takes one parameter, the <code>Type</code> of the enum we want to pull the values of (provided as the nested element, <code>&lt;x:Type&gt;</code>).</p>
<p>Also, note that because the <code>Enum</code> class is defined in the System namespace, we need to bring it into the XAML with an xml namespace mapped to it, with the attribute <code>xmlns</code> defined on the UserControl, i.e.: <code>xmlns:system=&quot;clr-namespace:System;assembly=mscorlib&quot;</code>.</p>
<p>Now we can use the <code>fruits</code> key as part of a data source for a listview: <code>&lt;ListView ItemsSource=&quot;{Binding Source={StaticResource fruits}}&quot; SelectedItem=&quot;{Binding Path=FavoriteFruit}&quot;/&gt;</code></p>
<p>Notice that we use the <code>Source</code> property of the <code>Binding</code> class to bind the <code>ItemsSource</code> to the enumeration values exposed in the static resource <code>fruits</code>.  Then we bind the <code>SelectedItem</code> to the person&rsquo;s <code>FavoriteFruit</code> property.  The entire control would be:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;DataBindingExample.PersonControl&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span>     
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:DataBindingExample&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:system=</span><span style="color:#e6db74">&#34;clr-namespace:System;assembly=mscorlib&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;400&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;UserControl.Resources&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ObjectDataProvider</span> <span style="color:#a6e22e">x:Key=</span><span style="color:#e6db74">&#34;fruits&#34;</span> <span style="color:#a6e22e">MethodName=</span><span style="color:#e6db74">&#34;GetValues&#34;</span> <span style="color:#a6e22e">ObjectType=</span><span style="color:#e6db74">&#34;{x:Type system:Enum}&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ObjectDataProvider.MethodParameters&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;x:Type</span> <span style="color:#a6e22e">TypeName=</span><span style="color:#e6db74">&#34;local:Fruit&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/ObjectDataProvider.MethodParameters&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/ObjectDataProvider&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/UserControl.Resources&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=FullName}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Label&gt;</span>First<span style="color:#f92672">&lt;/Label&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=First}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Label&gt;</span>Last<span style="color:#f92672">&lt;/Label&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=Last}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;CheckBox</span> <span style="color:#a6e22e">IsChecked=</span><span style="color:#e6db74">&#34;{Binding Path=IsCartoon}&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            Is a Looney Toon
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/CheckBox&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ListView</span> <span style="color:#a6e22e">ItemsSource=</span><span style="color:#e6db74">&#34;{Binding Source={StaticResource fruits}}&#34;</span> <span style="color:#a6e22e">SelectedItem=</span><span style="color:#e6db74">&#34;{Binding Path=FavoriteFruit}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/StackPanel&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div><h3 id="binding-a-combobox-to-an-enum">Binding a ComboBox to an Enum</h3>
<p>Binding a <code>&lt;ComboBox&gt;</code> is almost identical to the <code>ListView</code> example; we just swap a <code>ComboBox</code> for a <code>ListView</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;DataBindingExample.PersonControl&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span>     
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:DataBindingExample&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:system=</span><span style="color:#e6db74">&#34;clr-namespace:System;assembly=mscorlib&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;400&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;UserControl.Resources&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ObjectDataProvider</span> <span style="color:#a6e22e">x:Key=</span><span style="color:#e6db74">&#34;fruits&#34;</span> <span style="color:#a6e22e">MethodName=</span><span style="color:#e6db74">&#34;GetValues&#34;</span> <span style="color:#a6e22e">ObjectType=</span><span style="color:#e6db74">&#34;{x:Type system:Enum}&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ObjectDataProvider.MethodParameters&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;x:Type</span> <span style="color:#a6e22e">TypeName=</span><span style="color:#e6db74">&#34;local:Fruit&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/ObjectDataProvider.MethodParameters&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/ObjectDataProvider&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/UserControl.Resources&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=FullName}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Label&gt;</span>First<span style="color:#f92672">&lt;/Label&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=First}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Label&gt;</span>Last<span style="color:#f92672">&lt;/Label&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=Last}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;CheckBox</span> <span style="color:#a6e22e">IsChecked=</span><span style="color:#e6db74">&#34;{Binding Path=IsCartoon}&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            Is a Looney Toon
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/CheckBox&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ComboBox</span> <span style="color:#a6e22e">ItemsSource=</span><span style="color:#e6db74">&#34;{Binding Source={StaticResource fruits}}&#34;</span> <span style="color:#a6e22e">SelectedItem=</span><span style="color:#e6db74">&#34;{Binding Path=FavoriteFruit}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/StackPanel&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div><h4 id="binding-radiobuttons-to-an-enum">Binding RadioButtons to an Enum</h4>
<p>Binding a <code>&lt;RadioButton&gt;</code> requires a very different approach, as a radio button exposes an <code>IsChecked</code> boolean property that determines if it is checked, much like a <code>&lt;CheckBox&gt;</code>, but we want it bound to an enumeration property.  There are a lot of attempts to do this by creating a custom content converter, but ultimately they all have flaws.</p>
<p>Instead, we can restyle a <code>ListView</code> to <em>look</em> like radio buttons, but still provide the same functionality by adding a <code>&lt;Style&gt;</code> that applies to the <code>ListViewItem</code> contents of the <code>ListView</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Style</span> <span style="color:#a6e22e">TargetType=</span><span style="color:#e6db74">&#34;{x:Type ListViewItem}&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;Template&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Setter.Value&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ControlTemplate&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;RadioButton</span> <span style="color:#a6e22e">Content=</span><span style="color:#e6db74">&#34;{TemplateBinding ContentPresenter.Content}&#34;</span> <span style="color:#a6e22e">IsChecked=</span><span style="color:#e6db74">&#34;{Binding Path=IsSelected, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/ControlTemplate&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Setter.Value&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Setter&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Style&gt;</span></span></span></code></pre></div><p>This style can be used in conjunction with a <code>ListView</code> declared as we did above:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;DataBindingExample.PersonControl&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span>     
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:DataBindingExample&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:system=</span><span style="color:#e6db74">&#34;clr-namespace:System;assembly=mscorlib&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;400&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;UserControl.Resources&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ObjectDataProvider</span> <span style="color:#a6e22e">x:Key=</span><span style="color:#e6db74">&#34;fruits&#34;</span> <span style="color:#a6e22e">MethodName=</span><span style="color:#e6db74">&#34;GetValues&#34;</span> <span style="color:#a6e22e">ObjectType=</span><span style="color:#e6db74">&#34;{x:Type system:Enum}&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ObjectDataProvider.MethodParameters&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;x:Type</span> <span style="color:#a6e22e">TypeName=</span><span style="color:#e6db74">&#34;local:Fruit&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/ObjectDataProvider.MethodParameters&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/ObjectDataProvider&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Style</span> <span style="color:#a6e22e">TargetType=</span><span style="color:#e6db74">&#34;{x:Type ListViewItem}&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;Template&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;Setter.Value&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;ControlTemplate&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;RadioButton</span> <span style="color:#a6e22e">Content=</span><span style="color:#e6db74">&#34;{TemplateBinding ContentPresenter.Content}&#34;</span> <span style="color:#a6e22e">IsChecked=</span><span style="color:#e6db74">&#34;{Binding Path=IsSelected, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;/ControlTemplate&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/Setter.Value&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/Setter&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Style&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/UserControl.Resources&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=FullName}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Label&gt;</span>First<span style="color:#f92672">&lt;/Label&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=First}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Label&gt;</span>Last<span style="color:#f92672">&lt;/Label&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=Last}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;CheckBox</span> <span style="color:#a6e22e">IsChecked=</span><span style="color:#e6db74">&#34;{Binding Path=IsCartoon}&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            Is a Looney Toon
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/CheckBox&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ListView</span> <span style="color:#a6e22e">ItemsSource=</span><span style="color:#e6db74">&#34;{Binding Source={StaticResource fruits}}&#34;</span> <span style="color:#a6e22e">SelectedItem=</span><span style="color:#e6db74">&#34;{Binding Path=FavoriteFruit}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/StackPanel&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div>
            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="summary">Summary</h1>

<p>In this chapter we explored the concept of data binding and how it is employed in Windows Presentation Foundation.  We saw how bound classes need to implement the <code>INotifyPropertyChanged</code> interface for bound properties to automatically synchronize. We saw how the binding is managed by a <code>Binding</code> class instance, and how we can customize its <code>Path</code>, <code>Mode</code>, and <code>Source</code> properties in XAML to modify the binding behavior.  We bound simple controls like <code>&lt;TextBlock&gt;</code> and <code>&lt;CheckBox&gt;</code> and more complex elements like <code>&lt;ListView&gt;</code> and <code>&lt;ListBox&gt;</code>.  We also explored how to bind enumerations to controls. And we explored the use of templates like <code>DataTemplate</code> and <code>ControlTemplate</code> to modify WPF controls.</p>
<p>The full example project discussed in this chapter can be found at <a href="https://github.com/ksu-cis/DataBindingExample" target="_blank">https://github.com/ksu-cis/DataBindingExample</a>
.</p>

            <footer class="footline">

            </footer>
          </article>

          </section>
    
    
          <article class="chapter">
            <header class="headline">
            </header>


<div class="article-subheading">Chapter 5</div>
<h1 id="dependency-objects">Dependency Objects</h1>

<p>The Bedrock of WPF</p>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Dependency Objects</h1>
    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="introduction">Introduction</h1>

<p>You&rsquo;ve now worked with a variety of WPF controls, laid out components using containers, traversed the elements tree, performed data binding,and worked with routed events.  Each of these is made possible through the use of several classes:  <code>DependencyObject</code>, <code>UIElement</code>, and <code>FrameworkElement</code>, which serve as a base classes for all WPF controls.  In this chapter we&rsquo;ll dig deeper into how these base classes implement <em>dependency properties</em> and <em>routed events</em>.</p>
<h2 id="key-terms">Key Terms</h2>
<p>Some key terms to learn in this chapter are:</p>
<ul>
<li>Dependency Property</li>
<li>Routed Event</li>
<li>MVVM Pattern</li>
</ul>
<h2 id="key-skills">Key Skills</h2>
<p>Some key skills you need to develop in this chapter are:</p>
<ul>
<li>Creating custom dependency properties</li>
<li>Handling routed events</li>
<li>Creating custom routed events</li>
<li>Using dependency property callbacks</li>
</ul>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="dependency-properties">Dependency Properties</h1>

<p>Perhaps the most important aspect of the <code>DependencyObject</code> is its support for hosting <em>dependency properties</em>.  While these appear and can be used much like the C# properties we have previously worked with, internally they are managed very differently.  Consider when we place a <code>&lt;TextBox&gt;</code> in a <code>&lt;Grid&gt;</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid.RowDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;RowDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;RowDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid.RowDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;textBox&#34;</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">Grid.Row=</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Grid&gt;</span></span></span></code></pre></div><p>Where do the <code>Column</code> and <code>Row</code> properties come from?  They aren&rsquo;t defined on the <code>TextBox</code> class - you can <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.textbox?view=netcore-3.1#properties" target="_blank">check the documentation</a>
.  The answer is they are made available through the dependency property system.</p>
<p>At the heart of this system is a collection of key/value pairs much like the <code>Dictionary</code>.  When the XAML code <code>Grid.Column=&quot;1&quot;</code> is processed, this key and value are added to the <code>TextBox</code>&rsquo;s dependency properties collection, and is thereafter accessible by the WPF rendering algorithm.</p>
<p>The <code>DependencyObject</code> exposes these stored values with the <code>GetValue(DependencyProperty)</code> and <code>SetValue(DependencyProperty, value)</code> methods.  For example, we can set the <code>Column</code> property to <code>2</code> with:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>textBox.SetValue(Grid.ColumnProperty, <span style="color:#ae81ff">2</span>);</span></span></code></pre></div><p>We can also create <em>new</em> dependency properties on our own custom classes extending the <code>DependencyObject</code> (which is also a base class for all WPF controls).  Let&rsquo;s say we are making a custom control for entering number values on a touch screen, which we&rsquo;ll call <code>NumberBox</code>.  We can extend a <code>UserControl</code> to create a textbox centered between two buttons, one to increase the value, and one to decrease it:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;CustomDependencyObjectExample.NumberBox&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:CustomDependencyObjectExample&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;50&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;2*&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;0&#34;</span><span style="color:#f92672">&gt;</span>+<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;2&#34;</span><span style="color:#f92672">&gt;</span>-<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div><p>Now, let&rsquo;s assume we want to provide a property <code>Step</code> of type <code>double</code>, which is the amount the number should be incremented when the &ldquo;+&rdquo; or &ldquo;-&rdquo; button is pressed.</p>
<p>The first step is to <em>register</em> the dependency property by creating a <code>DependencyProperty</code> instance.  This will serve as the key to setting and retrieving the dependency property on a dependency object.  We register new dependency properties with <code>DependencyProperty.Register(string propertyName, Type propertyType, Type dependencyObjectType)</code>.  The string is the name of the property, the first type is the type of the property, and the second is the class we want to associate this property with.  So our <code>Step</code> property would be registered with:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>DependencyProperty.Register(nameof(Step), <span style="color:#66d9ef">typeof</span>(<span style="color:#66d9ef">double</span>), <span style="color:#66d9ef">typeof</span>(NumberBox));</span></span></code></pre></div><p>There is an optional fourth property to <code>DependencyProperty.Register()</code> which is a <code>PropertyMetadata</code>.  This is used to set the default value of the property.  We probably should specify a default step, so let&rsquo;s add a <code>PropertyMetadata</code> object with a default value of 1:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>DependencyProperty.Register(nameof(Step), <span style="color:#66d9ef">typeof</span>(<span style="color:#66d9ef">double</span>), <span style="color:#66d9ef">typeof</span>(NumberBox), <span style="color:#66d9ef">new</span> PropertyMetadata(<span style="color:#ae81ff">1.0</span>));</span></span></code></pre></div><p>The <code>DependencyProperty.Register()</code> method returns a registered <code>DependencyObject</code> to serve as a key for accessing our new property.  To make sure we can access this key from <em>other</em> classes, we define it as a field that is <code>public</code>, <code>static</code>, and <code>readonly</code>.  The naming convention for <code>DependencyProperties</code> is to name this field by appending &ldquo;Property&rdquo; to the name of the property.</p>
<p>Thus, the complete registration, including saving the result to the public static field is:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// Identifies the NumberBox.Step XAML attached property</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">readonly</span> DependencyProperty StepProperty = DependencyProperty.Register(nameof(Step), <span style="color:#66d9ef">typeof</span>(<span style="color:#66d9ef">double</span>), <span style="color:#66d9ef">typeof</span>(NumberBox), <span style="color:#66d9ef">new</span> PropertyMetadata(<span style="color:#ae81ff">1.0</span>)); </span></span></code></pre></div><p>We also want to declare a traditional property with the name &ldquo;Step&rdquo;.  But instead of declaring a backing field, we will use the key/value pair stored in our <code>DependencyObject</code> using <code>GetValue()</code> and <code>SetValue()</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// The amount each increment or decrement operation should change the value by</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> Step
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">double</span>)GetValue(StepProperty); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">set</span> { SetValue(StepProperty, <span style="color:#66d9ef">value</span>); }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>As dependency property values are stored as an <code>object</code>, we need to cast the value to a the appropriate type when it is returned.</p>
<p>One of the great benefits of dependency properties is that they can be set using XAML.  I.e. we could declare an instance of our <code>&lt;NumberBox&gt;</code> and set its <code>Step</code> using an attribute:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;NumberBox</span> <span style="color:#a6e22e">Step=</span><span style="color:#e6db74">&#34;3.0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/StackPanel&gt;</span></span></span></code></pre></div>
            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="framework-elements">Framework Elements</h1>

<p>WPF controls are built on the foundation of dependency objects - the <code>DependencyObject</code> is at the bottom of their inheritance chain.  But they also add additional functionality on top of that through another common base class, <code>FrameworkElement</code>.  The <code>FrameworkElement</code> is involved in the layout algorithm, as well as helping to define the <a href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/02-element-tree/">elements tree</a>
.  Let&rsquo;s add a <em>second</em> dependency property to our <code>&lt;NumberBox&gt;</code>, a <code>Value</code> property that will represent the value the <code>&lt;NumberBox&gt;</code> currently represents, which will be displayed in the <code>&lt;TextBox&gt;</code>.</p>
<p>We register this dependency property in much the same way as our <code>Step</code>.  But instead of supplying the <code>DependencyProperty.Register()</code> method a <code>PropertyMetadata</code>, we&rsquo;ll instead supply a <code>FrameworkPropertyMetadata</code>, which extends <code>PropertyMetadata</code> to include additional data about how the property interacts with the WPF rendering and layout algorithms.  This additional data is in the form of a bitmask defined in <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.frameworkpropertymetadataoptions?view=netcore-3.1" target="_blank">FrameworkPropertyMetadataOptions</a>
 enumeration.</p>
<p>Some of the possible options are:</p>
<ul>
<li><code>FrameworkPropertyMetadataOptions.AffectsMeasure</code> - changes to the property may affect the size of the control</li>
<li><code>FrameworkPropertyMetadataOptions.AffectsArrange</code> - changes to the property may affect the layout of the control</li>
<li><code>FrameworkPropertyMetadataOptions.AffectsRender</code> - changes to the property may affect the appearance of the control</li>
<li><code>FrameworkPropertyMetadataOptions.BindsTwoWayByDefault</code> - This property uses two-way bindings by default (i.e. the control is an editable control)</li>
<li><code>FrameworkPropertyMetadataOptions.NotDataBindable</code> - This property does not allow data binding</li>
</ul>
<p>In this case, we want a two-way binding by default, so we&rsquo;ll include that flag, and also we&rsquo;ll note that it affects the rendering process.  Multiple flags can be combined with a <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/bitwise-and-shift-operators#logical-or-operator-" target="_blank">bitwise OR</a>
.  Constructing our <code>FrameworkPropertyMetadata</code> object would then look like:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">new</span> FrameworkPropertyMetadata(<span style="color:#ae81ff">0</span>, FrameworkPropertyMetadataOptions.AffectsRender | FrameworkPropertyMetadataOptions.BindsTwoWayByDefault)</span></span></code></pre></div><p>And registering the dependency property would be:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// Identifies the NumberBox.Value XAML attached property</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">readonly</span> DependencyProperty ValueProperty = DependencyProperty.Register(nameof(Value), <span style="color:#66d9ef">typeof</span>(<span style="color:#66d9ef">double</span>), <span style="color:#66d9ef">typeof</span>(NumberBox), <span style="color:#66d9ef">new</span> FrameworkPropertyMetadata(<span style="color:#ae81ff">0</span>, FrameworkPropertyMetadataOptions.AffectsRender | FrameworkPropertyMetadataOptions.BindsTwoWayByDefault));</span></span></code></pre></div><p>As with the <code>Step</code>, we also want to declare a traditional property with the name &ldquo;Value&rdquo;.  But instead of declaring a backing field, we will use the key/value pair stored in our <code>DependencyObject</code> using <code>GetValue()</code> and <code>SetValue()</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// The NumberBox&#39;s displayed value</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> Value {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">double</span>)GetValue(ValueProperty); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">set</span> { SetValue(ValueProperty, <span style="color:#66d9ef">value</span>); }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>If we want to display the current value of <code>Value</code> in the textbox of our <code>NumberBox</code> control, we&rsquo;ll need to bind the <code>&lt;TextBox&gt;</code> element&rsquo;s <code>Text</code> property.  This is accomplished in a similar fashion to the other bindings we&rsquo;ve done previously, only we need to specify a <code>RelativeSource</code>.  This is a source relative to the control in the <a href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/02-element-tree/">elements tree</a>
.  We&rsquo;ll specify two properties on the <code>RelativeSource</code>: the <code>Mode</code> which we set to <code>FindAncestor</code> to search up the tree, and the <code>AncestorType</code> which we set to our <code>NumberBox</code>.  Thus, instead of binding to the <code>DataContext</code>, we&rsquo;ll bind to the <code>NumberBox</code> the <code>&lt;TextBox&gt;</code> is located within.  The full declaration would be:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=Value, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=local:NumberBox}}&#34;</span><span style="color:#f92672">/&gt;</span></span></span></code></pre></div><p>Now a two-way binding exists between the <code>Value</code> of the <code>&lt;NumberBox&gt;</code> and the <code>Text</code> value of the textbox.  Updating either one will update the other.  We&rsquo;ve in effect made an editable control!</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="routed-events">Routed Events</h1>

<p>Another aspect of WPF elements are <em>routed events</em>.  Just as <em>dependency properties</em> are similar to regular C# properties, but add additional functionality, <em>routed events</em> are similar to regular C# events, but provide additional functionality.  One of the most important of these is the ability of the routed event to &ldquo;bubble&rdquo; up the <a href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/02-element-tree/">elements tree</a>
.  Essentially, the event will be passed up each successive WPF element until one chooses to &ldquo;handle&rdquo; it, or the top of the tree is reached (in which case the event is ignored).  This routed event functionality is managed by the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.uielement?view=netcore-3.1" target="_blank"><code>UIElement</code></a>
 base class, a third base class shared by all WPF elements.</p>
<p>Let&rsquo;s consider the two buttons we declared in our <code>&lt;NumberBox&gt;</code>.  When clicked, these each trigger a <code>Click</code> routed event.  We could attach a handler to each button, but it is also possible to instead attach it to any other element up the tree; for example, our <code>&lt;Grid&gt;</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;CustomDependencyObjectExample.NumberBox&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:CustomDependencyObjectExample&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;50&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Grid</span> <span style="color:#a6e22e">Button.Click=</span><span style="color:#e6db74">&#34;HandleButtonClick&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;2*&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;ColumnDefinition/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;Increment&#34;</span><span style="color:#f92672">&gt;</span>+<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBox</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=Value, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=local:NumberBox}}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Button</span> <span style="color:#a6e22e">Grid.Column=</span><span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;Decrement&#34;</span><span style="color:#f92672">&gt;</span>-<span style="color:#f92672">&lt;/Button&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Grid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div><p>We&rsquo;d need to define <code>HandleButtonClick</code> in our codebehind:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// Handles the click of the increment or decrement button</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;param name=&#34;sender&#34;&gt;The button clicked&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;param name=&#34;e&#34;&gt;The event arguments&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> HandleButtonClick(<span style="color:#66d9ef">object</span> sender, RoutedEventArgs e)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(sender <span style="color:#66d9ef">is</span> Button button)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">switch</span>(button.Name)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;Increment&#34;</span>:
</span></span><span style="display:flex;"><span>                Value += Step;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;Decrement&#34;</span>:
</span></span><span style="display:flex;"><span>                Value -= Step;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    e.Handled = <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>When either button is clicked, it creates a <code>Button.Click</code> event.  As the buttons don&rsquo;t handle it, the event bubbles to the next element in the elements tree - in this case, the <code>&lt;Grid&gt;</code>.  As the <code>&lt;Grid&gt;</code> <em>does</em> attach a <code>Button.Click</code> listener, the event is passed to <code>HandleButtonClick</code>.  In this method we use the button&rsquo;s <code>Name</code> property to decide the correct action to take.  Also, note that we set the <code>RoutedEventArgs.Handled</code> property to <code>true</code>.  This lets WPF know that we&rsquo;ve taken care of the event, and it does not need to bubble up any farther (if we didn&rsquo;t, we could process the event <em>again</em> further up the elements tree).</p>
<p>Much like dependency properties, we can declare our own routed events.  These also use a <code>Register()</code> method, but for events this is a static method of the <code>EventHandler</code> class:  <code>EventManger.Register(string eventName, RoutingStrategy routing, Type eventHandlerType, Type controlType)</code>.  The first argument is a string, which is the name of the event, the second is one of the values from the <code>RoutingStrategy</code> enum, the third is the type of event handler, and the fourth is the type of the control it is declared in.  This <code>Register()</code> method returns a <code>RoutedEvent</code> that is used as a key when registering event listeners, which we typically store in a <code>public static readonly RoutedEvent</code> field.</p>
<p>The <code>RoutingStrategy</code> options are</p>
<ul>
<li><code>RoutingStrategy.Bubble</code> - which travels up the elements tree through ancestor nodes</li>
<li><code>RoutingStrategy.Tunnel</code> - which travels down the elements tree through descendant nodes</li>
<li><code>RoutingStrategy.Direct</code> - which can only be handled by the source element</li>
</ul>
<p>Let&rsquo;s create an example routed event for our <code>NumberBox</code>.  Let&rsquo;s assume we define two more routed properties <code>MinValue</code> and <code>MaxValue</code>, and that any time we change the value of our <code>NumberBox</code> it must fall within this range, or be clamped to one of those values.  To make it easer for UI designers to provide user feedback, we&rsquo;ll create a <code>NumberBox.ValueClamped</code> event that will trigger in these circumstances.  We need to register our new routed event:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// Identifies the NumberBox.ValueClamped event</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">readonly</span> RoutedEvent ValueClampedEvent = EventManager.RegisterRoutedEvent(nameof(ValueClamped), RoutingStrategy.Bubble, <span style="color:#66d9ef">typeof</span>(RoutedEventHandler), <span style="color:#66d9ef">typeof</span>(NumberBox));</span></span></code></pre></div><p>Also like dependency properties also need to declare a corresponding C# property, routed events need to declare a corresponding C# event:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// Event that is triggered when the value of this NumberBox changes</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> RoutedEventHandler ValueClamped
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">add</span> { AddHandler(ValueClampedEvent, <span style="color:#66d9ef">value</span>); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">remove</span> { RemoveHandler(ValueClampedEvent, <span style="color:#66d9ef">value</span>); }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Finally, we would want to raise this event whenever the value is clamped.  This can be done with the <code>RaiseEvent(RoutedEventArgs)</code> method defined on the <code>UIElement</code> base class that we inherit in our custom controls.  But where should we place this call?</p>
<p>You might think we would do this in the <code>HandleButtonClick()</code> method, and we could, but that misses when a user types a number <em>directly into the textbox</em>, as well as when <code>Value</code> is updated through a two-way binding.  Instead, we&rsquo;ll utilize the callback functionality available in the <code>FrameworkPropertyMetadata</code> for the <code>Value</code> property.  Since the dependency property and its metadata are both <code>static</code>, our callback also needs to be declared <code>static</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// Callback for the ValueProperty, which clamps the Value to the range</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// defined by MinValue and MaxValue</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;param name=&#34;sender&#34;&gt;The NumberBox whose value is changing&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;param name=&#34;e&#34;&gt;The event args&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> HandleValueChanged(DependencyObject sender, DependencyPropertyChangedEventArgs e)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(e.Property.Name == <span style="color:#e6db74">&#34;Value&#34;</span> &amp;&amp; sender <span style="color:#66d9ef">is</span> NumberBox box)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(box.Value &lt; box.MinValue)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            box.Value = box.MinValue;
</span></span><span style="display:flex;"><span>            box.RaiseEvent(<span style="color:#66d9ef">new</span> RoutedEventArgs(ValueClampedEvent));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(box.Value &gt; box.MaxValue)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            box.Value = box.MaxValue;
</span></span><span style="display:flex;"><span>            box.RaiseEvent(<span style="color:#66d9ef">new</span> RoutedEventArgs(ValueClampedEvent));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Note that since this method is static, we must get the instance of the <code>NumberBox</code> by casting the <code>sender</code>.  We also double-check the property name, though this is not strictly necessary as the method is private and only we should be invoking it from within this class.</p>
<p>Now we need to refactor our <code>Value</code> dependency property registration to use this callback:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// Identifies the NumberBox.Value XAML attached property</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">readonly</span> DependencyProperty ValueProperty = DependencyProperty.Register(<span style="color:#e6db74">&#34;Value&#34;</span>, <span style="color:#66d9ef">typeof</span>(<span style="color:#66d9ef">double</span>), <span style="color:#66d9ef">typeof</span>(NumberBox), <span style="color:#66d9ef">new</span> FrameworkPropertyMetadata(<span style="color:#ae81ff">0</span>, FrameworkPropertyMetadataOptions.AffectsRender | FrameworkPropertyMetadataOptions.BindsTwoWayByDefault, HandleValueChanged));</span></span></code></pre></div><p>By adding the callback to the dependency property, we ensure that <em>any time it changes</em>, regardless of the method the change occurs by, we will ensure the value is clamped to the specified range.</p>
<p>There are additional options for dependency property callbacks, including validation callbacks and the ability to coerce values.  See <a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/dependency-property-callbacks-and-validation?view=netframeworkdesktop-4.8" target="_blank">the documentation</a>
 for details.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="mvvm-architecture">MVVM Architecture</h1>

<p>You have probably noticed that as our use of WPF grows more sophisticated, our controls start getting large, and often filled with complex logic.  You are not alone in noticing this trend.  Microsoft architects Ken Cooper and Ted Peters also struggled with the idea, and introduced a new software architectural pattern to help alleviate it: <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93viewmodel" target="_blank">Model-View-ViewModel</a>
.  This approach splits the user interface code into two classes: the View (the XAML + codebehind), and a ViewModel, which applies any logic needed to format the data from the model object into a form more easily bound and consumed by the view.</p>
<p>
<a href="#image-9a413f301f8acde95b2dffc5ec773768" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/MVVMPattern.png" alt="MVVM Pattern" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-9a413f301f8acde95b2dffc5ec773768">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/MVVMPattern.png" alt="MVVM Pattern" class="lightbox-image" loading="lazy">
</a></p>
<p>There are several benefits to this pattern:</p>
<ol>
<li>Complex logic is kept out of the View classes, allowing them to focus on the task of presentation</li>
<li>Presentation logic is kept out of the Model classes, allowing them to focus on the task of data management and allowing them to be easily re-used for other views</li>
<li>Presentation logic is gathered in the ViewModel class, where it can be easily tested</li>
</ol>
<p>Essentially, this pattern is an application of the <a href="https://en.wikipedia.org/wiki/Single-responsibility_principle" target="_blank">Single-Responsibility Principle</a>
 (that each class in your project should bear a single responsibility).</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="summary">Summary</h1>

<p>In this chapter we examined how dependency properties and routed events are implemented in WPF.  The <code>DependencyObject</code>, which serves as a base class for WPF elements, provides a collection of key/value pairs, where the key is a <code>DependencyProperty</code> and the value is the object it is set to.  This collection can be accessed through the <code>GetValue()</code> and <code>SetValue()</code> methods, and is also used as a backing store for regular C# properties.  We also saw that we can register callbacks on dependency properties to execute logic when the property is changed.  The <code>UIElement</code>, which also serves as a base class for WPF elements, provided similar functionality for registering routed event listeners, whose key is <code>RoutedEvent</code>.  We saw how these routed events could &ldquo;bubble&rdquo; up the elements tree, or &ldquo;tunnel&rdquo; down it, and how marking the event <code>Handled</code> property would stop it.  Finally, we discussed the MVVM architecture, which works well with WPF applications to keep our code manageable.</p>
<p>We also created an example control using these ideas.  The full project can be found <a href="https://github.com/ksu-cis/CustomDependencyObjectExample" target="_blank">here</a>
.</p>

            <footer class="footline">

            </footer>
          </article>

          </section>
    
    
          <article class="chapter">
            <header class="headline">
            </header>


<div class="article-subheading">Chapter 60</div>
<h1 id="testing-wpf">Testing WPF</h1>

<h3 id="chapter-6">Chapter 6</h3>
<h1 id="testing-wpf">Testing WPF</h1>
<p>How do we test this stuff?</p>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Testing WPF</h1>
    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="introduction">Introduction</h1>

<p>Now that you&rsquo;ve learned how to build a WPF application, how do you test that it is working?  For that matter, how do you test <em>any</em> GUI-based application?  In this chapter, we&rsquo;ll explore some common techniques used to test GUIs.  We&rsquo;ll also explore the MVVM architecture developed in parallel with WPF to make unit-testing WPF apps easier.</p>
<h2 id="key-terms">Key Terms</h2>
<p>Some key terms to learn in this chapter are:</p>
<ul>
<li>Test Plan</li>
<li>Model View ViewModel (MVVM) Architecture</li>
</ul>
<h2 id="key-skills">Key Skills</h2>
<p>Some key skills you need to develop in this chapter are:</p>
<ul>
<li>Writing and Using Test Plans</li>
<li>Structuring a GUI using the MVVM Approach</li>
</ul>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="testing-guis">Testing GUIs</h1>

<p>Testing a GUI-based application presents some serious challenges.  A GUI has a strong dependence on the environment it is running in - the operating system is ultimately responsible for displaying the GUI components, and this is also influenced by the hardware it runs on.  As we noted in our <a href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/01-wpf/02-wpf-features/">discussion of WPF</a>
, screen resolution can vary dramatically.  So how our GUI appears on one machine may be completely acceptable, but unusable on another.</p>
<p>For example, I once had an installer that used a fixed-size dialog that was so large, on my laptop the &ldquo;accept&rdquo; button was off-screen below the bottom of the screen - and there was no way to click it.  This is clearly a problem, but the developer failed to recognize it because on their development machine (with nice large monitors) everything fit!  So how do we test a GUI application in this uncertain environment?</p>
<p>One possibility is to fire the application up on as many different hardware platforms as we can, and check that each one performs acceptably.  This, of course, requires a <em>lot</em> of different computers, so increasingly we see companies instead turning to <em>virtual machines</em> - a program that <em>emulates</em> the hardware of a different computer, possibly even running a different operating system!  In either case, we need a way to go through a series of checks to ensure that on each platform, our application is usable.</p>
<p>How can we ensure rigor in this process?  Ideally we&rsquo;d like to automate it, just as we do with our Unit tests&hellip; and while there have been some steps in this direction, the honest truth is we&rsquo;re just not there yet.  Currently, there is no substitute for human eyes - and human judgement - on the problem.  But humans are also notorious for losing focus when doing the same thing repeatedly&hellip; which is exactly what this kind of testing <em>is</em>.  Thus, we develop <em>test plans</em> to help with this process.  We&rsquo;ll take a look at those next.</p>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="testing-plans">Testing Plans</h1>

<p>A testing plan is simply a step-by-step guide for a human tester to follow when testing software.  You may remember that we mentioned them back on our testing chapter&rsquo;s discussion on <a href="https://ksu-cs-textbooks.github.io/cis400/1-object-orientation/04-testing/02-manual-testing/">manual testing</a>
. Indeed, we can use a test plan to test <em>all</em> aspects of software, not just the GUI.  However, automated testing is usually cheaper and more effective in many aspects of software design, which is why we prefer it when possible.  So what does a GUI application testing plan look like?</p>
<p>It usually consists of a description of the test to perform, broken down into tasks, and populated with annotated screenshots.  Here is an example:</p>
<blockquote>
<ol>
<li>
<p>Launch the application</p>
</li>
<li>
<p>Select the &ldquo;Cowpoke Chili&rdquo; button from the &ldquo;Entrees&rdquo; menu</p>
</li>
</ol>
<p>
<a href="#image-2b97407cd8867d8856405b138f757efe" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.6.3.1.png" alt="The Cowpoke Chili Button" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-2b97407cd8867d8856405b138f757efe">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.6.3.1.png" alt="The Cowpoke Chili Button" class="lightbox-image" loading="lazy">
</a></p>
<p>The app should switch to a customization screen that looks like this:</p>
<p>
<a href="#image-f4a29a416247fc88fcf7336f38cc2fbf" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.6.3.2.png" alt="The Customize Cowpoke Chili Screen" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-f4a29a416247fc88fcf7336f38cc2fbf">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.6.3.2.png" alt="The Customize Cowpoke Chili Screen" class="lightbox-image" loading="lazy">
</a></p>
<p>There should be a checkbox for &ldquo;Cheese&rdquo;, &ldquo;Sour Cream&rdquo;, &ldquo;Green Onions&rdquo;, and &ldquo;Tortilla Strips&rdquo;</p>
<table>
  <tr>
    <th width=30>Initial</th>
    <th>Test Item</th>
  </tr>
  <tr>
    <td></td>
    <td>Cheese</td>
  </tr>
  <tr>
    <td></td>
    <td>Sour Cream</td>
  </tr>
  <tr>
    <td></td>
    <td>Green Onion</td>
  </tr>
  <tr>
    <td></td>
    <td>Tortilla Strips</td>
  </tr>
</table>
<p>A Cowpoke Chili entry should appear in the order, with a cost of $6.10</p>
<table>
  <tr>
    <th width=30>Initial</th>
    <th>Test Item</th>
  </tr>
  <tr>
    <td></td>
    <td>Chili Entry in the order</td>
  </tr>
  <tr>
    <td></td>
    <td>Price of $6.10</td>
  </tr>
</table>
<ol start="3">
<li>Uncheck the checkboxes, and a corresponding &ldquo;Hold&rdquo; detail should appear in the order, i.e. un-checking cheese should cause the order to look like:</li>
</ol>
<p>
<a href="#image-5fb22f9111c6e7a8a471ee439ecc166b" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.6.3.3.png" alt="Unchecked Cheese" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-5fb22f9111c6e7a8a471ee439ecc166b">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.6.3.3.png" alt="Unchecked Cheese" class="lightbox-image" loading="lazy">
</a></p>
<table>
  <tr>
    <th width=30>Initial</th>
    <th>Test Item</th>
  </tr>
  <tr>
    <td></td>
    <td>Cheese checkbox appears and functions</td>
  </tr>
  <tr>
    <td></td>
    <td>Sour Cream checkbox appears and functions</td>
  </tr>
  <tr>
    <td></td>
    <td>Green Onion checkbox appears and functions</td>
  </tr>
  <tr>
    <td></td>
    <td>Tortilla Strips checkbox appears and functions</td>
  </tr>
</table>
4. Click the "Menu Item Selection" Button.  This should return you to the main menu screen, with the order still containing the details about the Cowpoke Chili:
<p>
<a href="#image-ed66749c8cc0447964bbc68aac1f53d4" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.6.3.4.png" alt="Return to Main Menu" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-ed66749c8cc0447964bbc68aac1f53d4">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/2.6.3.4.png" alt="Return to Main Menu" class="lightbox-image" loading="lazy">
</a></p>
<table>
  <tr>
    <th width=30>Initial</th>
    <th>Test Item</th>
  </tr>
  <tr>
    <td></td>
    <td>Chili Entry in the order</td>
  </tr>
  <tr>
    <td></td>
    <td>Price of $6.10</td>
  </tr>
  <tr>
    <td></td>
    <td>with "Hold Cheese"</td>
  </tr>
  <tr>
    <td></td>
    <td>with "Hold Sour Cream"</td>
  </tr>
  <tr>
    <td></td>
    <td>with "Hold Green Onion"</td>
  </tr>
  <tr>
    <td></td>
    <td>with "Hold Tortilla Strips"</td>
  </tr>
</table>
<p>If you encountered problems with this test, please describe:</p>
</blockquote>
<p>The essential parts of the test plan are clear instructions of what the tester should do, and what they should see, and a mechanism for reporting issues.  Note the tables in this testing plan, where the tester can initial next to each &ldquo;passing&rdquo; test, as well as the area for describing issues at the bottom.  This reporting can either be integrated into the test document, or, it can be a separate form used with the test document (allowing the printed instructional part of the test documents to be reused).  Additionally, some test documents are created in spreadsheet software or specialized testing documentation software for ease of collection and processing.</p>
<p>Test plans like this one are then executed by people (often titled &ldquo;Tester&rdquo; or &ldquo;Software Tester&rdquo;) by opening the application, following the steps outlined in the plan, and documenting the results.  This documentation then goes back to the software developers so that they can address any issues found.</p>

  
  
<div class="box notices cstyle tip">
  <div class="box-label"><i class="fa-fw fas fa-lightbulb"></i> Tip</div>
  <div class="box-content">

<p>Taking screen shots of your running program is an easy way to quickly generate visuals for your testing documentation.</p>
<p>In Windows, <code>CTRL + SHIFT + ALT + PRINT SCREEN</code> takes a screen shot and copies it to the clipboard (from which you can paste it into a text editor of your choice).</p>
<p>On a Mac, you can take a screenshot with <code>COMMAND + SHIFT + 4</code>.  This launches a utility that changes the mouse cursor and allows you to drag a rectangle across a section of the screen.  When you release the mouse, a capture will be taken of the area, and saved as a picture to the desktop.</p>
</div>
</div>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="mvvm-architecture">MVVM Architecture</h1>

<p>Compared to automated tests, using a testing plan with human testers is both slow and expensive.  It should not be surprising then that Microsoft developers sought ways to shift as much of the testing burden for WPF projects to automated tests.  Their solution was to develop a new architectural approach known as <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93viewmodel" target="_blank">ModelView-View-Model</a>
.</p>
<p>
<a href="#image-33d9a2ff8b7844177f1ca30a313b7302" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/MVVMPattern.png" alt="MVVM Pattern" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-33d9a2ff8b7844177f1ca30a313b7302">
<img src="https://ksu-cs-textbooks.github.io/cis400/images/MVVMPattern.png" alt="MVVM Pattern" class="lightbox-image" loading="lazy">
</a></p>
<p>This approach expands upon the usual Model-View relationship in a GUI.  A <em>Model</em> class is a class that represents some data, i.e. a <code>Student</code>, and the View is the GUI exposing that object&rsquo;s data, i.e. a WPF <code>&lt;StudentControl&gt;</code>. Thus, we might have our <code>Student</code> class:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span> : INotifyPropertyChanged
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;Notifies when a property changes&lt;/summary&gt;        </span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> PropertyChangedEventHandler? PropertyChanged;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;The student&#39;s course-taking history&lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> List&lt;CourseRecord&gt; _courseRecords = <span style="color:#66d9ef">new</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;The student&#39;s first name&lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> FirstName { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">init</span>; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;The student&#39;s last name&lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> LastName { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">init</span>; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;The student&#39;s course records&lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;remarks&gt;We return a copy of the course records to prevent modifications&lt;/remarks&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> IEnumerable&lt;CourseRecord&gt; CourseRecords =&gt; _courseRecords.ToArray();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;The student&#39;s GPA&lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> GPA
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> points = <span style="color:#ae81ff">0.0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> hours = <span style="color:#ae81ff">0.0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">foreach</span> (<span style="color:#66d9ef">var</span> cr <span style="color:#66d9ef">in</span> CourseRecords)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                points += (<span style="color:#66d9ef">double</span>)cr.Grade * cr.CreditHours;
</span></span><span style="display:flex;"><span>                hours += cr.CreditHours;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> points / hours;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Adds &lt;paramref name=&#34;cr&#34;/&gt; to the students&#39; course history</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;cr&#34;&gt;The course record to add&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> AddCourseRecord(CourseRecord cr)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        _courseRecords.Add(cr);
</span></span><span style="display:flex;"><span>        PropertyChanged?.Invoke(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">new</span> PropertyChangedEventArgs(nameof(CourseRecords))); 
</span></span><span style="display:flex;"><span>        PropertyChanged?.Invoke(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">new</span> PropertyChangedEventArgs(nameof(GPA)));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Constructs the student object</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;firstName&#34;&gt;The student&#39;s first name&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;lastName&#34;&gt;The student&#39;s last name&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Student(<span style="color:#66d9ef">string</span> firstName, <span style="color:#66d9ef">string</span> lastName)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        FirstName = firstName;
</span></span><span style="display:flex;"><span>        LastName = lastName;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>And our <code>&lt;ComputerScienceStudentControl&gt;</code>:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;MvvmExample.ComputerScienceStudentControl&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:MvvmExample&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;300&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;StackPanel</span> <span style="color:#a6e22e">Orientation=</span><span style="color:#e6db74">&#34;Vertical&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;StackPanel</span> <span style="color:#a6e22e">Orientation=</span><span style="color:#e6db74">&#34;Horizontal&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">FontWeight=</span><span style="color:#e6db74">&#34;Bold&#34;</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;0,0,10,0&#34;</span><span style="color:#f92672">&gt;</span>Name<span style="color:#f92672">&lt;/TextBlock&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=FirstName}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=LastName}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;StackPanel</span> <span style="color:#a6e22e">Orientation=</span><span style="color:#e6db74">&#34;Horizontal&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;0,0,10,0&#34;</span> <span style="color:#a6e22e">FontWeight=</span><span style="color:#e6db74">&#34;Bold&#34;</span><span style="color:#f92672">&gt;</span>GPA<span style="color:#f92672">&lt;/TextBlock&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=GPA, StringFormat={}{0:N2}}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">FontWeight=</span><span style="color:#e6db74">&#34;Bold&#34;</span><span style="color:#f92672">&gt;</span>Course History<span style="color:#f92672">&lt;/TextBlock&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ListView</span> <span style="color:#a6e22e">ItemsSource=</span><span style="color:#e6db74">&#34;{Binding Path=CourseRecords}&#34;</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;2,0,2,0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/StackPanel&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div><p>Now, this control is simply a thin layer using data binding to connect it to the model class.  But what if we needed to add some complex logic?  Let&rsquo;s say we want to display the student&rsquo;s GPA calculated <em>for only their computer science courses</em>.  We could put this in the <code>Student</code> class, but if every department in the university added their own custom logic and properties to that class, it would get very bloated very quickly.  Instead, we might create a <code>&lt;ComputerScienceStudentControl&gt;</code> that would be used for this purpose, and compute the Computer Science GPA in its codebehind, but now we have complex logic that we&rsquo;d prefer to test using automated tests.</p>
<p>Instead, we could create <em>two</em> new classes, our <code>&lt;ComputerScienceStudentControl&gt;</code> (a new View), and a <code>ComputerScienceStudentViewModel</code> (a ViewModel), as well as our existing <code>Student</code> (the Model).</p>
<p>Our <code>ViewModel</code> can now incorporate the custom logic for calculating a students&rsquo; computer science GPA, as well holding a reference to the <code>Student</code> class it is computed from:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ComputerScienceStudentViewModel</span> : INotifyPropertyChanged
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The PropertyChanged event reports when properties change</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> PropertyChangedEventHandler? PropertyChanged;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The student this model represents</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;remarks&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// We require the student to be set in the constructor, and use </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// the init accessor to prevent changing out the student object</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/remarks&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Student Student { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">init</span>; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// THe first name of the student</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> FirstName =&gt; Student.FirstName;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The last name of the student</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> LastName =&gt; Student.LastName;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The course history of the student</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> IEnumerable&lt;CourseRecord&gt; CourseRecords =&gt; Student.CourseRecords;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The university GPA of the student</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> GPA =&gt; Student.GPA;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The student&#39;s Computer Science GPA</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> ComputerScienceGPA
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> points = <span style="color:#ae81ff">0.0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> hours = <span style="color:#ae81ff">0.0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">foreach</span> (<span style="color:#66d9ef">var</span> cr <span style="color:#66d9ef">in</span> Student.CourseRecords)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (cr.CourseName.Contains(<span style="color:#e6db74">&#34;CIS&#34;</span>))
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    points += (<span style="color:#66d9ef">double</span>)cr.Grade * cr.CreditHours;
</span></span><span style="display:flex;"><span>                    hours += cr.CreditHours;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> points / hours;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// An event handler for passing forward PropertyChanged events from the student object</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;sender&#34;&gt;The student object&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;e&#34;&gt;The eventargs describing the property that is changing&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> HandleStudentPropertyChanged(<span style="color:#66d9ef">object</span> sender, PropertyChangedEventArgs e)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">switch</span> (e.PropertyName)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Both first and last names map to properties of the same name,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// so we can reuse the PropertyChangedEventARgs</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> nameof(FirstName):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> nameof(LastName):
</span></span><span style="display:flex;"><span>                PropertyChanged?.Invoke(<span style="color:#66d9ef">this</span>, e);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// The Student.GPA maps to GPA, and changes to it may</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// also signal a change to the CIS GPA</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> nameof(Student.GPA):
</span></span><span style="display:flex;"><span>                PropertyChanged?.Invoke(<span style="color:#66d9ef">this</span>, e);
</span></span><span style="display:flex;"><span>                PropertyChanged?.Invoke(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">new</span> PropertyChangedEventArgs(nameof(ComputerScienceGPA)));
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// We don&#39;t care about any other properites of the Student, as they</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// are not present in this ViewModel, so ignore them</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">default</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Constructs a new ComputerScienceStudentViewModel, which wraps around the</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;paramref name=&#34;student&#34;/&gt; object and provides some additional functionality.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;student&#34;&gt;The student who is this view model&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> ComputerScienceStudentViewModel(Student student)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        Student = student;
</span></span><span style="display:flex;"><span>        Student.PropertyChanged += HandleStudentPropertyChanged;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>And a control to display it:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;UserControl</span> <span style="color:#a6e22e">x:Class=</span><span style="color:#e6db74">&#34;MvvmExample.StudentControl&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:x=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:mc=</span><span style="color:#e6db74">&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:d=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">xmlns:local=</span><span style="color:#e6db74">&#34;clr-namespace:MvvmExample&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">mc:Ignorable=</span><span style="color:#e6db74">&#34;d&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#a6e22e">d:DesignHeight=</span><span style="color:#e6db74">&#34;450&#34;</span> <span style="color:#a6e22e">d:DesignWidth=</span><span style="color:#e6db74">&#34;300&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;StackPanel</span> <span style="color:#a6e22e">Orientation=</span><span style="color:#e6db74">&#34;Vertical&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;StackPanel</span> <span style="color:#a6e22e">Orientation=</span><span style="color:#e6db74">&#34;Horizontal&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">FontWeight=</span><span style="color:#e6db74">&#34;Bold&#34;</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;0,0,10,0&#34;</span><span style="color:#f92672">&gt;</span>Name<span style="color:#f92672">&lt;/TextBlock&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=FirstName}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=LastName}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;StackPanel</span> <span style="color:#a6e22e">Orientation=</span><span style="color:#e6db74">&#34;Horizontal&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;0,0,10,0&#34;</span> <span style="color:#a6e22e">FontWeight=</span><span style="color:#e6db74">&#34;Bold&#34;</span><span style="color:#f92672">&gt;</span>GPA<span style="color:#f92672">&lt;/TextBlock&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=GPA, StringFormat={}{0:N2}}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/StackPanel&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">FontWeight=</span><span style="color:#e6db74">&#34;Bold&#34;</span><span style="color:#f92672">&gt;</span>Course History<span style="color:#f92672">&lt;/TextBlock&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;ListView</span> <span style="color:#a6e22e">ItemsSource=</span><span style="color:#e6db74">&#34;{Binding Path=CourseRecords}&#34;</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;2,0,2,0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/StackPanel&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/UserControl&gt;</span></span></span></code></pre></div><p>The <code>ComputerScienceViewModel</code> can then be used interchangeably with the <code>Student</code> model class, as both have the same properties (though the view model has one additional one). We could then either tweak the student control or create a new one that binds to this new property, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;StackPanel</span> <span style="color:#a6e22e">Orientation=</span><span style="color:#e6db74">&#34;Horizontal&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;0,0,10,0&#34;</span> <span style="color:#a6e22e">FontWeight=</span><span style="color:#e6db74">&#34;Bold&#34;</span><span style="color:#f92672">&gt;</span>Computer Science GPA<span style="color:#f92672">&lt;/TextBlock&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;TextBlock</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;{Binding Path=ComputerScienceGPA, StringFormat={}{0:N2}}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/StackPanel&gt;</span></span></span></code></pre></div><p>This represents just one of the ways a ViewModel can be used.  A View Model can also be leveraged to combine multiple data classes into a single object that can serve as a <code>DataContext</code>.  One can also be utilized to create a wrapper object around a web-based API or other data source to provide the ability to data bind that source to GUI controls.</p>
<p>Finally, because a ViewModel is simply another data class, it can be unit tested just like any other. This helps make sure that complex logic which we want thoroughly tested is not embedded in a GUI component, and simplifies our testing strategies.</p>

  
  
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>We&rsquo;ve really only scratched the surface of the MVVM architecture as it is used in WPF applications. In addition to providing properties to bind to, a WPF MVVM can also define <a href="https://learn.microsoft.com/en-us/archive/msdn-magazine/2013/may/mvvm-commands-relaycommands-and-eventtocommand" target="_blank">commands</a>
 that decouple event handlers from their effects.  When using commands, the GUI event handler simply signals the command, which is consumed by a ViewModel to perform the requested action.</p>
<p>Commands are outside the scope of this course, but you can refer to the Microsoft documentation and books from the O&rsquo;Riley Learning Library if you would like to explore this concept in more depth.</p>
</div>
</div>

            <footer class="footline">

            </footer>
          </article>

    
    
          <article class="default">
            <header class="headline">
            </header>
<h1 id="summary">Summary</h1>

<p>In this chapter we looked at some of the challenges of testing GUIs, and saw why most GUI applications are still manually tested.  We also explored the process of writing a <em>test plan</em>, a step-by-step process for a human tester to follow to provide rigor in the testing process.</p>
<p>We also explored the Model View ViewModel architecture in more depth, especially how it can allow us to move complex logic out of our GUI into a simple class that can be unit tested.</p>

            <footer class="footline">

            </footer>
          </article>

          </section>
          </section>

        </div>
      </main>
    
<div class="git-footer">
<p class="theme-version-footer">5.18.0</p>
<p>Last modified by: 
            <i class='fas fa-user'></i> Russell Feldhausen
            <i class='fas fa-calendar'></i> <a href="https://gitlab.cs.ksu.edu/cs-textbooks/cis400-textbook/-/commit/681e5c9c43e3ac6de614c2cc74487702fd43cab7">Aug 10, 2023</a>
</p>
</div>

    
    </div>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/clipboard.min.js?1710866805" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/perfect-scrollbar.min.js?1710866805" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/theme.js?1710866805" defer></script>
  </body>
</html>
