<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.128.0"><meta name=generator content="Relearn 6.0.0"><meta name=description content="Compared to automated tests, using a testing plan with human testers is both slow and expensive. It should not be surprising then that Microsoft developers sought ways to shift as much of the testing burden for WPF projects to automated tests. Their solution was to develop a new architectural approach known as Model-View-ViewModel.
This approach expands upon the usual Model-View relationship in a GUI. A Model class is a class that represents some data, i."><meta name=author content="Nathan Bean"><meta name=twitter:card content="summary"><meta name=twitter:title content="MVVM Architecture :: K-State CIS 400 Textbook"><meta name=twitter:description content="Compared to automated tests, using a testing plan with human testers is both slow and expensive. It should not be surprising then that Microsoft developers sought ways to shift as much of the testing burden for WPF projects to automated tests. Their solution was to develop a new architectural approach known as Model-View-ViewModel.
This approach expands upon the usual Model-View relationship in a GUI. A Model class is a class that represents some data, i."><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis400/2-desktop-development/06-testing-wpf/04-mvvm/"><meta property="og:site_name" content="K-State CIS 400 Textbook"><meta property="og:title" content="MVVM Architecture :: K-State CIS 400 Textbook"><meta property="og:description" content="Compared to automated tests, using a testing plan with human testers is both slow and expensive. It should not be surprising then that Microsoft developers sought ways to shift as much of the testing burden for WPF projects to automated tests. Their solution was to develop a new architectural approach known as Model-View-ViewModel.
This approach expands upon the usual Model-View relationship in a GUI. A Model class is a class that represents some data, i."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="Desktop Development"><meta property="article:published_time" content="2018-08-24T10:53:26-05:00"><meta property="article:modified_time" content="2024-03-26T10:58:56-05:00"><meta itemprop=name content="MVVM Architecture :: K-State CIS 400 Textbook"><meta itemprop=description content="Compared to automated tests, using a testing plan with human testers is both slow and expensive. It should not be surprising then that Microsoft developers sought ways to shift as much of the testing burden for WPF projects to automated tests. Their solution was to develop a new architectural approach known as Model-View-ViewModel.
This approach expands upon the usual Model-View relationship in a GUI. A Model class is a class that represents some data, i."><meta itemprop=datePublished content="2018-08-24T10:53:26-05:00"><meta itemprop=dateModified content="2024-03-26T10:58:56-05:00"><meta itemprop=wordCount content="1139"><title>MVVM Architecture :: K-State CIS 400 Textbook</title>
<link href=https://textbooks.cs.ksu.edu/cis400/2-desktop-development/06-testing-wpf/04-mvvm/ rel=canonical type=text/html title="MVVM Architecture :: K-State CIS 400 Textbook"><link href=/cis400/2-desktop-development/06-testing-wpf/04-mvvm/index.xml rel=alternate type=application/rss+xml title="MVVM Architecture :: K-State CIS 400 Textbook"><link href=/cis400/2-desktop-development/06-testing-wpf/04-mvvm/tele.html rel=alternate type=text/html title="MVVM Architecture :: K-State CIS 400 Textbook"><link href=/cis400/2-desktop-development/06-testing-wpf/04-mvvm/embed.html rel=alternate type=text/html title="MVVM Architecture :: K-State CIS 400 Textbook"><link href=/cis400/css/fontawesome-all.min.css?1719517096 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis400/css/fontawesome-all.min.css?1719517096 rel=stylesheet></noscript><link href=/cis400/css/nucleus.css?1719517096 rel=stylesheet><link href=/cis400/css/auto-complete.css?1719517096 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis400/css/auto-complete.css?1719517096 rel=stylesheet></noscript><link href=/cis400/css/perfect-scrollbar.min.css?1719517096 rel=stylesheet><link href=/cis400/css/fonts.css?1719517096 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis400/css/fonts.css?1719517096 rel=stylesheet></noscript><link href=/cis400/css/theme.css?1719517096 rel=stylesheet><link href=/cis400/css/theme-auto.css?1719517096 rel=stylesheet id=R-variant-style><link href=/cis400/css/chroma-auto.css?1719517096 rel=stylesheet id=R-variant-chroma-style><link href=/cis400/css/variant.css?1719517096 rel=stylesheet><link href=/cis400/css/print.css?1719517096 rel=stylesheet media=print><link href=/cis400/css/format-print.css?1719517096 rel=stylesheet><script src=/cis400/js/variant.js?1719517096></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../..",window.relearn.relBaseUri="../../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis400",window.index_js_url="/cis400/index.search.js",window.variants&&variants.init(["auto","light-theme","dark-theme"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><link href=/cis400/css/custom.css?1719517096 rel=stylesheet></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=/cis400/2-desktop-development/06-testing-wpf/04-mvvm/><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/cis400/2-desktop-development/><span itemprop=name>Desktop Development</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/cis400/2-desktop-development/06-testing-wpf/><span itemprop=name>Testing WPF</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>MVVM Architecture</span><meta itemprop=position content="3"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/cis400/2-desktop-development/06-testing-wpf/03-testing-plans/ title="Testing Plans (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/cis400/2-desktop-development/06-testing-wpf/05-summary/ title="Summary (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=mvvm-architecture>MVVM Architecture</h1><p>Compared to automated tests, using a testing plan with human testers is both slow and expensive. It should not be surprising then that Microsoft developers sought ways to shift as much of the testing burden for WPF projects to automated tests. Their solution was to develop a new architectural approach known as <a href=https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93viewmodel rel=external target=_blank>Model-View-ViewModel</a>.</p><p><a href=#R-image-37e1e18ae01dbe5ba144e3d87b867c5c class=lightbox-link><img alt="MVVM Pattern" class="border lazy lightbox noshadow figure-image" loading=lazy src=/cis400/images/MVVMPattern.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-37e1e18ae01dbe5ba144e3d87b867c5c><img alt="MVVM Pattern" class="border lazy lightbox noshadow lightbox-image" loading=lazy src=/cis400/images/MVVMPattern.png></a></p><p>This approach expands upon the usual Model-View relationship in a GUI. A <em>Model</em> class is a class that represents some data, i.e. a <code>Student</code>, and the View is the GUI exposing that object&rsquo;s data, i.e. a WPF <code>&lt;StudentControl></code>. Thus, we might have our <code>Student</code> class:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Student</span> <span class=p>:</span> <span class=n>INotifyPropertyChanged</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;Notifies when a property changes&lt;/summary&gt;        </span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>event</span> <span class=n>PropertyChangedEventHandler</span><span class=p>?</span> <span class=n>PropertyChanged</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;The student&#39;s course-taking history&lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>List</span><span class=p>&lt;</span><span class=n>CourseRecord</span><span class=p>&gt;</span> <span class=n>_courseRecords</span> <span class=p>=</span> <span class=k>new</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;The student&#39;s first name&lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>FirstName</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=k>init</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;The student&#39;s last name&lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>LastName</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=k>init</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;The student&#39;s course records&lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;remarks&gt;We return a copy of the course records to prevent modifications&lt;/remarks&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>IEnumerable</span><span class=p>&lt;</span><span class=n>CourseRecord</span><span class=p>&gt;</span> <span class=n>CourseRecords</span> <span class=p>=&gt;</span> <span class=n>_courseRecords</span><span class=p>.</span><span class=n>ToArray</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;The student&#39;s GPA&lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>double</span> <span class=n>GPA</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>get</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>points</span> <span class=p>=</span> <span class=m>0.0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>hours</span> <span class=p>=</span> <span class=m>0.0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>foreach</span> <span class=p>(</span><span class=kt>var</span> <span class=n>cr</span> <span class=k>in</span> <span class=n>CourseRecords</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>points</span> <span class=p>+=</span> <span class=p>(</span><span class=kt>double</span><span class=p>)</span><span class=n>cr</span><span class=p>.</span><span class=n>Grade</span> <span class=p>*</span> <span class=n>cr</span><span class=p>.</span><span class=n>CreditHours</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>hours</span> <span class=p>+=</span> <span class=n>cr</span><span class=p>.</span><span class=n>CreditHours</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>points</span> <span class=p>/</span> <span class=n>hours</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// Adds &lt;paramref name=&#34;cr&#34;/&gt; to the students&#39; course history</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;param name=&#34;cr&#34;&gt;The course record to add&lt;/param&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>AddCourseRecord</span><span class=p>(</span><span class=n>CourseRecord</span> <span class=n>cr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_courseRecords</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=n>cr</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>PropertyChanged</span><span class=p>?.</span><span class=n>Invoke</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=k>new</span> <span class=n>PropertyChangedEventArgs</span><span class=p>(</span><span class=n>nameof</span><span class=p>(</span><span class=n>CourseRecords</span><span class=p>)));</span> 
</span></span><span class=line><span class=cl>        <span class=n>PropertyChanged</span><span class=p>?.</span><span class=n>Invoke</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=k>new</span> <span class=n>PropertyChangedEventArgs</span><span class=p>(</span><span class=n>nameof</span><span class=p>(</span><span class=n>GPA</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// Constructs the student object</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;param name=&#34;firstName&#34;&gt;The student&#39;s first name&lt;/param&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;param name=&#34;lastName&#34;&gt;The student&#39;s last name&lt;/param&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Student</span><span class=p>(</span><span class=kt>string</span> <span class=n>firstName</span><span class=p>,</span> <span class=kt>string</span> <span class=n>lastName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>FirstName</span> <span class=p>=</span> <span class=n>firstName</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>LastName</span> <span class=p>=</span> <span class=n>lastName</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>And our <code>&lt;ComputerScienceStudentControl></code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;UserControl</span> <span class=na>x:Class=</span><span class=s>&#34;MvvmExample.ComputerScienceStudentControl&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns:x=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns:mc=</span><span class=s>&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span class=line><span class=cl>             <span class=na>xmlns:d=</span><span class=s>&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span> 
</span></span><span class=line><span class=cl>             <span class=na>xmlns:local=</span><span class=s>&#34;clr-namespace:MvvmExample&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>mc:Ignorable=</span><span class=s>&#34;d&#34;</span> 
</span></span><span class=line><span class=cl>             <span class=na>d:DesignHeight=</span><span class=s>&#34;450&#34;</span> <span class=na>d:DesignWidth=</span><span class=s>&#34;300&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;StackPanel</span> <span class=na>Orientation=</span><span class=s>&#34;Vertical&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;StackPanel</span> <span class=na>Orientation=</span><span class=s>&#34;Horizontal&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;TextBlock</span> <span class=na>FontWeight=</span><span class=s>&#34;Bold&#34;</span> <span class=na>Margin=</span><span class=s>&#34;0,0,10,0&#34;</span><span class=nt>&gt;</span>Name<span class=nt>&lt;/TextBlock&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;TextBlock</span> <span class=na>Text=</span><span class=s>&#34;{Binding Path=FirstName}&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;TextBlock</span> <span class=na>Text=</span><span class=s>&#34;{Binding Path=LastName}&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/StackPanel&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;StackPanel</span> <span class=na>Orientation=</span><span class=s>&#34;Horizontal&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;TextBlock</span> <span class=na>Margin=</span><span class=s>&#34;0,0,10,0&#34;</span> <span class=na>FontWeight=</span><span class=s>&#34;Bold&#34;</span><span class=nt>&gt;</span>GPA<span class=nt>&lt;/TextBlock&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;TextBlock</span> <span class=na>Text=</span><span class=s>&#34;{Binding Path=GPA, StringFormat={}{0:N2}}&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/StackPanel&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;TextBlock</span> <span class=na>FontWeight=</span><span class=s>&#34;Bold&#34;</span><span class=nt>&gt;</span>Course History<span class=nt>&lt;/TextBlock&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;ListView</span> <span class=na>ItemsSource=</span><span class=s>&#34;{Binding Path=CourseRecords}&#34;</span> <span class=na>Margin=</span><span class=s>&#34;2,0,2,0&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/StackPanel&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/UserControl&gt;</span></span></span></code></pre></div><p>Now, this control is simply a thin layer using data binding to connect it to the model class. But what if we needed to add some complex logic? Let&rsquo;s say we want to display the student&rsquo;s GPA calculated <em>for only their computer science courses</em>. We could put this in the <code>Student</code> class, but if every department in the university added their own custom logic and properties to that class, it would get very bloated very quickly. Instead, we might create a <code>&lt;ComputerScienceStudentControl></code> that would be used for this purpose, and compute the Computer Science GPA in its codebehind, but now we have complex logic that we&rsquo;d prefer to test using automated tests.</p><p>Instead, we could create <em>two</em> new classes, our <code>&lt;ComputerScienceStudentControl></code> (a new View), and a <code>ComputerScienceStudentViewModel</code> (a ViewModel), as well as our existing <code>Student</code> (the Model).</p><p>Our <code>ViewModel</code> can now incorporate the custom logic for calculating a students&rsquo; computer science GPA, as well holding a reference to the <code>Student</code> class it is computed from:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>ComputerScienceStudentViewModel</span> <span class=p>:</span> <span class=n>INotifyPropertyChanged</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// The PropertyChanged event reports when properties change</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>event</span> <span class=n>PropertyChangedEventHandler</span><span class=p>?</span> <span class=n>PropertyChanged</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// The student this model represents</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;remarks&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// We require the student to be set in the constructor, and use </span>
</span></span><span class=line><span class=cl>    <span class=cs>/// the init accessor to prevent changing out the student object</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;/remarks&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Student</span> <span class=n>Student</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=k>init</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// THe first name of the student</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>FirstName</span> <span class=p>=&gt;</span> <span class=n>Student</span><span class=p>.</span><span class=n>FirstName</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// The last name of the student</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>LastName</span> <span class=p>=&gt;</span> <span class=n>Student</span><span class=p>.</span><span class=n>LastName</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// The course history of the student</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>IEnumerable</span><span class=p>&lt;</span><span class=n>CourseRecord</span><span class=p>&gt;</span> <span class=n>CourseRecords</span> <span class=p>=&gt;</span> <span class=n>Student</span><span class=p>.</span><span class=n>CourseRecords</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// The university GPA of the student</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>double</span> <span class=n>GPA</span> <span class=p>=&gt;</span> <span class=n>Student</span><span class=p>.</span><span class=n>GPA</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// The student&#39;s Computer Science GPA</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>double</span> <span class=n>ComputerScienceGPA</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>get</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>points</span> <span class=p>=</span> <span class=m>0.0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>hours</span> <span class=p>=</span> <span class=m>0.0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>foreach</span> <span class=p>(</span><span class=kt>var</span> <span class=n>cr</span> <span class=k>in</span> <span class=n>Student</span><span class=p>.</span><span class=n>CourseRecords</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=n>cr</span><span class=p>.</span><span class=n>CourseName</span><span class=p>.</span><span class=n>Contains</span><span class=p>(</span><span class=s>&#34;CIS&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>points</span> <span class=p>+=</span> <span class=p>(</span><span class=kt>double</span><span class=p>)</span><span class=n>cr</span><span class=p>.</span><span class=n>Grade</span> <span class=p>*</span> <span class=n>cr</span><span class=p>.</span><span class=n>CreditHours</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>hours</span> <span class=p>+=</span> <span class=n>cr</span><span class=p>.</span><span class=n>CreditHours</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>points</span> <span class=p>/</span> <span class=n>hours</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// An event handler for passing forward PropertyChanged events from the student object</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;param name=&#34;sender&#34;&gt;The student object&lt;/param&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;param name=&#34;e&#34;&gt;The eventargs describing the property that is changing&lt;/param&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=k>void</span> <span class=n>HandleStudentPropertyChanged</span><span class=p>(</span><span class=kt>object</span> <span class=n>sender</span><span class=p>,</span> <span class=n>PropertyChangedEventArgs</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span> <span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>PropertyName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// Both first and last names map to properties of the same name,</span>
</span></span><span class=line><span class=cl>            <span class=c1>// so we can reuse the PropertyChangedEventARgs</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=n>nameof</span><span class=p>(</span><span class=n>FirstName</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=n>nameof</span><span class=p>(</span><span class=n>LastName</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>PropertyChanged</span><span class=p>?.</span><span class=n>Invoke</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=n>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=c1>// The Student.GPA maps to GPA, and changes to it may</span>
</span></span><span class=line><span class=cl>            <span class=c1>// also signal a change to the CIS GPA</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=n>nameof</span><span class=p>(</span><span class=n>Student</span><span class=p>.</span><span class=n>GPA</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>PropertyChanged</span><span class=p>?.</span><span class=n>Invoke</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=n>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>PropertyChanged</span><span class=p>?.</span><span class=n>Invoke</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=k>new</span> <span class=n>PropertyChangedEventArgs</span><span class=p>(</span><span class=n>nameof</span><span class=p>(</span><span class=n>ComputerScienceGPA</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=c1>// We don&#39;t care about any other properites of the Student, as they</span>
</span></span><span class=line><span class=cl>            <span class=c1>// are not present in this ViewModel, so ignore them</span>
</span></span><span class=line><span class=cl>            <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// Constructs a new ComputerScienceStudentViewModel, which wraps around the</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;paramref name=&#34;student&#34;/&gt; object and provides some additional functionality.</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;param name=&#34;student&#34;&gt;The student who is this view model&lt;/param&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>ComputerScienceStudentViewModel</span><span class=p>(</span><span class=n>Student</span> <span class=n>student</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Student</span> <span class=p>=</span> <span class=n>student</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>Student</span><span class=p>.</span><span class=n>PropertyChanged</span> <span class=p>+=</span> <span class=n>HandleStudentPropertyChanged</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>And a control to display it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;UserControl</span> <span class=na>x:Class=</span><span class=s>&#34;MvvmExample.StudentControl&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns:x=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns:mc=</span><span class=s>&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span class=line><span class=cl>             <span class=na>xmlns:d=</span><span class=s>&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span> 
</span></span><span class=line><span class=cl>             <span class=na>xmlns:local=</span><span class=s>&#34;clr-namespace:MvvmExample&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>mc:Ignorable=</span><span class=s>&#34;d&#34;</span> 
</span></span><span class=line><span class=cl>             <span class=na>d:DesignHeight=</span><span class=s>&#34;450&#34;</span> <span class=na>d:DesignWidth=</span><span class=s>&#34;300&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;StackPanel</span> <span class=na>Orientation=</span><span class=s>&#34;Vertical&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;StackPanel</span> <span class=na>Orientation=</span><span class=s>&#34;Horizontal&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;TextBlock</span> <span class=na>FontWeight=</span><span class=s>&#34;Bold&#34;</span> <span class=na>Margin=</span><span class=s>&#34;0,0,10,0&#34;</span><span class=nt>&gt;</span>Name<span class=nt>&lt;/TextBlock&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;TextBlock</span> <span class=na>Text=</span><span class=s>&#34;{Binding Path=FirstName}&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;TextBlock</span> <span class=na>Text=</span><span class=s>&#34;{Binding Path=LastName}&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/StackPanel&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;StackPanel</span> <span class=na>Orientation=</span><span class=s>&#34;Horizontal&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;TextBlock</span> <span class=na>Margin=</span><span class=s>&#34;0,0,10,0&#34;</span> <span class=na>FontWeight=</span><span class=s>&#34;Bold&#34;</span><span class=nt>&gt;</span>GPA<span class=nt>&lt;/TextBlock&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;TextBlock</span> <span class=na>Text=</span><span class=s>&#34;{Binding Path=GPA, StringFormat={}{0:N2}}&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/StackPanel&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;TextBlock</span> <span class=na>FontWeight=</span><span class=s>&#34;Bold&#34;</span><span class=nt>&gt;</span>Course History<span class=nt>&lt;/TextBlock&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;ListView</span> <span class=na>ItemsSource=</span><span class=s>&#34;{Binding Path=CourseRecords}&#34;</span> <span class=na>Margin=</span><span class=s>&#34;2,0,2,0&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/StackPanel&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/UserControl&gt;</span></span></span></code></pre></div><p>The <code>ComputerScienceViewModel</code> can then be used interchangeably with the <code>Student</code> model class, as both have the same properties (though the view model has one additional one). We could then either tweak the student control or create a new one that binds to this new property, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;StackPanel</span> <span class=na>Orientation=</span><span class=s>&#34;Horizontal&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;TextBlock</span> <span class=na>Margin=</span><span class=s>&#34;0,0,10,0&#34;</span> <span class=na>FontWeight=</span><span class=s>&#34;Bold&#34;</span><span class=nt>&gt;</span>Computer Science GPA<span class=nt>&lt;/TextBlock&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;TextBlock</span> <span class=na>Text=</span><span class=s>&#34;{Binding Path=ComputerScienceGPA, StringFormat={}{0:N2}}&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/StackPanel&gt;</span></span></span></code></pre></div><p>This represents just one of the ways a ViewModel can be used. A View Model can also be leveraged to combine multiple data classes into a single object that can serve as a <code>DataContext</code>. One can also be utilized to create a wrapper object around a web-based API or other data source to provide the ability to data bind that source to GUI controls.</p><p>Finally, because a ViewModel is simply another data class, it can be unit tested just like any other. This helps make sure that complex logic which we want thoroughly tested is not embedded in a GUI component, and simplifies our testing strategies.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>We&rsquo;ve really only scratched the surface of the MVVM architecture as it is used in WPF applications. In addition to providing properties to bind to, a WPF MVVM can also define <a href=https://learn.microsoft.com/en-us/archive/msdn-magazine/2013/may/mvvm-commands-relaycommands-and-eventtocommand rel=external target=_blank>commands</a> that decouple event handlers from their effects. When using commands, the GUI event handler simply signals the command, which is consumed by a ViewModel to perform the requested action.</p><p>Commands are outside the scope of this course, but you can refer to the Microsoft documentation and books from the O&rsquo;Riley Learning Library if you would like to explore this concept in more depth.</p></div></div><footer class=footline></footer></article></div></main><div class=git-footer><p class=theme-version-footer>6.0.0</p><p>Last modified by:
<i class='fas fa-user'></i> Julie Thornton
<i class='fas fa-calendar'></i> <a href=https://github.com/ksu-cs-textbooks/cis400/commit/063eeb3563f5a1ae4cf4c1f438fbbbf2cca9276a>Mar 26, 2024</a></p></div></div><script src=/cis400/js/clipboard.min.js?1719517096 defer></script><script src=/cis400/js/perfect-scrollbar.min.js?1719517096 defer></script><script src=/cis400/js/theme.js?1719517096 defer></script></body></html>