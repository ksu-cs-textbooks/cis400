<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.128.0"><meta name=generator content="Relearn 6.0.0"><meta name=description content="Our application is a tree?"><meta name=author content="Nathan Bean"><meta name=twitter:card content="summary"><meta name=twitter:title content="Exploring Elements :: K-State CIS 400 Textbook"><meta name=twitter:description content="Our application is a tree?"><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis400/2-desktop-development/02-element-tree/"><meta property="og:site_name" content="K-State CIS 400 Textbook"><meta property="og:title" content="Exploring Elements :: K-State CIS 400 Textbook"><meta property="og:description" content="Our application is a tree?"><meta property="og:locale" content="en-us"><meta property="og:type" content="website"><meta itemprop=name content="Exploring Elements :: K-State CIS 400 Textbook"><meta itemprop=description content="Our application is a tree?"><meta itemprop=datePublished content="2018-08-24T10:53:05-05:00"><meta itemprop=dateModified content="2023-08-10T15:29:34-05:00"><meta itemprop=wordCount content="5"><title>Exploring Elements :: K-State CIS 400 Textbook</title>
<link href=https://textbooks.cs.ksu.edu/cis400/2-desktop-development/02-element-tree/ rel=canonical type=text/html title="Exploring Elements :: K-State CIS 400 Textbook"><link href=/cis400/2-desktop-development/02-element-tree/index.xml rel=alternate type=application/rss+xml title="Exploring Elements :: K-State CIS 400 Textbook"><link href=/cis400/2-desktop-development/02-element-tree/tele.html rel=alternate type=text/html title="Exploring Elements :: K-State CIS 400 Textbook"><link href=/cis400/2-desktop-development/02-element-tree/embed.html rel=alternate type=text/html title="Exploring Elements :: K-State CIS 400 Textbook"><link href=/cis400/css/fontawesome-all.min.css?1724857971 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis400/css/fontawesome-all.min.css?1724857971 rel=stylesheet></noscript><link href=/cis400/css/nucleus.css?1724857971 rel=stylesheet><link href=/cis400/css/auto-complete.css?1724857971 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis400/css/auto-complete.css?1724857971 rel=stylesheet></noscript><link href=/cis400/css/perfect-scrollbar.min.css?1724857971 rel=stylesheet><link href=/cis400/css/fonts.css?1724857971 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis400/css/fonts.css?1724857971 rel=stylesheet></noscript><link href=/cis400/css/theme.css?1724857971 rel=stylesheet><link href=/cis400/css/theme-auto.css?1724857971 rel=stylesheet id=R-variant-style><link href=/cis400/css/chroma-auto.css?1724857971 rel=stylesheet id=R-variant-chroma-style><link href=/cis400/css/variant.css?1724857971 rel=stylesheet><link href=/cis400/css/print.css?1724857971 rel=stylesheet media=print><link href=/cis400/css/format-print.css?1724857971 rel=stylesheet><script src=/cis400/js/variant.js?1724857971></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../..",window.relearn.relBaseUri="../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis400",window.index_js_url="/cis400/index.search.js",window.variants&&variants.init(["auto","light-theme","dark-theme"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><link href=/cis400/css/custom.css?1724857971 rel=stylesheet></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=/cis400/2-desktop-development/02-element-tree/><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/cis400/2-desktop-development/><span itemprop=name>Desktop Development</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Exploring Elements</span><meta itemprop=position content="2"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/cis400/2-desktop-development/01-wpf/09-summary/ title="Summary (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/cis400/2-desktop-development/02-element-tree/01-introduction/ title="Introduction (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable chapter narrow" tabindex=-1><div class=flex-block-wrapper><article class=chapter><header class=headline></header><div class=article-subheading>Chapter 2</div><h1 id=exploring-elements>Exploring Elements</h1><p>Our application is a tree?</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Exploring Elements</h1><article class=default><header class=headline></header><h1 id=introduction>Introduction</h1><p>In the previous chapter, we introduced Windows Presentation Foundation and XAML, and discussed common layouts and controls, as well as some of the most common features of each of them. We also saw the concept of component-based design and explored its use. In this chapter, we&rsquo;ll take a deeper dive into how WPF and XAML structure GUIs into an <em>elements tree</em>, and some different ways we can leverage these features for greater control and customization in our programs.</p><h2 id=key-terms>Key Terms</h2><ul><li>The Elements Tree</li><li>Styles</li><li>Resources</li></ul><h2 id=c-keywords-and-elements>C# Keywords and Elements</h2><ul><li><code>&lt;Style></code></li><li><code>&lt;Setter></code></li><li><code>StaticResource</code></li></ul><h2 id=key-skills>Key Skills</h2><p>In this chapter, you should learn how to navigate the elements tree, declare styles to simplify styling your applications, and declare resources that can be bound to properties of controls.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=the-elements-tree>The Elements Tree</h1><p>Consider the <code>ShoppingList</code> class we developed in the last chapter:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;UserControl</span> <span class=na>x:Class=</span><span class=s>&#34;ShopEasy.ShoppingList&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns:x=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns:mc=</span><span class=s>&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span> 
</span></span><span class=line><span class=cl>             <span class=na>xmlns:d=</span><span class=s>&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span> 
</span></span><span class=line><span class=cl>             <span class=na>xmlns:local=</span><span class=s>&#34;clr-namespace:ShopEasy&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>mc:Ignorable=</span><span class=s>&#34;d&#34;</span> 
</span></span><span class=line><span class=cl>             <span class=na>d:DesignHeight=</span><span class=s>&#34;450&#34;</span> <span class=na>d:DesignWidth=</span><span class=s>&#34;200&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;DockPanel&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;TextBlock</span> <span class=na>DockPanel.Dock=</span><span class=s>&#34;Top&#34;</span> <span class=na>FontWeight=</span><span class=s>&#34;Bold&#34;</span> <span class=na>TextAlignment=</span><span class=s>&#34;Center&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            Shopping List For:
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/TextBlock&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;TextBox</span> <span class=na>DockPanel.Dock=</span><span class=s>&#34;Top&#34;</span> <span class=na>FontWeight=</span><span class=s>&#34;Bold&#34;</span> <span class=na>TextAlignment=</span><span class=s>&#34;Center&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>DockPanel.Dock=</span><span class=s>&#34;Bottom&#34;</span> <span class=na>Click=</span><span class=s>&#34;AddItemToList&#34;</span><span class=nt>&gt;</span>Add Item To List<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;TextBox</span> <span class=na>Name=</span><span class=s>&#34;itemTextBox&#34;</span> <span class=na>DockPanel.Dock=</span><span class=s>&#34;Bottom&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;ListView</span> <span class=na>Name=</span><span class=s>&#34;itemsListView&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/DockPanel&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/UserControl&gt;</span></span></span></code></pre></div><p>Each element in this XAML corresponds to an object of a specific Type, and the nesting of the elements implies a tree-like structure we call the <a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/trees-in-wpf?view=netframeworkdesktop-4.8" rel=external target=_blank><em>element tree</em></a>. We can draw this out as an actual tree:</p><p><a href=#R-image-9eab8893cbf6138c1ba46290e5b2bd5a class=lightbox-link><img alt="The elements tree for the ShoppingList component" class="border lazy lightbox noshadow figure-image" loading=lazy src=/cis400/images/2.2.2.1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9eab8893cbf6138c1ba46290e5b2bd5a><img alt="The elements tree for the ShoppingList component" class="border lazy lightbox noshadow lightbox-image" loading=lazy src=/cis400/images/2.2.2.1.png></a></p><p>The relationships in the tree are also embodied in the code. Each element has either a <code>Child</code> or <code>Children</code> property depending on if it can have just one or multiple children, and these are populated by the elements defined in the XAML. Thus, because the <code>&lt;DockPanel></code> has nested within it, a <code>&lt;TextBlock></code>, <code>&lt;TextBox></code>, <code>&lt;Button></code>, <code>&lt;TextBox></code>, and <code>&lt;ListView></code>, these are all contained in its <code>Children</code> Property. In turn, the <code>&lt;Button></code> element has text as a child, which is implemented as another <code>&lt;TextBlock></code>. Also, each component has a <code>Parent</code> property, which references the control that is its immediate parent.</p><p>In other words, all the WPF controls are effectively <em>nodes</em> in a <em>tree data structure</em>. We can modify this data structure by adding or removing nodes. This is exactly what happens in the <code>ListSwitcher</code> control - when you click the &ldquo;New List&rdquo; button, or the &ldquo;Prior&rdquo; or &ldquo;Next&rdquo; button, you are swapping the subtree that is the child of its <code>&lt;Border></code> element:</p><p><a href=#R-image-b98af20ad4c66c5eefebb17c465dc6ae class=lightbox-link><img alt="The elements tree for the ListSwitcher component" class="border lazy lightbox noshadow figure-image" loading=lazy src=/cis400/images/2.2.2.2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b98af20ad4c66c5eefebb17c465dc6ae><img alt="The elements tree for the ListSwitcher component" class="border lazy lightbox noshadow lightbox-image" loading=lazy src=/cis400/images/2.2.2.2.png></a></p><p>In fact, the entire application is one large tree of elements, with the <code>&lt;Application></code> as its root:</p><p><a href=#R-image-7d5c6bb44226c13c31b4c00e864d68ac class=lightbox-link><img alt="ShopEasy App element tree" class="border lazy lightbox noshadow figure-image" loading=lazy src=/cis400/images/2.2.2.3.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7d5c6bb44226c13c31b4c00e864d68ac><img alt="ShopEasy App element tree" class="border lazy lightbox noshadow lightbox-image" loading=lazy src=/cis400/images/2.2.2.3.png></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=navigating-the-tree>Navigating the Tree</h1><p>When you first learned about trees, you also learned about tree traversal algorithms. This is one reason that WPF is organized into a tree - the rendering process actually uses a tree traversal algorithm to determine how large to make each control!</p><p>You can also traverse the tree yourself, by exploring <code>Child</code>, <code>Children</code>, or <code>Parent</code> properties. For example, if we needed to gain access to the <code>ListSwitcher</code> from the <code>ShoppingList</code> in the previous example, you could reach it by invoking:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>   <span class=n>ListSwitcher</span> <span class=n>switcher</span> <span class=p>=</span> <span class=k>this</span><span class=p>.</span><span class=n>Parent</span><span class=p>.</span><span class=n>Parent</span><span class=p>.</span><span class=n>Parent</span> <span class=k>as</span> <span class=n>ListSwitcher</span><span class=p>;</span></span></span></code></pre></div><p>In this example, <code>this</code> is our <code>ShoppingList</code>, the first <code>Parent</code> is the <code>Border</code> containing the <code>ShoppingList</code>, the second <code>Parent</code> is the <code>Grid</code> containing that <code>Border</code>, and the third <code>Parent</code> is the actual <code>ListSwitcher</code>. We have to cast it to be a <code>ListSwitcher</code> because the type of the <code>Parent</code> property is a <code>DependencyObject</code> (a common base class of all controls).</p><p>Of course, this is a rather brittle way of finding an ancestor, because if we add any nodes to the element tree (perhaps move the <code>Grid</code> within a <code>DockPanel</code>), we&rsquo;ll need to rewrite it. It would be better to use a loop to iteratively climb the tree until we find the control we&rsquo;re looking for. This is greatly aided by the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.logicaltreehelper?view=netcore-3.1" rel=external target=_blank><code>LogicalTreeHelper</code></a> library, which provides standardized static methods for accessing parents and children in the elements tree:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=c1>// Start climbing the tree from this node</span>
</span></span><span class=line><span class=cl><span class=n>DependencyObject</span> <span class=n>parent</span> <span class=p>=</span> <span class=k>this</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>do</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Get this node&#39;s parent</span>
</span></span><span class=line><span class=cl>    <span class=n>parent</span> <span class=p>=</span> <span class=n>LogicalTreeHelper</span><span class=p>.</span><span class=n>GetParent</span><span class=p>(</span><span class=n>parent</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// Invariant: there is a parent element, and it is not a ListSwitcher </span>
</span></span><span class=line><span class=cl><span class=k>while</span><span class=p>(!(</span><span class=n>parent</span> <span class=k>is</span> <span class=kc>null</span> <span class=p>||</span> <span class=n>parent</span> <span class=k>is</span> <span class=n>ListSwitcher</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=c1>// If we get to this point, parent is either null, or the ListSwitcher we&#39;re looking for</span></span></span></code></pre></div><p>Searching the ancestors is a relatively easy task, as each node in the tree has only one parent. Searching the descendants takes more work, as each node may have many children, with children of their own.</p><p>This approach works well for complex applications with complex GUIs, where it is infeasible to keep references around. However, for our simple application here, it might make more sense to refactor the <code>ShoppingList</code> class to keep track of the <code>ListSwitcher</code> that created it, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Windows</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Windows.Controls</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>ShopEasy</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// Interaction logic for ShoppingList.xaml</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>partial</span> <span class=k>class</span> <span class=nc>ShoppingList</span> <span class=p>:</span> <span class=n>UserControl</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// The ListSwitcher that created this list</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>        <span class=kd>private</span> <span class=n>ListSwitcher</span> <span class=n>listSwitcher</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// Constructs a new ShoppingList</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>ShoppingList</span><span class=p>(</span><span class=n>ListSwitcher</span> <span class=n>listSwitcher</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>InitializeComponent</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=n>listSwitcher</span> <span class=p>=</span> <span class=n>listSwitcher</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// Adds the item in the itemTextBox to the itemsListView</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;param name=&#34;sender&#34;&gt;The object sending the event&lt;/param&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;param name=&#34;e&#34;&gt;The events describing the event&lt;/param&gt;</span>
</span></span><span class=line><span class=cl>        <span class=k>void</span> <span class=n>AddItemToList</span><span class=p>(</span><span class=kt>object</span> <span class=n>sender</span><span class=p>,</span> <span class=n>RoutedEventArgs</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// Make sure there&#39;s an item to add</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>itemTextBox</span><span class=p>.</span><span class=n>Text</span><span class=p>.</span><span class=n>Length</span> <span class=p>==</span> <span class=m>0</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=c1>// Add the item to the list</span>
</span></span><span class=line><span class=cl>            <span class=n>itemsListView</span><span class=p>.</span><span class=n>Items</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=n>itemTextBox</span><span class=p>.</span><span class=n>Text</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=c1>// Clear the text box</span>
</span></span><span class=line><span class=cl>            <span class=n>itemTextBox</span><span class=p>.</span><span class=n>Clear</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>However, this approach now tightly couples the <code>ListSwitcher</code> and <code>ShoppingList</code> - we can no longer use the <code>ShoppingList</code> for other contexts without a <code>ListSwitcher</code>.</p><p>If we instead employed the the traversal algorithm detailed above:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Windows</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Windows.Controls</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>ShopEasy</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// Interaction logic for ShoppingList.xaml</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>partial</span> <span class=k>class</span> <span class=nc>ShoppingList</span> <span class=p>:</span> <span class=n>UserControl</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// The ListSwitcher that created this list</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>        <span class=kd>private</span> <span class=n>ListSwitcher</span> <span class=n>listSwitcher</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>            <span class=k>get</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>DependencyObject</span> <span class=n>parent</span> <span class=p>=</span> <span class=k>this</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>do</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=c1>// Get this node&#39;s parent</span>
</span></span><span class=line><span class=cl>                    <span class=n>parent</span> <span class=p>=</span> <span class=n>LogicalTreeHelper</span><span class=p>.</span><span class=n>GetParent</span><span class=p>(</span><span class=n>parent</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=c1>// Invariant: there is a parent element, and it is not a ListSwitcher </span>
</span></span><span class=line><span class=cl>                <span class=k>while</span><span class=p>(!(</span><span class=n>parent</span> <span class=k>is</span> <span class=kc>null</span> <span class=p>||</span> <span class=n>parent</span> <span class=k>is</span> <span class=n>ListSwitcher</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>parent</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// Constructs a new ShoppingList</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>ShoppingList</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>InitializeComponent</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// Adds the item in the itemTextBox to the itemsListView</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;param name=&#34;sender&#34;&gt;The object sending the event&lt;/param&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;param name=&#34;e&#34;&gt;The events describing the event&lt;/param&gt;</span>
</span></span><span class=line><span class=cl>        <span class=k>void</span> <span class=n>AddItemToList</span><span class=p>(</span><span class=kt>object</span> <span class=n>sender</span><span class=p>,</span> <span class=n>RoutedEventArgs</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// Make sure there&#39;s an item to add</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>itemTextBox</span><span class=p>.</span><span class=n>Text</span><span class=p>.</span><span class=n>Length</span> <span class=p>==</span> <span class=m>0</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=c1>// Add the item to the list</span>
</span></span><span class=line><span class=cl>            <span class=n>itemsListView</span><span class=p>.</span><span class=n>Items</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=n>itemTextBox</span><span class=p>.</span><span class=n>Text</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=c1>// Clear the text box</span>
</span></span><span class=line><span class=cl>            <span class=n>itemTextBox</span><span class=p>.</span><span class=n>Clear</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>We could invoke the <code>listSwitcher</code> property to get the ancestor <code>ListSwitcher</code>. If this control is being used without one, the value will be <code>Null</code>.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=styling-the-tree>Styling the Tree</h1><p>Windows Presentation Foundation takes advantage of the elements tree in other ways. One of the big ones is for styling related elements. Let&rsquo;s say we are creating a calculator GUI:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;UserControl</span> <span class=na>x:Class=</span><span class=s>&#34;Calculator.Calculator&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>xmlns=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>xmlns:x=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>xmlns:d=</span><span class=s>&#34;http://schemas.microsoft.com/expression/blend/2008&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>xmlns:mc=</span><span class=s>&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>xmlns:local=</span><span class=s>&#34;clr-namespace:Calculator&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>mc:Ignorable=</span><span class=s>&#34;d&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>d:DesignWidth=</span><span class=s>&#34;450&#34;</span> <span class=na>d:DesignHeight=</span><span class=s>&#34;450&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Grid&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Grid.ColumnDefinitions&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;ColumnDefinition/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;ColumnDefinition/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;ColumnDefinition/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;ColumnDefinition/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/Grid.ColumnDefinitions&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Grid.RowDefinitions&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;RowDefinition/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;RowDefinition/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;RowDefinition/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;RowDefinition/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;RowDefinition/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/Grid.RowDefinitions&gt;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Grid.Column=</span><span class=s>&#34;0&#34;</span> <span class=na>Grid.Row=</span><span class=s>&#34;1&#34;</span><span class=nt>&gt;</span>7<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Grid.Column=</span><span class=s>&#34;1&#34;</span> <span class=na>Grid.Row=</span><span class=s>&#34;1&#34;</span><span class=nt>&gt;</span>8<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Grid.Column=</span><span class=s>&#34;2&#34;</span> <span class=na>Grid.Row=</span><span class=s>&#34;1&#34;</span><span class=nt>&gt;</span>9<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Grid.Column=</span><span class=s>&#34;0&#34;</span> <span class=na>Grid.Row=</span><span class=s>&#34;2&#34;</span><span class=nt>&gt;</span>4<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Grid.Column=</span><span class=s>&#34;1&#34;</span> <span class=na>Grid.Row=</span><span class=s>&#34;2&#34;</span><span class=nt>&gt;</span>5<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Grid.Column=</span><span class=s>&#34;2&#34;</span> <span class=na>Grid.Row=</span><span class=s>&#34;2&#34;</span><span class=nt>&gt;</span>6<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Grid.Column=</span><span class=s>&#34;0&#34;</span> <span class=na>Grid.Row=</span><span class=s>&#34;3&#34;</span><span class=nt>&gt;</span>1<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Grid.Column=</span><span class=s>&#34;1&#34;</span> <span class=na>Grid.Row=</span><span class=s>&#34;3&#34;</span><span class=nt>&gt;</span>2<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Grid.Column=</span><span class=s>&#34;2&#34;</span> <span class=na>Grid.Row=</span><span class=s>&#34;3&#34;</span><span class=nt>&gt;</span>3<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Grid.Column=</span><span class=s>&#34;0&#34;</span> <span class=na>Grid.Row=</span><span class=s>&#34;4&#34;</span> <span class=na>Grid.ColumnSpan=</span><span class=s>&#34;3&#34;</span><span class=nt>&gt;</span>0<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Grid.Column=</span><span class=s>&#34;3&#34;</span> <span class=na>Grid.Row=</span><span class=s>&#34;1&#34;</span><span class=nt>&gt;</span>+<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Grid.Column=</span><span class=s>&#34;3&#34;</span> <span class=na>Grid.Row=</span><span class=s>&#34;2&#34;</span><span class=nt>&gt;</span>-<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Grid.Column=</span><span class=s>&#34;3&#34;</span> <span class=na>Grid.Row=</span><span class=s>&#34;3&#34;</span><span class=nt>&gt;</span>*<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Grid.Column=</span><span class=s>&#34;3&#34;</span> <span class=na>Grid.Row=</span><span class=s>&#34;4&#34;</span><span class=nt>&gt;</span>/<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Grid&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Window&gt;</span></span></span></code></pre></div><p>Once we have the elements laid out, we realize the text of the buttons is too small. Fixing this would mean setting the <code>FontSize</code> property of each <code>&lt;Button></code>. That&rsquo;s a lot of repetitive coding.</p><p>Thankfully, the XAML developers anticipated this kind of situation, and allow us to attach a <code>&lt;Style></code> resource to the control. We typically would do this above the controls we want to style - in this case, either on the <code>&lt;Grid></code> or the <code>&lt;UserControl></code>. If we were to attach it to the <code>&lt;Grid></code>, we&rsquo;d declare a <code>&lt;Grid.Resources></code> property, and inside it, a <code>&lt;Style></code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;Grid.Resources&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Style&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Style&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Grid.Resources&gt;</span></span></span></code></pre></div><p>The <code>&lt;Style></code> element allows us to specify a <code>TargetType</code> property, which is the Type we want the style to apply to - in this case <code>"Button"</code>. Inside the <code>&lt;Style></code> element, we declare <code>&lt;Setter></code> elements, which need <code>Property</code> and <code>Value</code> attributes. As you might guess from the names, the <code>&lt;Setter></code> will set the specified property to the specified value on each element of the target type.</p><p>Therefore, if we use:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;Grid.Resources&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Style</span> <span class=na>TargetType=</span><span class=s>&#34;Button&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Setter</span> <span class=na>Property=</span><span class=s>&#34;FontSize&#34;</span> <span class=na>Value=</span><span class=s>&#34;40&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Style&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Grid.Resources&gt;</span></span></span></code></pre></div><p>The result will be that all buttons that are children of the <code>&lt;Grid></code> will have their <code>FontSize</code> set to <code>40</code> device-independent pixels. We don&rsquo;t need to add a separate <code>FontSize="40"</code> to each one! However, if we add <code>FontSize="50"</code> to a single button, that button alone will have a slightly larger font.</p><p>We can declare as many <code>&lt;Setters></code> as we want in a <code>&lt;Style></code> element, and as many <code>&lt;Style></code> elements as we want in a <code>&lt;.Resources></code> element. Moreover, styles apply to all children in the elements tree. Closer setters override those farther up the tree, and setting the property directly on an element always gives the final say.</p><p>Thus, we might put application-wide styles directly in our <code>MainWindow</code> using <code>&lt;Window.Resources></code>, and override those further down the elements tree when we want a different behavior.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>You may notice some similarities between <code>&lt;Style></code> elements and the <em>cascading style sheets (css)</em> of web technologies. This is not surprising, as the styling approach used in WPF was inspired by CSS, much as XAML drew inspiration from HTML. However, the implementation details are necessarily different, as XAML is effectively declaring C# objects. Hence, the use of &lsquo;setters&rsquo; to set &lsquo;properties&rsquo; to a specific &lsquo;value&rsquo;.</p></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=resources>Resources</h1><p>The <code>&lt;Style></code> element represents just one kind of resource. We can provide other kinds of resources, like raw data. Say we want to provide a string to display in our program, but want that string declared somewhere easy to find and change (perhaps our customers change their mind frequently). We could declare the string in the <code>Application</code> resources:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;Application</span> <span class=na>x:Class=</span><span class=s>&#34;WpfTutorialSamples.App&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns:x=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns:sys=</span><span class=s>&#34;clr-namespace:System;assembly=mscorlib&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>StartupUri=</span><span class=s>&#34;WPF application/ExtendedResourceSample.xaml&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Application.Resources&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;sys:String</span> <span class=na>x:Key=</span><span class=s>&#34;StringToDisplay&#34;</span><span class=nt>&gt;</span>Hello World!<span class=nt>&lt;/sys:String&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Application.Resources&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Application&gt;</span></span></span></code></pre></div><p>Then, in our actual control we can use that string as a <em>static resource</em>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;TextBlock</span> <span class=na>Text=</span><span class=s>&#34;{StaticResource StringToDisplay}&#34;</span><span class=nt>&gt;</span></span></span></code></pre></div><p>As long as that element is a descendant of the element the resource is declared on, it will be used in the property. In this case, we&rsquo;ll display the string &ldquo;Hello World!&rdquo; in the <code>TextBlock</code>. Note that we have to use the <code>x:Key</code> property to identify the resource, and repeat the key in the <code>"{StaticResource StringToDisplay}"</code>. The curly braces and the <code>StaticResource</code> both need to be there (technically, they are setting up a <em>data binding</em>, which we&rsquo;ll talk about in a future chapter).</p><p>We can declare any kind of type as a resource and make it available in our XAML this way.</p><p>For example, we could create a <code>LinearGradientBrush</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;Application</span> <span class=na>x:Class=</span><span class=s>&#34;WpfTutorialSamples.App&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns:x=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns:sys=</span><span class=s>&#34;clr-namespace:System;assembly=mscorlib&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>StartupUri=</span><span class=s>&#34;WPF application/ExtendedResourceSample.xaml&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Application.Resources&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;LinearGradientBrush</span> <span class=na>x:Key=</span><span class=s>&#34;Rainbow&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;LinearGradientBrush.GradientStops&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;GradientStop</span> <span class=na>Color=</span><span class=s>&#34;Red&#34;</span> <span class=na>Offset=</span><span class=s>&#34;0.0&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;GradientStop</span> <span class=na>Color=</span><span class=s>&#34;Yellow&#34;</span> <span class=na>Offset=</span><span class=s>&#34;0.25&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;GradientStop</span> <span class=na>Color=</span><span class=s>&#34;Green&#34;</span> <span class=na>Offset=</span><span class=s>&#34;0.50&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;GradientStop</span> <span class=na>Color=</span><span class=s>&#34;Blue&#34;</span> <span class=na>Offset=</span><span class=s>&#34;0.75&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;GradientStop</span> <span class=na>Color=</span><span class=s>&#34;Violet&#34;</span> <span class=na>Offset=</span><span class=s>&#34;1.0&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;/LinearGradientBrush.GradientStops&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/LinearGradientBrush&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Application.Resources&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Application&gt;</span></span></span></code></pre></div><p>And then use it as a <code>Background</code> or <code>Foreground</code> property in our controls:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;Grid</span> <span class=na>Background=</span><span class=s>&#34;{StaticResource Rainbow}&#34;</span><span class=nt>&gt;</span></span></span></code></pre></div><p>Since it is only defined in one place, it is now easier to reuse, and if we ever need to change it, we only need to change it in one location.</p><p>Finally, we can create static resources from images and other media. First, we have to set its build action to &ldquo;Resource&rdquo; in the <strong>&ldquo;Properties&rdquo;</strong> window after adding it to our project:</p><p><a href=#R-image-2425c6607d5be3954c5e9a207ffeb4cc class=lightbox-link><img alt="Setting the image properties" class="border lazy lightbox noshadow figure-image" loading=lazy src=/cis400/images/2.2.5.1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2425c6607d5be3954c5e9a207ffeb4cc><img alt="Setting the image properties" class="border lazy lightbox noshadow lightbox-image" loading=lazy src=/cis400/images/2.2.5.1.png></a></p><p>Then we can declare a <code>&lt;BitmapImage></code> resource using a <code>UriSource</code> property that matches the path to the image within our project:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;Application</span> <span class=na>x:Class=</span><span class=s>&#34;WpfTutorialSamples.App&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns:x=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>xmlns:sys=</span><span class=s>&#34;clr-namespace:System;assembly=mscorlib&#34;</span>
</span></span><span class=line><span class=cl>             <span class=na>StartupUri=</span><span class=s>&#34;WPF application/ExtendedResourceSample.xaml&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Application.Resources&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;BitmapImage</span> <span class=na>x:Key=</span><span class=s>&#34;MountainImage&#34;</span> <span class=na>UriSource=</span><span class=s>&#34;Images/mountains.jpg&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Applicaton.Resources&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Application&gt;</span></span></span></code></pre></div><p>And then we can use this as the <code>ImageSource</code> for an <code>ImageBrush</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;Grid&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Grid.Background&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;ImageBrush</span> <span class=na>ImageSource=</span><span class=s>&#34;{StaticResource MountainImage}&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Grid.Background&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Grid&gt;</span></span></span></code></pre></div><p>The benefit of using images and other media as resources is that they are <em>compiled into the binary assembly</em> (the <em>.dll</em> or <em>.exe</em> file). This means they don&rsquo;t need to be copied separately when we distribute our application.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=templates>Templates</h1><p>Most WPF controls are themselves composed of multiple, simpler, controls. For example, a <code>&lt;Button></code> is composed of a <code>&lt;Border></code> and whatever content you place inside the button. A simplified version of this structure appears below (I removed the styling information and the <code>VisualState</code> components responsible for presenting the button differently when it is enabled, disabled, hovered on, or clicked):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;Border</span> <span class=na>TextBlock.Foreground=</span><span class=s>&#34;{TemplateBinding Foreground}&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>x:Name=</span><span class=s>&#34;Border&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>CornerRadius=</span><span class=s>&#34;2&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>BorderThickness=</span><span class=s>&#34;1&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;Border.BorderBrush&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;LinearGradientBrush</span> <span class=na>StartPoint=</span><span class=s>&#34;0,0&#34;</span>
</span></span><span class=line><span class=cl>                          <span class=na>EndPoint=</span><span class=s>&#34;0,1&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;LinearGradientBrush.GradientStops&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;GradientStopCollection&gt;</span>
</span></span><span class=line><span class=cl>          <span class=nt>&lt;GradientStop</span> <span class=na>Color=</span><span class=s>&#34;{DynamicResource BorderLightColor}&#34;</span>
</span></span><span class=line><span class=cl>                        <span class=na>Offset=</span><span class=s>&#34;0.0&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>          <span class=nt>&lt;GradientStop</span> <span class=na>Color=</span><span class=s>&#34;{DynamicResource BorderDarkColor}&#34;</span>
</span></span><span class=line><span class=cl>                        <span class=na>Offset=</span><span class=s>&#34;1.0&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/GradientStopCollection&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;/LinearGradientBrush.GradientStops&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/LinearGradientBrush&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/Border.BorderBrush&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;Border.Background&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;LinearGradientBrush</span> <span class=na>EndPoint=</span><span class=s>&#34;0.5,1&#34;</span>
</span></span><span class=line><span class=cl>                          <span class=na>StartPoint=</span><span class=s>&#34;0.5,0&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;GradientStop</span> <span class=na>Color=</span><span class=s>&#34;{DynamicResource ControlLightColor}&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=na>Offset=</span><span class=s>&#34;0&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;GradientStop</span> <span class=na>Color=</span><span class=s>&#34;{DynamicResource ControlMediumColor}&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=na>Offset=</span><span class=s>&#34;1&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/LinearGradientBrush&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/Border.Background&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;ContentPresenter</span> <span class=na>Margin=</span><span class=s>&#34;2&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=na>HorizontalAlignment=</span><span class=s>&#34;Center&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=na>VerticalAlignment=</span><span class=s>&#34;Center&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=na>RecognizesAccessKey=</span><span class=s>&#34;True&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Border&gt;</span></span></span></code></pre></div><p>This has some implications for working with the control - for example, if you wanted to add rounded corners to the <code>&lt;Button></code>, they would actually need to be added to the <code>&lt;Border></code> <em>inside</em> the button. This can be done by nesting styles, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;Grid&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Grid.Resources&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Style</span> <span class=na>TargetType=</span><span class=s>&#34;Button&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;Style.Resources&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;Style</span> <span class=na>TargetType=</span><span class=s>&#34;Border&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&lt;Setter</span> <span class=na>Property=</span><span class=s>&#34;CornerRadius&#34;</span> <span class=na>Value=</span><span class=s>&#34;25&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;/Style&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;/Style.Resources&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/Style&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Grid.Resources&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Button&gt;</span>I have rounded corners now!<span class=nt>&lt;/Button&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Grid&gt;</span></span></span></code></pre></div><p>Note how the <code>&lt;Style></code> targeting the <code>&lt;Border></code> is <em>nested inside the <code>Resources</code></em> of the <code>&lt;Style></code> targeting the <code>&lt;Button></code>? This means that the style rules for the <code>&lt;Border></code> will only be applied to <code>&lt;Border></code> elements that are part of a <code>&lt;Button></code>.</p><h3 id=templates>Templates</h3><p>Above I listed a simplified version of the XAML used to create a button. The full listing can be found <a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/controls/button-styles-and-templates?view=netframeworkdesktop-4.8#button-controltemplate-example" target=_blank>in the Microsoft Documentation</a></p><p>What&rsquo;s more, you can <em>replace</em> this standard rendering in your controls by replacing the <code>Template</code> property. For example, we could replace our button with a super-simple rounded <code>&lt;Border></code> that nested a <code>&lt;TextBlock></code> that does word-wrapping of the button content:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;Button&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Button.Template&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;ControlTemplate&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;Border</span> <span class=na>CornerRadius=</span><span class=s>&#34;25&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;TextBlock</span> <span class=na>TextWrapping=</span><span class=s>&#34;Wrap&#34;</span><span class=nt>&gt;</span>  
</span></span><span class=line><span class=cl>                    <span class=nt>&lt;ContentPresenter</span> <span class=na>Margin=</span><span class=s>&#34;2&#34;</span>
</span></span><span class=line><span class=cl>                        <span class=na>HorizontalAlignment=</span><span class=s>&#34;Center&#34;</span>
</span></span><span class=line><span class=cl>                        <span class=na>VerticalAlignment=</span><span class=s>&#34;Center&#34;</span>
</span></span><span class=line><span class=cl>                        <span class=na>RecognizesAccessKey=</span><span class=s>&#34;True&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;/TextBlock&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;/Border&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/ControlTemplate&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Button.ControlTemplate&gt;</span>
</span></span><span class=line><span class=cl>    This is a simple button!
</span></span><span class=line><span class=cl><span class=nt>&lt;/Button&gt;</span></span></span></code></pre></div><p>The <code>&lt;ContentPresenter></code> is what presents the <em>content</em> nested inside the button - in this case, the text <code>This is a simple button!</code>. Of course, this super-simple button will not change its appearance when you hover over it or click it, or when it is disabled. But it helps convey the idea of a <code>&lt;ControlTemplate></code>. As with any other property, you can also set the <code>Template</code> property of a control using a <code>&lt;Setter></code> within a <code>&lt;Style></code> targeting that element.</p><p>If you only need a simple tweak - like applying word-wrapping to the text of a button, it often makes more sense to supply as content a control that will do so, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=p>&lt;</span><span class=n>Button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=n>TextBlock</span> <span class=n>TextWrapping</span><span class=p>=</span><span class=s>&#34;Wrap&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=n>I</span> <span class=n>also</span> <span class=n>wrap</span> <span class=n>text</span><span class=p>!</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=n>TextBlock</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=n>Button</span><span class=p>&gt;</span></span></span></code></pre></div><p>This allows the <code>&lt;Button></code> to continue to use the default <code>ControlTemplate</code> while providing the desired word-wrapping with a minimum of extra code.</p><p>A similar idea appears with <code>&lt;DataTemplate></code>, which allows you to customize how bound data is displayed in a control. For example, we often want to display the items in a <code>&lt;ListBox></code> in a different way than the default (a <code>&lt;TextBlock></code> with minimal styling). We&rsquo;ll visit this in the upcoming <a href=https://textbooks.cs.ksu.edu/cis400/2-desktop-development/04-data-binding/04-binding-lists/ rel=external target=_blank>binding lists</a> section.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=summary>Summary</h1><p>In this chapter, we saw how WPF applications are organized into a tree of controls. Moreover, we discussed how WPF uses this tree to perform its layout and rendering calculations. We also saw how we can traverse this tree in our programs to find parent or child elements of a specific type.</p><p>In addition, we saw how declaring <em>resources</em> at a specific point in the tree makes them available to all elements descended from that node. The resources we looked at included <code>&lt;Style></code> elements, which allow us to declare setters for properties of a specific type of element, to apply consistent styling rules.</p><p>We also saw how we could declare resources with a <code>x:Key</code> property, and bind them as static resources to use in our controls - including strings and other common types. Building on that idea, we saw how we could embed images and other media files as resources.</p><p>We also explored how <code>&lt;ControlTemplates></code> are used to compose complex controls from simpler controls, and make it possible to swap out that implementation for a custom one. We also briefly discussed when it may make more sense to compose the <em>content</em> of a control differently to get the same effect.</p><p>When we explore events and data binding in later chapters, we will see how these concepts <em>also</em> interact with the element tree in novel ways.</p><footer class=footline></footer></article></section></div></main><div class=git-footer><p class=theme-version-footer>6.0.0</p><p>Last modified by:
<i class='fas fa-user'></i> Russell Feldhausen
<i class='fas fa-calendar'></i> <a href=https://github.com/ksu-cs-textbooks/cis400/commit/681e5c9c43e3ac6de614c2cc74487702fd43cab7>Aug 10, 2023</a></p></div></div><script src=/cis400/js/clipboard.min.js?1724857971 defer></script><script src=/cis400/js/perfect-scrollbar.min.js?1724857971 defer></script><script src=/cis400/js/theme.js?1724857971 defer></script></body></html>