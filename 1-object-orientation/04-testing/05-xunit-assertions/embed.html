




	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		
		

	
	
		

	
	
		
		
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.117.0">
    <meta name="generator" content="Relearn 5.18.0">
    <meta name="description" content="K-State CIS 400 Textbook">
    <meta name="author" content="Nathan Bean">
    <title>xUnit Assertions :: K-State CIS 400 Textbook</title>
    <link href="https://ksu-cs-textbooks.github.io/cis400/1-object-orientation/04-testing/05-xunit-assertions/index.html" rel="canonical" type="text/html" title="xUnit Assertions :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/1-object-orientation/04-testing/05-xunit-assertions/index.xml" rel="alternate" type="application/rss+xml" title="xUnit Assertions :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/1-object-orientation/04-testing/05-xunit-assertions/index.print.html" rel="alternate" type="text/html" title="xUnit Assertions :: K-State CIS 400 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis400/1-object-orientation/04-testing/05-xunit-assertions/tele.html" rel="alternate" type="text/html" title="xUnit Assertions :: K-State CIS 400 Textbook">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/fontawesome-all.min.css?1692653134" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/fontawesome-all.min.css?1692653134" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/nucleus.css?1692653134" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/auto-complete.css?1692653134" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/auto-complete.css?1692653134" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/perfect-scrollbar.min.css?1692653134" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/fonts.css?1692653134" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis400/css/fonts.css?1692653134" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/theme.css?1692653134" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/theme-auto.css?1692653134" rel="stylesheet" id="variant-style">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/variant.css?1692653134" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/print.css?1692653134" rel="stylesheet" media="print">
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/ie.css?1692653134" rel="stylesheet">
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/url.js?1692653134"></script>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/variant.js?1692653134"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="https://ksu-cs-textbooks.github.io/cis400/index.search.js";
      var root_url="https://ksu-cs-textbooks.github.io/cis400/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/ksu-cs-textbooks.github.io\/cis400/';
      window.variants && variants.init( [ 'auto', 'light-theme', 'dark-theme' ] );
    </script>
    
    <link href="https://ksu-cs-textbooks.github.io/cis400/css/custom.css?1692653134" rel="stylesheet">

  </head>
  <body class="mobile-support embed disableInlineCopyToClipboard" data-url="https://ksu-cs-textbooks.github.io/cis400/1-object-orientation/04-testing/05-xunit-assertions/embed.html">
    <div id="body" class="default-animation">
      
      
      
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
    
    
    
<p>Like most testing frameworks, the xUnit framework provides a host of specialized assertions.</p>
<h2 id="boolean-assertions">Boolean Assertions</h2>
<p>For example, xUnit provides two boolean assertions:</p>
<ul>
<li><code>Assert.True(bool actual)</code>, asserts that the value supplied to the <code>actual</code> parameter is <code>true</code>.</li>
<li><code>Assert.False(bool actual)</code>, asserts that the value supplied to the <code>actual</code> parameter is <code>false</code>.</li>
</ul>
<p>While it may be tempting to use <code>Assert.True()</code> for all tests, i.e. <code>Assert.True(stove.BurnerOne == 0)</code>, it is better practice to use the specialized assertion that best matches the situation, in this case <code>Assert.Equal&lt;T&gt;(T expected, T actual)</code> as a failing test will supply more details.</p>
<h2 id="equality-assertions">Equality Assertions</h2>
<p>The <code>Assert.Equal&lt;T&gt;(T expected, T actual)</code> is the workhorse of the assertion library. Notice it is a template method, so it can be used with any type that is comparable (which is pretty much everything possible in C#).  It also has an override, <code>Assert.Equal&lt;T&gt;(T expected, T actual, int precision)</code> which allows you to specify the precision for floating-point numbers.  Remember that floating point error can cause two calculated values to be slightly different than one another; specifying a precision allows you to say just how close the expected an actual value needs to be to be considered &rsquo;equal&rsquo; for the purposes of the test.</p>
<p>Like most assertions, it is paired with an opposite, <code>Assert.NotEqual&lt;T&gt;(T expected, T actual)</code>, which also has an override for supplying precision.</p>
<h2 id="numeric-assertions">Numeric Assertions</h2>
<p>With numeric values, it can be handy to determine if the value falls within a range:</p>
<ul>
<li><code>Assert.InRange&lt;T&gt;(T actual, T low, T high)</code> asserts <code>actual</code> falls between <code>low</code> and <code>high</code> (inclusive), and</li>
<li><code>Assert.NotInRange&lt;T&gt;(T actual, T low, T high)</code> asserts <code>actual</code> does not fall between <code>low</code> and <code>high</code> (inclusive)</li>
</ul>
<h2 id="reference-assertions">Reference Assertions</h2>
<p>There are special assertions to deal with null references:</p>
<ul>
<li><code>Assert.Null(object object)</code> asserts the supplied <code>object</code> is null, and</li>
<li><code>Assert.NotNull(object object)</code> asserts the supplied <code>object</code> is <em>not</em> null</li>
</ul>
<p>In addition, two objects may be considered equal, but may or may not the same object (i.e. not referencing the same memory).  This can be asserted with:</p>
<ul>
<li><code>Assert.Same(object expected, object actual)</code> asserts the <code>expected</code> and <code>actual</code> object references are to the same object, while</li>
<li><code>Assert.NotSame(object expected, object actual)</code> asserts the <code>expected</code> and <code>actual</code> object references are <em>not</em> the same object</li>
</ul>
<h2 id="type-assertions">Type Assertions</h2>
<p>At times, you may want to assure it is possible to cast an object to a specific type.  This can be done with:</p>
<ul>
<li><code>Assert.IsAssignableFrom&lt;T&gt;(object obj)</code>
Where <code>T</code> is the type to cast into.</li>
</ul>
<p>At other times, you may want to assert that the object is <em>exactly</em> the type you expect (.e. <code>T</code> is not an interface or base class of <code>obj</code>).  That can be done with:</p>
<ul>
<li><code>Assert.IsType&lt;T&gt;(object obj)</code></li>
</ul>
<h2 id="collection-assertions">Collection Assertions</h2>
<p>There are a host of assertions for working with collections:</p>
<ul>
<li><code>Assert.Empty(IEnumerable collection)</code> asserts that the collection is empty, while</li>
<li><code>Assert.NotEmpty(IEnumerable collection)</code> asserts that it is <em>not</em> empty</li>
<li><code>Assert.Contains&lt;T&gt;(T expected, IEnumerable&lt;T&gt; collection)</code> asserts that the <code>expected</code> item is found in the <code>collection</code>, while</li>
<li><code>Assert.DoesNotContain&lt;T&gt;(T expected, IEnumerable&lt;T&gt; collection)</code> asserts the <code>expected</code> item is <em>not</em> found in the <code>collection</code></li>
</ul>
<p>In addition to the simple equality check form of <code>Assert.Contains&lt;T&gt;()</code> and <code>Assert.DoesNotContain&lt;T&gt;()</code>, there is a version that takes a filter expression (an expression that evaluates to <code>true</code> or <code>false</code> indicating that an item was found) written as a lambda expression.  For example, to determine if a list of <code>Fruit</code> contains an <code>Orange</code> we could use:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>List&lt;Fruit&gt; fruits = <span style="color:#66d9ef">new</span> List&lt;Fruit&gt;() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> Orange(),
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> Apple(),
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> Grape(),
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> Banana() {Overripe = <span style="color:#66d9ef">true</span>}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>Assert.Contains(fruits, item =&gt; item <span style="color:#66d9ef">is</span> Orange);</span></span></code></pre></div><p>The expression <code>item is Orange</code> is run on each item in <code>fruits</code> until it evaluates to <code>true</code> or we run out of fruit to check. We can also supply curly braces with a return statement if we need to perform more complex logic:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>Assert.Contains(fruits, item =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(item <span style="color:#66d9ef">is</span> Banana banana) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(banana.Overripe) <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>});</span></span></code></pre></div><p>Here we only return <code>true</code> for overripe bananas.  Using <code>Assert.Contains()</code> with a filter expression can be useful for checking that expected items are in a collection.  To check that the collection also does not contain unexpected items, we can test the length of the collection against the expected number of values, i.e.:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>Assert.True(fruits.Count == <span style="color:#ae81ff">4</span>, <span style="color:#e6db74">$&#34;Expected 4 items but found {fruits.Count}&#34;</span>);</span></span></code></pre></div><p>Here we use the <code>Assert.True()</code> overload that allows a custom message when the test fails.</p>
<p>Finally, <code>Assert.Collection&lt;T&gt;(IEnumerable&lt;T&gt; collection, Action&lt;T&gt;[] inspectors)</code> can apply specific inspectors against each item in a collection.  Using the same fruits list as above:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>Assert.Collection(fruits, 
</span></span><span style="display:flex;"><span>    item =&gt; Assert.IsType&lt;Orange&gt;(item),
</span></span><span style="display:flex;"><span>    item =&gt; Assert.IsType&lt;Apple&gt;(item),
</span></span><span style="display:flex;"><span>    item =&gt; Assert.IsType&lt;Grape&gt;(item),
</span></span><span style="display:flex;"><span>    item =&gt; {
</span></span><span style="display:flex;"><span>        Assert.IsType&lt;Banana&gt;(item);
</span></span><span style="display:flex;"><span>        Assert.True(((Banana)item).Overripe);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div><p>Here we use an <a href="https://docs.microsoft.com/en-us/dotnet/api/system.action-1?view=netcore-3.1" target="_blank">Action<T> delegate</a>
 to map each item in the collection to an assertion.  These actions are written using [lambda expressions], which are conceptually <em>functions</em>.</p>
<p>The number of actions should correspond to the expected size of the collection, and the items supplied to the actions <em>must be in the same order as they appear in the collection</em>.  Thus, the <code>Assert.Collection()</code> is a good choice when the collection is expected to always be in the same order, while the <code>Assert.Contains()</code> approach allows for variation in the ordering.</p>
<h2 id="exception-assertions">Exception Assertions</h2>
<p>Error assertions <em>also</em> use <a href="https://docs.microsoft.com/en-us/dotnet/api/system.action-1?view=netcore-3.1" target="_blank">Action<T> delegate</a>
, in this case to execute code that is expected to throw an exception, i.e. we could test for <code>System.DivideByZeroException</code> with:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#a6e22e">[Fact]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> DivisionByZeroShouldThrowException() {
</span></span><span style="display:flex;"><span>    Assert.Throws(System.DivideByZeroException, () =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> tmp = <span style="color:#ae81ff">10.0</span>/<span style="color:#ae81ff">0.0</span>;
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Note how we place the code that is expected to throw the exception <em>inside</em> the body of the Action?  This allows the assertion to wrap it in a <code>try/catch</code> internally.  The exception-related assertions are:</p>
<ul>
<li><code>Assert.Throws(System.Exception expectedException, Action testCode)</code> asserts the supplied <code>expectedException</code> is thrown when <code>testCode</code> is executed</li>
<li><code>Assert.Throws&lt;T&gt;(Action testCode) where T : System.Exception</code> the templated version of the above</li>
<li><code>Assert.ThrowsAny&lt;T&gt;(Action testCode) where T: System.Exception</code> asserts that <em>any</em> exception will be thrown by the <code>testCode</code> when executed</li>
</ul>
<p>There are also similar assertions for exceptions being thrown in <em>asynchronous</em> code. These operate nearly identically, except instead of supplying an Action, we supply a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.task?view=netcore-3.1" target="_blank">Task</a>
:</p>
<ul>
<li><code>Assert.ThrowsAsync&lt;T&gt;(Task testCode) where T : System.Exception</code> asserts the supplied exception type <code>T</code> is thrown when <code>testCode</code> is executed</li>
<li><code>Assert.ThrowsAnyAsync&lt;T&gt;(Task testCode) where T: System.Exception</code> is the asynchronous version of the previous assertion, asserts the supplied exception type <code>T</code> will be thrown some point after <code>testCode</code> is executed.</li>
</ul>
<h2 id="events-assertions">Events Assertions</h2>
<p>Asserting that events will be thrown also involves <a href="https://docs.microsoft.com/en-us/dotnet/api/system.action-1?view=netcore-3.1" target="_blank">Action<T> delegate</a>
, and is a bit more involved as it requires <em>three</em>.  The first delegate is for attaching the assertion-supplied event handler to the listener, the second for detaching it, and the third is for triggering the event with the actual code involved.</p>
<p>For example, assume we have a class, <code>Emailer</code>, with a method <code>SendEmail(string address, string body)</code> that should have an event handler <code>EmailSent</code> whose event args are <code>EmailSentEventArgs</code>.  We could test that this class was actually raising this event with:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#a6e22e">[Fact]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> EmailerShouldRaiseEmailSentWhenSendingEmails()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">string</span> address = <span style="color:#e6db74">&#34;test@test.com&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">string</span> body = <span style="color:#e6db74">&#34;this is a test&#34;</span>;
</span></span><span style="display:flex;"><span>    Emailer emailer = <span style="color:#66d9ef">new</span> Emailer();
</span></span><span style="display:flex;"><span>    Assert.Raises&lt;EmailSentEventArgs&gt;(
</span></span><span style="display:flex;"><span>        listener =&gt; emailer += listener, <span style="color:#75715e">// This action attaches the listener</span>
</span></span><span style="display:flex;"><span>        listener =&gt; emailer -= listener, <span style="color:#75715e">// This action detaches the listener </span>
</span></span><span style="display:flex;"><span>        () =&gt; {
</span></span><span style="display:flex;"><span>            emailer.SendEmail(address, body);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>The various event assertions are:</p>
<ul>
<li><code>Assert.Raises&lt;T&gt;(Action attach, Action detach, Action testCode)</code></li>
<li><code>Assert.RaisesAny&lt;T&gt;(Action attach, Action detach, Action testCode)</code></li>
</ul>
<p>There are also similar assertions for events being raised by <em>asynchronous</em> code.  These operate nearly identically, except instead of supplying an Action, we supply a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.task?view=netcore-3.1" target="_blank">Task</a>
:</p>
<ul>
<li><code>Assert.RaisesAsync&lt;T&gt;(Action attach, Action detach, Task testCode)</code></li>
<li><code>Assert.RaisesAnyAsync&lt;T&gt;(Action attach, Action detach, Task testCode)</code></li>
</ul>
<p>For examples of these assertions, see <a href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/03-events/10-testing-generic-events/">section 2.3.10</a>
</p>

  
  
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>XUnit does not directly support old-style events - those with a named event handler like <code>CollectionChangedEventHandler</code>, only those that use the templated form: <code>EventHandler&lt;CustomEventArgs&gt;</code> (with the exception of the <code>PropertyChanged</code> event, discussed below).  For strategies to handle the older-style events, see <a href="https://ksu-cs-textbooks.github.io/cis400/2-desktop-development/03-events/11-testing-custom-events/" target="_blank">section 2.3.11</a>
</p>
</div>
</div>
<h2 id="property-change-assertions">Property Change Assertions</h2>
<p>Because C# has deeply integrated the idea of &lsquo;Property Change&rsquo; notifications as part of its GUI frameworks (which we&rsquo;ll cover in a later chapter), it makes sense to have a special assertion to deal with this notification.  Hence, the <code>Assert.PropertyChanged(INotifyPropertyChanged @object, string propertyName, Action testCode)</code>.  Using it is simple - supply the object that implements the <code>INotifyPropertyChanged</code> interface as the first argument, the name of the property that will be changing as the second, and the Action delegate that will trigger the change as the third.</p>
<p>For example, if we had a <code>Profile</code> object with a <code>StatusMessage</code> property that we knew should trigger a notification when it changes, we could write our test as:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#a6e22e">[Fact]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> ProfileShouldNotifyOfStatusMessageChanges() {
</span></span><span style="display:flex;"><span>    Profile testProfile = <span style="color:#66d9ef">new</span> Profile();
</span></span><span style="display:flex;"><span>    Assert.PropertyChanged(testProfile, <span style="color:#e6db74">&#34;StatusMessage&#34;</span>, () =&gt; testProfile.StatusMessage = <span style="color:#e6db74">&#34;Hard at work&#34;</span>);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>There is also a similar assertion for testing if a property is changed in <em>asynchronous</em> code. This operates nearly identically, except instead of supplying an Action, we supply a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.task?view=netcore-3.1" target="_blank">Task</a>
:</p>
<ul>
<li><code>Assert.PropertyChangedAsync(INotifyPropertyChanged @object, string propertyName, Task testCode)</code></li>
</ul>

            <footer class="footline">

            </footer>
          </article>
        </div>
      </main>
    </div>
    
    
    
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/clipboard.min.js?1692653134" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/perfect-scrollbar.min.js?1692653134" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis400/js/theme.js?1692653134" defer></script>
  </body>
</html>
